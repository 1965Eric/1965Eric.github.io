<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Section 4 Overview | Data Science Visualization</title>
  <meta name="description" content="5 Section 4 Overview | Data Science Visualization" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Section 4 Overview | Data Science Visualization" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Section 4 Overview | Data Science Visualization" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="section-3-overview.html"/>
<link rel="next" href="section-5-overview.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning Objectives</a>
<ul>
<li class="chapter" data-level="1.1" data-path="learning-objectives.html"><a href="learning-objectives.html#course-overview"><i class="fa fa-check"></i><b>1.1</b> Course Overview</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="learning-objectives.html"><a href="learning-objectives.html#section-1-introduction-to-data-visualization-and-distributions"><i class="fa fa-check"></i><b>1.1.1</b> Section 1: Introduction to Data Visualization and Distributions</a></li>
<li class="chapter" data-level="1.1.2" data-path="learning-objectives.html"><a href="learning-objectives.html#section-2-introduction-to-ggplot2"><i class="fa fa-check"></i><b>1.1.2</b> Section 2: Introduction to ggplot2</a></li>
<li class="chapter" data-level="1.1.3" data-path="learning-objectives.html"><a href="learning-objectives.html#section-3-summarizing-with-dplyr"><i class="fa fa-check"></i><b>1.1.3</b> Section 3: Summarizing with dplyr</a></li>
<li class="chapter" data-level="1.1.4" data-path="learning-objectives.html"><a href="learning-objectives.html#section-4-gapminder"><i class="fa fa-check"></i><b>1.1.4</b> Section 4: Gapminder</a></li>
<li class="chapter" data-level="1.1.5" data-path="learning-objectives.html"><a href="learning-objectives.html#section-5-data-visualization-principles"><i class="fa fa-check"></i><b>1.1.5</b> Section 5: Data Visualization Principles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="section-1-overview.html"><a href="section-1-overview.html"><i class="fa fa-check"></i><b>2</b> Section 1 Overview</a>
<ul>
<li class="chapter" data-level="2.1" data-path="section-1-overview.html"><a href="section-1-overview.html#introduction-to-data-visualization"><i class="fa fa-check"></i><b>2.1</b> Introduction to Data Visualization</a></li>
<li class="chapter" data-level="2.2" data-path="section-1-overview.html"><a href="section-1-overview.html#introduction-to-distributions"><i class="fa fa-check"></i><b>2.2</b> Introduction to Distributions</a></li>
<li class="chapter" data-level="2.3" data-path="section-1-overview.html"><a href="section-1-overview.html#data-types"><i class="fa fa-check"></i><b>2.3</b> Data Types</a></li>
<li class="chapter" data-level="2.4" data-path="section-1-overview.html"><a href="section-1-overview.html#assessment---data-types"><i class="fa fa-check"></i><b>2.4</b> Assessment - Data Types</a></li>
<li class="chapter" data-level="2.5" data-path="section-1-overview.html"><a href="section-1-overview.html#describe-heights-to-et"><i class="fa fa-check"></i><b>2.5</b> Describe Heights to ET</a></li>
<li class="chapter" data-level="2.6" data-path="section-1-overview.html"><a href="section-1-overview.html#smooth-density-plots"><i class="fa fa-check"></i><b>2.6</b> Smooth Density Plots</a></li>
<li class="chapter" data-level="2.7" data-path="section-1-overview.html"><a href="section-1-overview.html#assessment---distributions"><i class="fa fa-check"></i><b>2.7</b> Assessment - Distributions</a></li>
<li class="chapter" data-level="2.8" data-path="section-1-overview.html"><a href="section-1-overview.html#normal-distribution"><i class="fa fa-check"></i><b>2.8</b> Normal Distribution</a></li>
<li class="chapter" data-level="2.9" data-path="section-1-overview.html"><a href="section-1-overview.html#assessment---normal-distribution"><i class="fa fa-check"></i><b>2.9</b> Assessment - Normal Distribution</a></li>
<li class="chapter" data-level="2.10" data-path="section-1-overview.html"><a href="section-1-overview.html#quantile-quantile-plots"><i class="fa fa-check"></i><b>2.10</b> Quantile-Quantile Plots</a></li>
<li class="chapter" data-level="2.11" data-path="section-1-overview.html"><a href="section-1-overview.html#percentiles"><i class="fa fa-check"></i><b>2.11</b> Percentiles</a></li>
<li class="chapter" data-level="2.12" data-path="section-1-overview.html"><a href="section-1-overview.html#boxplots"><i class="fa fa-check"></i><b>2.12</b> Boxplots</a></li>
<li class="chapter" data-level="2.13" data-path="section-1-overview.html"><a href="section-1-overview.html#assessment---quantiles-percentiles-and-boxplots"><i class="fa fa-check"></i><b>2.13</b> Assessment - Quantiles, percentiles, and boxplots</a></li>
<li class="chapter" data-level="2.14" data-path="section-1-overview.html"><a href="section-1-overview.html#distribution-of-female-heights"><i class="fa fa-check"></i><b>2.14</b> Distribution of Female Heights</a></li>
<li class="chapter" data-level="2.15" data-path="section-1-overview.html"><a href="section-1-overview.html#assessment---robust-summaries-with-outliers"><i class="fa fa-check"></i><b>2.15</b> Assessment - Robust Summaries With Outliers</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="section-2-overview.html"><a href="section-2-overview.html"><i class="fa fa-check"></i><b>3</b> Section 2 Overview</a>
<ul>
<li class="chapter" data-level="3.1" data-path="section-2-overview.html"><a href="section-2-overview.html#ggplot"><i class="fa fa-check"></i><b>3.1</b> ggplot</a></li>
<li class="chapter" data-level="3.2" data-path="section-2-overview.html"><a href="section-2-overview.html#graph-components"><i class="fa fa-check"></i><b>3.2</b> Graph Components</a></li>
<li class="chapter" data-level="3.3" data-path="section-2-overview.html"><a href="section-2-overview.html#creating-a-new-plot"><i class="fa fa-check"></i><b>3.3</b> Creating a New Plot</a></li>
<li class="chapter" data-level="3.4" data-path="section-2-overview.html"><a href="section-2-overview.html#layers"><i class="fa fa-check"></i><b>3.4</b> Layers</a></li>
<li class="chapter" data-level="3.5" data-path="section-2-overview.html"><a href="section-2-overview.html#tinkering"><i class="fa fa-check"></i><b>3.5</b> Tinkering</a></li>
<li class="chapter" data-level="3.6" data-path="section-2-overview.html"><a href="section-2-overview.html#scales-labels-and-colors"><i class="fa fa-check"></i><b>3.6</b> Scales, Labels, and Colors</a></li>
<li class="chapter" data-level="3.7" data-path="section-2-overview.html"><a href="section-2-overview.html#add-on-packages"><i class="fa fa-check"></i><b>3.7</b> Add-on Packages</a></li>
<li class="chapter" data-level="3.8" data-path="section-2-overview.html"><a href="section-2-overview.html#other-examples"><i class="fa fa-check"></i><b>3.8</b> Other Examples</a></li>
<li class="chapter" data-level="3.9" data-path="section-2-overview.html"><a href="section-2-overview.html#assessment---ggplot2"><i class="fa fa-check"></i><b>3.9</b> Assessment - ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="section-3-overview.html"><a href="section-3-overview.html"><i class="fa fa-check"></i><b>4</b> Section 3 Overview</a>
<ul>
<li class="chapter" data-level="4.1" data-path="section-3-overview.html"><a href="section-3-overview.html#dplyr"><i class="fa fa-check"></i><b>4.1</b> dplyr</a></li>
<li class="chapter" data-level="4.2" data-path="section-3-overview.html"><a href="section-3-overview.html#the-dot-placeholder"><i class="fa fa-check"></i><b>4.2</b> The Dot Placeholder</a></li>
<li class="chapter" data-level="4.3" data-path="section-3-overview.html"><a href="section-3-overview.html#group-by"><i class="fa fa-check"></i><b>4.3</b> Group By</a></li>
<li class="chapter" data-level="4.4" data-path="section-3-overview.html"><a href="section-3-overview.html#sorting-data-tables"><i class="fa fa-check"></i><b>4.4</b> Sorting Data Tables</a></li>
<li class="chapter" data-level="4.5" data-path="section-3-overview.html"><a href="section-3-overview.html#assessment---summarizing-with-dplyr"><i class="fa fa-check"></i><b>4.5</b> Assessment - Summarizing with dplyr</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="section-4-overview.html"><a href="section-4-overview.html"><i class="fa fa-check"></i><b>5</b> Section 4 Overview</a>
<ul>
<li class="chapter" data-level="5.1" data-path="section-4-overview.html"><a href="section-4-overview.html#case-study-trends-in-world-health-and-economics"><i class="fa fa-check"></i><b>5.1</b> Case Study: Trends in World Health and Economics</a></li>
<li class="chapter" data-level="5.2" data-path="section-4-overview.html"><a href="section-4-overview.html#gapminder-dataset"><i class="fa fa-check"></i><b>5.2</b> Gapminder Dataset</a></li>
<li class="chapter" data-level="5.3" data-path="section-4-overview.html"><a href="section-4-overview.html#life-expectancy-and-fertility-rates"><i class="fa fa-check"></i><b>5.3</b> Life Expectancy and Fertility Rates</a></li>
<li class="chapter" data-level="5.4" data-path="section-4-overview.html"><a href="section-4-overview.html#faceting"><i class="fa fa-check"></i><b>5.4</b> Faceting</a></li>
<li class="chapter" data-level="5.5" data-path="section-4-overview.html"><a href="section-4-overview.html#time-series-plots"><i class="fa fa-check"></i><b>5.5</b> Time Series Plots</a></li>
<li class="chapter" data-level="5.6" data-path="section-4-overview.html"><a href="section-4-overview.html#transformations"><i class="fa fa-check"></i><b>5.6</b> Transformations</a></li>
<li class="chapter" data-level="5.7" data-path="section-4-overview.html"><a href="section-4-overview.html#stratify-and-boxplot"><i class="fa fa-check"></i><b>5.7</b> Stratify and Boxplot</a></li>
<li class="chapter" data-level="5.8" data-path="section-4-overview.html"><a href="section-4-overview.html#comparing-distributions"><i class="fa fa-check"></i><b>5.8</b> Comparing Distributions</a></li>
<li class="chapter" data-level="5.9" data-path="section-4-overview.html"><a href="section-4-overview.html#density-plots"><i class="fa fa-check"></i><b>5.9</b> Density Plots</a></li>
<li class="chapter" data-level="5.10" data-path="section-4-overview.html"><a href="section-4-overview.html#ecological-fallacy"><i class="fa fa-check"></i><b>5.10</b> Ecological Fallacy</a></li>
<li class="chapter" data-level="5.11" data-path="section-4-overview.html"><a href="section-4-overview.html#assessment---exploring-the-gapminder-dataset"><i class="fa fa-check"></i><b>5.11</b> Assessment - Exploring the Gapminder Dataset</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="section-5-overview.html"><a href="section-5-overview.html"><i class="fa fa-check"></i><b>6</b> Section 5 Overview</a>
<ul>
<li class="chapter" data-level="6.1" data-path="section-5-overview.html"><a href="section-5-overview.html#introduction-to-data-visualization-principles"><i class="fa fa-check"></i><b>6.1</b> Introduction to Data Visualization Principles</a></li>
<li class="chapter" data-level="6.2" data-path="section-5-overview.html"><a href="section-5-overview.html#encoding-data-using-visual-cues"><i class="fa fa-check"></i><b>6.2</b> Encoding Data Using Visual Cues</a></li>
<li class="chapter" data-level="6.3" data-path="section-5-overview.html"><a href="section-5-overview.html#know-when-to-include-zero"><i class="fa fa-check"></i><b>6.3</b> Know When to Include Zero</a></li>
<li class="chapter" data-level="6.4" data-path="section-5-overview.html"><a href="section-5-overview.html#do-not-distort-quantities"><i class="fa fa-check"></i><b>6.4</b> Do Not Distort Quantities</a></li>
<li class="chapter" data-level="6.5" data-path="section-5-overview.html"><a href="section-5-overview.html#order-by-a-meaningful-value"><i class="fa fa-check"></i><b>6.5</b> Order by a Meaningful Value</a></li>
<li class="chapter" data-level="6.6" data-path="section-5-overview.html"><a href="section-5-overview.html#assessment---data-visualization-principles-part-1"><i class="fa fa-check"></i><b>6.6</b> Assessment - Data Visualization Principles, Part 1</a></li>
<li class="chapter" data-level="6.7" data-path="section-5-overview.html"><a href="section-5-overview.html#show-the-data"><i class="fa fa-check"></i><b>6.7</b> Show the Data</a></li>
<li class="chapter" data-level="6.8" data-path="section-5-overview.html"><a href="section-5-overview.html#ease-comparisons-use-common-axes"><i class="fa fa-check"></i><b>6.8</b> Ease Comparisons: Use Common Axes</a></li>
<li class="chapter" data-level="6.9" data-path="section-5-overview.html"><a href="section-5-overview.html#consider-transformations"><i class="fa fa-check"></i><b>6.9</b> Consider Transformations</a></li>
<li class="chapter" data-level="6.10" data-path="section-5-overview.html"><a href="section-5-overview.html#ease-comparisons-compared-visual-cues-should-be-adjacent"><i class="fa fa-check"></i><b>6.10</b> Ease Comparisons: Compared Visual Cues Should Be Adjacent</a></li>
<li class="chapter" data-level="6.11" data-path="section-5-overview.html"><a href="section-5-overview.html#assessment---data-visualization-principles-part-2"><i class="fa fa-check"></i><b>6.11</b> Assessment - Data Visualization Principles, Part 2</a></li>
<li class="chapter" data-level="6.12" data-path="section-5-overview.html"><a href="section-5-overview.html#slope-charts"><i class="fa fa-check"></i><b>6.12</b> Slope Charts</a></li>
<li class="chapter" data-level="6.13" data-path="section-5-overview.html"><a href="section-5-overview.html#encoding-a-third-variable"><i class="fa fa-check"></i><b>6.13</b> Encoding a Third Variable</a></li>
<li class="chapter" data-level="6.14" data-path="section-5-overview.html"><a href="section-5-overview.html#case-study-vaccines"><i class="fa fa-check"></i><b>6.14</b> Case Study: Vaccines</a></li>
<li class="chapter" data-level="6.15" data-path="section-5-overview.html"><a href="section-5-overview.html#avoid-pseudo-and-gratuitous-3d-plots"><i class="fa fa-check"></i><b>6.15</b> Avoid Pseudo and Gratuitous 3D Plots</a></li>
<li class="chapter" data-level="6.16" data-path="section-5-overview.html"><a href="section-5-overview.html#avoid-too-many-significant-digits"><i class="fa fa-check"></i><b>6.16</b> Avoid Too Many Significant Digits</a></li>
<li class="chapter" data-level="6.17" data-path="section-5-overview.html"><a href="section-5-overview.html#assessment---data-visualization-principles-part-3"><i class="fa fa-check"></i><b>6.17</b> Assessment - Data Visualization Principles, Part 3</a></li>
<li class="chapter" data-level="6.18" data-path="section-5-overview.html"><a href="section-5-overview.html#titanic-survival-exercises"><i class="fa fa-check"></i><b>6.18</b> Titanic Survival Exercises</a></li>
<li class="chapter" data-level="6.19" data-path="section-5-overview.html"><a href="section-5-overview.html#properties-of-stars-exercises"><i class="fa fa-check"></i><b>6.19</b> Properties of Stars Exercises</a></li>
<li class="chapter" data-level="6.20" data-path="section-5-overview.html"><a href="section-5-overview.html#climate-change-exercises"><i class="fa fa-check"></i><b>6.20</b> Climate Change Exercises</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science Visualization</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="section-4-overview" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Section 4 Overview</h1>
<p>In Section 4, you will look at a case study involving data from the <a href="https://www.gapminder.org" target="_blank">Gapminder Foundation</a> about trends in world health and economics.</p>
<p>After completing Section 4, you will:</p>
<ul>
<li>understand how Hans Rosling and the Gapminder Foundation use effective data visualization to convey data-based trends.</li>
<li>be able to apply the ggplot2 techniques from the previous section to answer questions using data.</li>
<li>understand how fixed scales across plots can ease comparisons.</li>
<li>be able to modify graphs to improve data visualization.</li>
</ul>
<div id="case-study-trends-in-world-health-and-economics" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Case Study: Trends in World Health and Economics</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/gapminder.html#case-study-new-insights-on-poverty" target="_blank">here</a>.</p>
<p><strong>More about Gapminder</strong></p>
<p>The original Gapminder TED talks are available and we encourage you to watch them.</p>
<ul>
<li><a href="https://www.ted.com/talks/hans_rosling_the_best_stats_you_ve_ever_seen?language=en" target="_blank">The Best Stats You’ve Ever Seen</a>.</li>
<li><a href="https://www.ted.com/talks/hans_rosling_new_insights_on_poverty?language=en" target="_blank">New Insights on Poverty</a>.</li>
</ul>
<p>You can also find more information and raw data (in addition to what we analyze in class) <a href="https://www.gapminder.org/" target="_blank">at</a>.</p>
<p><strong>Key points</strong></p>
<ul>
<li>Data visualization can be used to dispel common myths and educate the public and contradict sensationalist or outdated claims and stories.</li>
<li>We will use real data to answer the following questions about world health and economics:
<ul>
<li>Is it still fair to consider the world as divided into the West and the developing world?</li>
<li>Has income inequality across countries worsened over the last 40 years?</li>
</ul></li>
</ul>
</div>
<div id="gapminder-dataset" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Gapminder Dataset</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/gapminder.html#case-study-new-insights-on-poverty" target="_blank">here</a>.</p>
<p><strong>Key points</strong></p>
<ul>
<li>A selection of world health and economics statistics from the Gapminder project can be found in the <strong>dslabs</strong> package as <code>data(gapminder)</code>.</li>
<li>Most people have misconceptions about world health and economics, which can be addressed by considering real data.</li>
</ul>
<p><em>Code</em></p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="section-4-overview.html#cb235-1" aria-hidden="true"></a><span class="co"># load and inspect gapminder data</span></span>
<span id="cb235-2"><a href="section-4-overview.html#cb235-2" aria-hidden="true"></a><span class="kw">data</span>(gapminder)</span>
<span id="cb235-3"><a href="section-4-overview.html#cb235-3" aria-hidden="true"></a><span class="kw">head</span>(gapminder)</span></code></pre></div>
<pre><code>##               country year infant_mortality life_expectancy fertility population          gdp continent          region
## 1             Albania 1960           115.40           62.87      6.19    1636054           NA    Europe Southern Europe
## 2             Algeria 1960           148.20           47.50      7.65   11124892  13828152297    Africa Northern Africa
## 3              Angola 1960           208.00           35.98      7.32    5270844           NA    Africa   Middle Africa
## 4 Antigua and Barbuda 1960               NA           62.97      4.43      54681           NA  Americas       Caribbean
## 5           Argentina 1960            59.87           65.39      3.11   20619075 108322326649  Americas   South America
## 6             Armenia 1960               NA           66.86      4.55    1867396           NA      Asia    Western Asia</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="section-4-overview.html#cb237-1" aria-hidden="true"></a><span class="co"># compare infant mortality in Sri Lanka and Turkey</span></span>
<span id="cb237-2"><a href="section-4-overview.html#cb237-2" aria-hidden="true"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb237-3"><a href="section-4-overview.html#cb237-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2015</span> <span class="op">&amp;</span><span class="st"> </span>country <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Sri Lanka&quot;</span>, <span class="st">&quot;Turkey&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb237-4"><a href="section-4-overview.html#cb237-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">select</span>(country, infant_mortality)</span></code></pre></div>
<pre><code>##     country infant_mortality
## 1 Sri Lanka              8.4
## 2    Turkey             11.6</code></pre>
</div>
<div id="life-expectancy-and-fertility-rates" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Life Expectancy and Fertility Rates</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/gapminder.html#scatterplots" target="_blank">here</a>.</p>
<p><strong>Key points</strong></p>
<ul>
<li>A prevalent worldview is that the world is divided into two groups of countries:
<ul>
<li>Western world: high life expectancy, low fertility rate</li>
<li>Developing world: lower life expectancy, higher fertility rate</li>
</ul></li>
<li>Gapminder data can be used to evaluate the validity of this view.</li>
<li>A scatterplot of life expectancy versus fertility rate in 1962 suggests that this viewpoint was grounded in reality 50 years ago. Is it still the case today?</li>
</ul>
<p><em>Code</em></p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="section-4-overview.html#cb239-1" aria-hidden="true"></a><span class="co"># basic scatterplot of life expectancy versus fertility</span></span>
<span id="cb239-2"><a href="section-4-overview.html#cb239-2" aria-hidden="true"></a><span class="kw">ds_theme_set</span>()    <span class="co"># set plot theme</span></span>
<span id="cb239-3"><a href="section-4-overview.html#cb239-3" aria-hidden="true"></a><span class="kw">filter</span>(gapminder, year <span class="op">==</span><span class="st"> </span><span class="dv">1962</span>) <span class="op">%&gt;%</span></span>
<span id="cb239-4"><a href="section-4-overview.html#cb239-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(fertility, life_expectancy)) <span class="op">+</span></span>
<span id="cb239-5"><a href="section-4-overview.html#cb239-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-109-1.png" width="672" /></p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="section-4-overview.html#cb240-1" aria-hidden="true"></a><span class="co"># add color as continent</span></span>
<span id="cb240-2"><a href="section-4-overview.html#cb240-2" aria-hidden="true"></a><span class="kw">filter</span>(gapminder, year <span class="op">==</span><span class="st"> </span><span class="dv">1962</span>) <span class="op">%&gt;%</span></span>
<span id="cb240-3"><a href="section-4-overview.html#cb240-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(fertility, life_expectancy, <span class="dt">color =</span> continent)) <span class="op">+</span></span>
<span id="cb240-4"><a href="section-4-overview.html#cb240-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-109-2.png" width="672" /></p>
</div>
<div id="faceting" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Faceting</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/gapminder.html#faceting" target="_blank">here</a>.</p>
<p><strong>Key points</strong></p>
<ul>
<li>Faceting makes multiple side-by-side plots stratified by some variable. This is a way to ease comparisons.</li>
<li>The <code>facet_grid</code> function allows faceting by up to two variables, with rows faceted by one variable and columns faceted by the other variable. To facet by only one variable, use the dot operator as the other variable.</li>
<li>The <code>facet_wrap</code> function facets by one variable and automatically wraps the series of plots so they have readable dimensions.</li>
<li>Faceting keeps the axes fixed across all plots, easing comparisons between plots.</li>
<li>The data suggest that the developing versus Western world view no longer makes sense in 2012.</li>
</ul>
<p><em>Code</em></p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="section-4-overview.html#cb241-1" aria-hidden="true"></a><span class="co"># facet by continent and year</span></span>
<span id="cb241-2"><a href="section-4-overview.html#cb241-2" aria-hidden="true"></a><span class="kw">filter</span>(gapminder, year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1962</span>, <span class="dv">2012</span>)) <span class="op">%&gt;%</span></span>
<span id="cb241-3"><a href="section-4-overview.html#cb241-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(fertility, life_expectancy, <span class="dt">col =</span> continent)) <span class="op">+</span></span>
<span id="cb241-4"><a href="section-4-overview.html#cb241-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb241-5"><a href="section-4-overview.html#cb241-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">facet_grid</span>(continent <span class="op">~</span><span class="st"> </span>year)</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-110-1.png" width="672" /></p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="section-4-overview.html#cb242-1" aria-hidden="true"></a><span class="co"># facet by year only</span></span>
<span id="cb242-2"><a href="section-4-overview.html#cb242-2" aria-hidden="true"></a><span class="kw">filter</span>(gapminder, year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1962</span>, <span class="dv">2012</span>)) <span class="op">%&gt;%</span></span>
<span id="cb242-3"><a href="section-4-overview.html#cb242-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(fertility, life_expectancy, <span class="dt">col =</span> continent)) <span class="op">+</span></span>
<span id="cb242-4"><a href="section-4-overview.html#cb242-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb242-5"><a href="section-4-overview.html#cb242-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>year)</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-110-2.png" width="672" /></p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="section-4-overview.html#cb243-1" aria-hidden="true"></a><span class="co"># facet by year, plots wrapped onto multiple rows</span></span>
<span id="cb243-2"><a href="section-4-overview.html#cb243-2" aria-hidden="true"></a>years &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1962</span>, <span class="dv">1980</span>, <span class="dv">1990</span>, <span class="dv">2000</span>, <span class="dv">2012</span>)</span>
<span id="cb243-3"><a href="section-4-overview.html#cb243-3" aria-hidden="true"></a>continents &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Europe&quot;</span>, <span class="st">&quot;Asia&quot;</span>)</span>
<span id="cb243-4"><a href="section-4-overview.html#cb243-4" aria-hidden="true"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb243-5"><a href="section-4-overview.html#cb243-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">%in%</span><span class="st"> </span>years <span class="op">&amp;</span><span class="st"> </span>continent <span class="op">%in%</span><span class="st"> </span>continents) <span class="op">%&gt;%</span></span>
<span id="cb243-6"><a href="section-4-overview.html#cb243-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(fertility, life_expectancy, <span class="dt">col =</span> continent)) <span class="op">+</span></span>
<span id="cb243-7"><a href="section-4-overview.html#cb243-7" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb243-8"><a href="section-4-overview.html#cb243-8" aria-hidden="true"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>year)</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-110-3.png" width="672" /></p>
</div>
<div id="time-series-plots" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Time Series Plots</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/gapminder.html#time-series-plots" target="_blank">here</a>.</p>
<p><strong>Key points</strong></p>
<ul>
<li>Time series plots have time on the x-axis and a variable of interest on the y-axis.</li>
<li>The <code>geom_line</code> geometry connects adjacent data points to form a continuous line. A line plot is appropriate when points are regularly spaced, densely packed and from a single data series.</li>
<li>You can plot multiple lines on the same graph. Remember to group or color by a variable so that the lines are plotted independently.</li>
<li>Labeling is usually preferred over legends. However, legends are easier to make and appear by default. Add a label with <code>geom_text</code>, specifying the coordinates where the label should appear on the graph.</li>
</ul>
<p><em>Code: Single time series</em></p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="section-4-overview.html#cb244-1" aria-hidden="true"></a><span class="co"># scatterplot of US fertility by year</span></span>
<span id="cb244-2"><a href="section-4-overview.html#cb244-2" aria-hidden="true"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb244-3"><a href="section-4-overview.html#cb244-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(country <span class="op">==</span><span class="st"> &quot;United States&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb244-4"><a href="section-4-overview.html#cb244-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, fertility)) <span class="op">+</span></span>
<span id="cb244-5"><a href="section-4-overview.html#cb244-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_point</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="img/figures/unnamed-chunk-111-1.png" width="672" /></p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="section-4-overview.html#cb246-1" aria-hidden="true"></a><span class="co"># line plot of US fertility by year</span></span>
<span id="cb246-2"><a href="section-4-overview.html#cb246-2" aria-hidden="true"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb246-3"><a href="section-4-overview.html#cb246-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(country <span class="op">==</span><span class="st"> &quot;United States&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb246-4"><a href="section-4-overview.html#cb246-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, fertility)) <span class="op">+</span></span>
<span id="cb246-5"><a href="section-4-overview.html#cb246-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_line</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 1 row(s) containing missing values (geom_path).</code></pre>
<p><img src="img/figures/unnamed-chunk-111-2.png" width="672" /></p>
<p><em>Code: Multiple time series</em></p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="section-4-overview.html#cb248-1" aria-hidden="true"></a><span class="co"># line plot fertility time series for two countries- only one line (incorrect)</span></span>
<span id="cb248-2"><a href="section-4-overview.html#cb248-2" aria-hidden="true"></a>countries &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;South Korea&quot;</span>, <span class="st">&quot;Germany&quot;</span>)</span>
<span id="cb248-3"><a href="section-4-overview.html#cb248-3" aria-hidden="true"></a>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(country <span class="op">%in%</span><span class="st"> </span>countries) <span class="op">%&gt;%</span></span>
<span id="cb248-4"><a href="section-4-overview.html#cb248-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, fertility)) <span class="op">+</span></span>
<span id="cb248-5"><a href="section-4-overview.html#cb248-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_line</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 2 row(s) containing missing values (geom_path).</code></pre>
<p><img src="img/figures/unnamed-chunk-112-1.png" width="672" /></p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="section-4-overview.html#cb250-1" aria-hidden="true"></a><span class="co"># line plot fertility time series for two countries - one line per country</span></span>
<span id="cb250-2"><a href="section-4-overview.html#cb250-2" aria-hidden="true"></a>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(country <span class="op">%in%</span><span class="st"> </span>countries) <span class="op">%&gt;%</span></span>
<span id="cb250-3"><a href="section-4-overview.html#cb250-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, fertility, <span class="dt">group =</span> country)) <span class="op">+</span></span>
<span id="cb250-4"><a href="section-4-overview.html#cb250-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_line</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 2 row(s) containing missing values (geom_path).</code></pre>
<p><img src="img/figures/unnamed-chunk-112-2.png" width="672" /></p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="section-4-overview.html#cb252-1" aria-hidden="true"></a><span class="co"># fertility time series for two countries - lines colored by country</span></span>
<span id="cb252-2"><a href="section-4-overview.html#cb252-2" aria-hidden="true"></a>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(country <span class="op">%in%</span><span class="st"> </span>countries) <span class="op">%&gt;%</span></span>
<span id="cb252-3"><a href="section-4-overview.html#cb252-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, fertility, <span class="dt">col =</span> country)) <span class="op">+</span></span>
<span id="cb252-4"><a href="section-4-overview.html#cb252-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_line</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 2 row(s) containing missing values (geom_path).</code></pre>
<p><img src="img/figures/unnamed-chunk-112-3.png" width="672" /></p>
<p><em>Code: Adding text labels to a plot</em></p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="section-4-overview.html#cb254-1" aria-hidden="true"></a><span class="co"># life expectancy time series - lines colored by country and labeled, no legend</span></span>
<span id="cb254-2"><a href="section-4-overview.html#cb254-2" aria-hidden="true"></a>labels &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">country =</span> countries, <span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1975</span>, <span class="dv">1965</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">60</span>, <span class="dv">72</span>))</span>
<span id="cb254-3"><a href="section-4-overview.html#cb254-3" aria-hidden="true"></a>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(country <span class="op">%in%</span><span class="st"> </span>countries) <span class="op">%&gt;%</span></span>
<span id="cb254-4"><a href="section-4-overview.html#cb254-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, life_expectancy, <span class="dt">col =</span> country)) <span class="op">+</span></span>
<span id="cb254-5"><a href="section-4-overview.html#cb254-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb254-6"><a href="section-4-overview.html#cb254-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_text</span>(<span class="dt">data =</span> labels, <span class="kw">aes</span>(x, y, <span class="dt">label =</span> country), <span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span></span>
<span id="cb254-7"><a href="section-4-overview.html#cb254-7" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-113-1.png" width="672" /></p>
</div>
<div id="transformations" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Transformations</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/gapminder.html#data-transformations" target="_blank">here</a> and <a href="https://rafalab.github.io/dsbook/gapminder.html#visualizing-multimodal-distributions" target="_blank">here</a>.</p>
<p><strong>Key points</strong></p>
<ul>
<li>We use GDP data to compute income in US dollars per day, adjusted for inflation.</li>
<li>Log transformations convert multiplicative changes into additive changes.</li>
<li>Common transformations are the log base 2 transformation and the log base 10 transformation. The choice of base depends on the range of the data. The natural log is not recommended for visualization because it is difficult to interpret.</li>
<li>The mode of a distribution is the value with the highest frequency. The mode of a normal distribution is the average. A distribution can have multiple local modes.</li>
<li>There are two ways to use log transformations in plots: transform the data before plotting or transform the axes of the plot. Log scales have the advantage of showing the original values as axis labels, while log transformed values ease interpretation of intermediate values between labels.</li>
<li>Scale the x-axis using <code>scale_x_continuous</code> or <code>scale_x_log10</code> layers in ggplot2. Similar functions exist for the y-axis.</li>
<li>In 1970, income distribution is bimodal, consistent with the dichotomous Western versus developing worldview.</li>
</ul>
<p><em>Code</em></p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="section-4-overview.html#cb255-1" aria-hidden="true"></a><span class="co"># add dollars per day variable</span></span>
<span id="cb255-2"><a href="section-4-overview.html#cb255-2" aria-hidden="true"></a>gapminder &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span></span>
<span id="cb255-3"><a href="section-4-overview.html#cb255-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">dollars_per_day =</span> gdp<span class="op">/</span>population<span class="op">/</span><span class="dv">365</span>)</span>
<span id="cb255-4"><a href="section-4-overview.html#cb255-4" aria-hidden="true"></a></span>
<span id="cb255-5"><a href="section-4-overview.html#cb255-5" aria-hidden="true"></a><span class="co"># histogram of dollars per day</span></span>
<span id="cb255-6"><a href="section-4-overview.html#cb255-6" aria-hidden="true"></a>past_year &lt;-<span class="st"> </span><span class="dv">1970</span></span>
<span id="cb255-7"><a href="section-4-overview.html#cb255-7" aria-hidden="true"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb255-8"><a href="section-4-overview.html#cb255-8" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span>past_year <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(gdp)) <span class="op">%&gt;%</span></span>
<span id="cb255-9"><a href="section-4-overview.html#cb255-9" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(dollars_per_day)) <span class="op">+</span></span>
<span id="cb255-10"><a href="section-4-overview.html#cb255-10" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-114-1.png" width="672" /></p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="section-4-overview.html#cb256-1" aria-hidden="true"></a><span class="co"># repeat histogram with log2 scaled data</span></span>
<span id="cb256-2"><a href="section-4-overview.html#cb256-2" aria-hidden="true"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb256-3"><a href="section-4-overview.html#cb256-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span>past_year <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(gdp)) <span class="op">%&gt;%</span></span>
<span id="cb256-4"><a href="section-4-overview.html#cb256-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="kw">log2</span>(dollars_per_day))) <span class="op">+</span></span>
<span id="cb256-5"><a href="section-4-overview.html#cb256-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-114-2.png" width="672" /></p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="section-4-overview.html#cb257-1" aria-hidden="true"></a><span class="co"># repeat histogram with log2 scaled x-axis</span></span>
<span id="cb257-2"><a href="section-4-overview.html#cb257-2" aria-hidden="true"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb257-3"><a href="section-4-overview.html#cb257-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span>past_year <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(gdp)) <span class="op">%&gt;%</span></span>
<span id="cb257-4"><a href="section-4-overview.html#cb257-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(dollars_per_day)) <span class="op">+</span></span>
<span id="cb257-5"><a href="section-4-overview.html#cb257-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb257-6"><a href="section-4-overview.html#cb257-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>)</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-114-3.png" width="672" /></p>
</div>
<div id="stratify-and-boxplot" class="section level2" number="5.7">
<h2><span class="header-section-number">5.7</span> Stratify and Boxplot</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/gapminder.html#comparing-multiple-distributions-with-boxplots-and-ridge-plots" target="_blank">here</a>. Note that many boxplots from the video are instead dot plots in the textbook and that a different boxplot is constructed in the textbook. Also read that section to see an example of grouping factors with the <code>case_when</code> function.</p>
<p><strong>Key points</strong></p>
<ul>
<li>Make boxplots stratified by a categorical variable using the <code>geom_boxplot</code> geometry.</li>
<li>Rotate axis labels by changing the theme through <code>element_text</code>. You can change the angle and justification of the text labels.</li>
<li>Consider ordering your factors by a meaningful value with the <code>reorder</code> function, which changes the order of factor levels based on a related numeric vector. This is a way to ease comparisons.</li>
<li>Show the data by adding data points to the boxplot with a <code>geom_point</code> layer. This adds information beyond the five-number summary to your plot, but too many data points it can obfuscate your message.</li>
</ul>
<p><em>Code: Boxplot of GDP by region</em></p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="section-4-overview.html#cb258-1" aria-hidden="true"></a><span class="co"># add dollars per day variable</span></span>
<span id="cb258-2"><a href="section-4-overview.html#cb258-2" aria-hidden="true"></a>gapminder &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span></span>
<span id="cb258-3"><a href="section-4-overview.html#cb258-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">dollars_per_day =</span> gdp<span class="op">/</span>population<span class="op">/</span><span class="dv">365</span>)</span>
<span id="cb258-4"><a href="section-4-overview.html#cb258-4" aria-hidden="true"></a></span>
<span id="cb258-5"><a href="section-4-overview.html#cb258-5" aria-hidden="true"></a><span class="co"># number of regions</span></span>
<span id="cb258-6"><a href="section-4-overview.html#cb258-6" aria-hidden="true"></a><span class="kw">length</span>(<span class="kw">levels</span>(gapminder<span class="op">$</span>region))</span></code></pre></div>
<pre><code>## [1] 22</code></pre>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="section-4-overview.html#cb260-1" aria-hidden="true"></a><span class="co"># boxplot of GDP by region in 1970</span></span>
<span id="cb260-2"><a href="section-4-overview.html#cb260-2" aria-hidden="true"></a>past_year &lt;-<span class="st"> </span><span class="dv">1970</span></span>
<span id="cb260-3"><a href="section-4-overview.html#cb260-3" aria-hidden="true"></a>p &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span></span>
<span id="cb260-4"><a href="section-4-overview.html#cb260-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span>past_year <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(gdp)) <span class="op">%&gt;%</span></span>
<span id="cb260-5"><a href="section-4-overview.html#cb260-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(region, dollars_per_day))</span>
<span id="cb260-6"><a href="section-4-overview.html#cb260-6" aria-hidden="true"></a>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-115-1.png" width="672" /></p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="section-4-overview.html#cb261-1" aria-hidden="true"></a><span class="co"># rotate names on x-axis</span></span>
<span id="cb261-2"><a href="section-4-overview.html#cb261-2" aria-hidden="true"></a>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb261-3"><a href="section-4-overview.html#cb261-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-115-2.png" width="672" /></p>
<p><em>Code: The reorder function</em></p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="section-4-overview.html#cb262-1" aria-hidden="true"></a><span class="co"># by default, factor order is alphabetical</span></span>
<span id="cb262-2"><a href="section-4-overview.html#cb262-2" aria-hidden="true"></a>fac &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;Asia&quot;</span>, <span class="st">&quot;Asia&quot;</span>, <span class="st">&quot;West&quot;</span>, <span class="st">&quot;West&quot;</span>, <span class="st">&quot;West&quot;</span>))</span>
<span id="cb262-3"><a href="section-4-overview.html#cb262-3" aria-hidden="true"></a><span class="kw">levels</span>(fac)</span></code></pre></div>
<pre><code>## [1] &quot;Asia&quot; &quot;West&quot;</code></pre>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="section-4-overview.html#cb264-1" aria-hidden="true"></a><span class="co"># reorder factor by the category means</span></span>
<span id="cb264-2"><a href="section-4-overview.html#cb264-2" aria-hidden="true"></a>value &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">6</span>, <span class="dv">4</span>)</span>
<span id="cb264-3"><a href="section-4-overview.html#cb264-3" aria-hidden="true"></a>fac &lt;-<span class="st"> </span><span class="kw">reorder</span>(fac, value, <span class="dt">FUN =</span> mean)</span>
<span id="cb264-4"><a href="section-4-overview.html#cb264-4" aria-hidden="true"></a><span class="kw">levels</span>(fac)</span></code></pre></div>
<pre><code>## [1] &quot;West&quot; &quot;Asia&quot;</code></pre>
<p><em>Code: Enhanced boxplot ordered by median income, scaled, and showing data</em></p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="section-4-overview.html#cb266-1" aria-hidden="true"></a><span class="co"># reorder by median income and color by continent</span></span>
<span id="cb266-2"><a href="section-4-overview.html#cb266-2" aria-hidden="true"></a>p &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span></span>
<span id="cb266-3"><a href="section-4-overview.html#cb266-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span>past_year <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(gdp)) <span class="op">%&gt;%</span></span>
<span id="cb266-4"><a href="section-4-overview.html#cb266-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">region =</span> <span class="kw">reorder</span>(region, dollars_per_day, <span class="dt">FUN =</span> median)) <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># reorder</span></span>
<span id="cb266-5"><a href="section-4-overview.html#cb266-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(region, dollars_per_day, <span class="dt">fill =</span> continent)) <span class="op">+</span><span class="st">    </span><span class="co"># color by continent</span></span>
<span id="cb266-6"><a href="section-4-overview.html#cb266-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb266-7"><a href="section-4-overview.html#cb266-7" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb266-8"><a href="section-4-overview.html#cb266-8" aria-hidden="true"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb266-9"><a href="section-4-overview.html#cb266-9" aria-hidden="true"></a>p</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-117-1.png" width="672" /></p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="section-4-overview.html#cb267-1" aria-hidden="true"></a><span class="co"># log2 scale y-axis</span></span>
<span id="cb267-2"><a href="section-4-overview.html#cb267-2" aria-hidden="true"></a>p <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>)</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-117-2.png" width="672" /></p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="section-4-overview.html#cb268-1" aria-hidden="true"></a><span class="co"># add data points</span></span>
<span id="cb268-2"><a href="section-4-overview.html#cb268-2" aria-hidden="true"></a>p <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-117-3.png" width="672" /></p>
</div>
<div id="comparing-distributions" class="section level2" number="5.8">
<h2><span class="header-section-number">5.8</span> Comparing Distributions</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/gapminder.html#example-1970-versus-2010-income-distributions" target="_blank">here</a>. Note that the boxplots are slightly different.</p>
<p><strong>Key points</strong></p>
<ul>
<li>Use <code>intersect</code> to find the overlap between two vectors.</li>
<li>To make boxplots where grouped variables are adjacaent, color the boxplot by a factor instead of faceting by that factor. This is a way to ease comparisons.</li>
<li>The data suggest that the income gap between rich and poor countries has narrowed, not expanded.</li>
</ul>
<p><em>Code: Histogram of income in West versus developing world, 1970 and 2010</em></p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="section-4-overview.html#cb269-1" aria-hidden="true"></a><span class="co"># add dollars per day variable and define past year</span></span>
<span id="cb269-2"><a href="section-4-overview.html#cb269-2" aria-hidden="true"></a>gapminder &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span></span>
<span id="cb269-3"><a href="section-4-overview.html#cb269-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">dollars_per_day =</span> gdp<span class="op">/</span>population<span class="op">/</span><span class="dv">365</span>)</span>
<span id="cb269-4"><a href="section-4-overview.html#cb269-4" aria-hidden="true"></a>past_year &lt;-<span class="st"> </span><span class="dv">1970</span></span>
<span id="cb269-5"><a href="section-4-overview.html#cb269-5" aria-hidden="true"></a></span>
<span id="cb269-6"><a href="section-4-overview.html#cb269-6" aria-hidden="true"></a><span class="co"># define Western countries</span></span>
<span id="cb269-7"><a href="section-4-overview.html#cb269-7" aria-hidden="true"></a>west &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Western Europe&quot;</span>, <span class="st">&quot;Northern Europe&quot;</span>, <span class="st">&quot;Southern Europe&quot;</span>, <span class="st">&quot;Northern America&quot;</span>, <span class="st">&quot;Australia and New Zealand&quot;</span>)</span>
<span id="cb269-8"><a href="section-4-overview.html#cb269-8" aria-hidden="true"></a></span>
<span id="cb269-9"><a href="section-4-overview.html#cb269-9" aria-hidden="true"></a><span class="co"># facet by West vs devloping</span></span>
<span id="cb269-10"><a href="section-4-overview.html#cb269-10" aria-hidden="true"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb269-11"><a href="section-4-overview.html#cb269-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span>past_year <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(gdp)) <span class="op">%&gt;%</span></span>
<span id="cb269-12"><a href="section-4-overview.html#cb269-12" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">ifelse</span>(region <span class="op">%in%</span><span class="st"> </span>west, <span class="st">&quot;West&quot;</span>, <span class="st">&quot;Developing&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb269-13"><a href="section-4-overview.html#cb269-13" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(dollars_per_day)) <span class="op">+</span></span>
<span id="cb269-14"><a href="section-4-overview.html#cb269-14" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb269-15"><a href="section-4-overview.html#cb269-15" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span></span>
<span id="cb269-16"><a href="section-4-overview.html#cb269-16" aria-hidden="true"></a><span class="st">    </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>group)</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-118-1.png" width="672" /></p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="section-4-overview.html#cb270-1" aria-hidden="true"></a><span class="co"># facet by West/developing and year</span></span>
<span id="cb270-2"><a href="section-4-overview.html#cb270-2" aria-hidden="true"></a>present_year &lt;-<span class="st"> </span><span class="dv">2010</span></span>
<span id="cb270-3"><a href="section-4-overview.html#cb270-3" aria-hidden="true"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb270-4"><a href="section-4-overview.html#cb270-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(past_year, present_year) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(gdp)) <span class="op">%&gt;%</span></span>
<span id="cb270-5"><a href="section-4-overview.html#cb270-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">ifelse</span>(region <span class="op">%in%</span><span class="st"> </span>west, <span class="st">&quot;West&quot;</span>, <span class="st">&quot;Developing&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb270-6"><a href="section-4-overview.html#cb270-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(dollars_per_day)) <span class="op">+</span></span>
<span id="cb270-7"><a href="section-4-overview.html#cb270-7" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb270-8"><a href="section-4-overview.html#cb270-8" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span></span>
<span id="cb270-9"><a href="section-4-overview.html#cb270-9" aria-hidden="true"></a><span class="st">    </span><span class="kw">facet_grid</span>(year <span class="op">~</span><span class="st"> </span>group)</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-118-2.png" width="672" /></p>
<p><em>Code: Income distribution of West versus developing world, only countries with data</em></p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="section-4-overview.html#cb271-1" aria-hidden="true"></a><span class="co"># define countries that have data available in both years</span></span>
<span id="cb271-2"><a href="section-4-overview.html#cb271-2" aria-hidden="true"></a>country_list_<span class="dv">1</span> &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span></span>
<span id="cb271-3"><a href="section-4-overview.html#cb271-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span>past_year <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(dollars_per_day)) <span class="op">%&gt;%</span><span class="st"> </span>.<span class="op">$</span>country</span>
<span id="cb271-4"><a href="section-4-overview.html#cb271-4" aria-hidden="true"></a>country_list_<span class="dv">2</span> &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span></span>
<span id="cb271-5"><a href="section-4-overview.html#cb271-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span>present_year <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(dollars_per_day)) <span class="op">%&gt;%</span><span class="st"> </span>.<span class="op">$</span>country</span>
<span id="cb271-6"><a href="section-4-overview.html#cb271-6" aria-hidden="true"></a>country_list &lt;-<span class="st"> </span><span class="kw">intersect</span>(country_list_<span class="dv">1</span>, country_list_<span class="dv">2</span>)</span>
<span id="cb271-7"><a href="section-4-overview.html#cb271-7" aria-hidden="true"></a></span>
<span id="cb271-8"><a href="section-4-overview.html#cb271-8" aria-hidden="true"></a><span class="co"># make histogram including only countries with data available in both years</span></span>
<span id="cb271-9"><a href="section-4-overview.html#cb271-9" aria-hidden="true"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb271-10"><a href="section-4-overview.html#cb271-10" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(past_year, present_year) <span class="op">&amp;</span><span class="st"> </span>country <span class="op">%in%</span><span class="st"> </span>country_list) <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># keep only selected countries</span></span>
<span id="cb271-11"><a href="section-4-overview.html#cb271-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">ifelse</span>(region <span class="op">%in%</span><span class="st"> </span>west, <span class="st">&quot;West&quot;</span>, <span class="st">&quot;Developing&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb271-12"><a href="section-4-overview.html#cb271-12" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(dollars_per_day)) <span class="op">+</span></span>
<span id="cb271-13"><a href="section-4-overview.html#cb271-13" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb271-14"><a href="section-4-overview.html#cb271-14" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span></span>
<span id="cb271-15"><a href="section-4-overview.html#cb271-15" aria-hidden="true"></a><span class="st">    </span><span class="kw">facet_grid</span>(year <span class="op">~</span><span class="st"> </span>group)</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-119-1.png" width="672" /></p>
<p><em>Code: Boxplots of income in West versus developing world, 1970 and 2010</em></p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="section-4-overview.html#cb272-1" aria-hidden="true"></a>p &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span></span>
<span id="cb272-2"><a href="section-4-overview.html#cb272-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(past_year, present_year) <span class="op">&amp;</span><span class="st"> </span>country <span class="op">%in%</span><span class="st"> </span>country_list) <span class="op">%&gt;%</span></span>
<span id="cb272-3"><a href="section-4-overview.html#cb272-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">region =</span> <span class="kw">reorder</span>(region, dollars_per_day, <span class="dt">FUN =</span> median)) <span class="op">%&gt;%</span></span>
<span id="cb272-4"><a href="section-4-overview.html#cb272-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb272-5"><a href="section-4-overview.html#cb272-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb272-6"><a href="section-4-overview.html#cb272-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>)</span>
<span id="cb272-7"><a href="section-4-overview.html#cb272-7" aria-hidden="true"></a>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(region, dollars_per_day, <span class="dt">fill =</span> continent)) <span class="op">+</span></span>
<span id="cb272-8"><a href="section-4-overview.html#cb272-8" aria-hidden="true"></a><span class="st">    </span><span class="kw">facet_grid</span>(year <span class="op">~</span><span class="st"> </span>.)</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-120-1.png" width="672" /></p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="section-4-overview.html#cb273-1" aria-hidden="true"></a><span class="co"># arrange matching boxplots next to each other, colored by year</span></span>
<span id="cb273-2"><a href="section-4-overview.html#cb273-2" aria-hidden="true"></a>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(region, dollars_per_day, <span class="dt">fill =</span> <span class="kw">factor</span>(year)))</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-120-2.png" width="672" /></p>
</div>
<div id="density-plots" class="section level2" number="5.9">
<h2><span class="header-section-number">5.9</span> Density Plots</h2>
<p>The textbook for this section is available:</p>
<ul>
<li><a href="https://rafalab.github.io/dsbook/gapminder.html#example-1970-versus-2010-income-distributions" target="_blank">1970 versus 2010 income distributions</a>.</li>
<li><a href="https://rafalab.github.io/dsbook/gapminder.html#accessing-computed-variables" target="_blank">Accessing computed variables</a>.</li>
<li><a href="https://rafalab.github.io/dsbook/gapminder.html#weighted-densities" target="_blank">Weighted densities</a>.</li>
</ul>
<p><strong>Key points</strong></p>
<ul>
<li>Change the y-axis of density plots to variable counts using <code>..count..</code> as the y argument.</li>
<li>The <code>case_when</code> function defines a factor whose levels are defined by a variety of logical operations to group data.</li>
<li>Plot stacked density plots using <code>position="stack"</code>.</li>
<li>Define a weight <code>aesthetic</code> mapping to change the relative weights of density plots - for example, this allows weighting of plots by population rather than number of countries.</li>
</ul>
<p><em>Code: Faceted smooth density plots</em></p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="section-4-overview.html#cb274-1" aria-hidden="true"></a><span class="co"># smooth density plots - area under each curve adds to 1</span></span>
<span id="cb274-2"><a href="section-4-overview.html#cb274-2" aria-hidden="true"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb274-3"><a href="section-4-overview.html#cb274-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span>past_year <span class="op">&amp;</span><span class="st"> </span>country <span class="op">%in%</span><span class="st"> </span>country_list) <span class="op">%&gt;%</span></span>
<span id="cb274-4"><a href="section-4-overview.html#cb274-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">ifelse</span>(region <span class="op">%in%</span><span class="st"> </span>west, <span class="st">&quot;West&quot;</span>, <span class="st">&quot;Developing&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(group) <span class="op">%&gt;%</span></span>
<span id="cb274-5"><a href="section-4-overview.html#cb274-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw">kable</span>()</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">group</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Developing</td>
<td align="right">87</td>
</tr>
<tr class="even">
<td align="left">West</td>
<td align="right">21</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="section-4-overview.html#cb276-1" aria-hidden="true"></a><span class="co"># smooth density plots - variable counts on y-axis</span></span>
<span id="cb276-2"><a href="section-4-overview.html#cb276-2" aria-hidden="true"></a>p &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span></span>
<span id="cb276-3"><a href="section-4-overview.html#cb276-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span>past_year <span class="op">&amp;</span><span class="st"> </span>country <span class="op">%in%</span><span class="st"> </span>country_list) <span class="op">%&gt;%</span></span>
<span id="cb276-4"><a href="section-4-overview.html#cb276-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">ifelse</span>(region <span class="op">%in%</span><span class="st"> </span>west, <span class="st">&quot;West&quot;</span>, <span class="st">&quot;Developing&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb276-5"><a href="section-4-overview.html#cb276-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(dollars_per_day, <span class="dt">y =</span> ..count.., <span class="dt">fill =</span> group)) <span class="op">+</span></span>
<span id="cb276-6"><a href="section-4-overview.html#cb276-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>)</span>
<span id="cb276-7"><a href="section-4-overview.html#cb276-7" aria-hidden="true"></a>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">bw =</span> <span class="fl">0.75</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(year <span class="op">~</span><span class="st"> </span>.)</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-121-1.png" width="672" /></p>
<p><em>Code: Add new region groups with case_when</em></p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="section-4-overview.html#cb277-1" aria-hidden="true"></a><span class="co"># add group as a factor, grouping regions</span></span>
<span id="cb277-2"><a href="section-4-overview.html#cb277-2" aria-hidden="true"></a>gapminder &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span></span>
<span id="cb277-3"><a href="section-4-overview.html#cb277-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">case_when</span>(</span>
<span id="cb277-4"><a href="section-4-overview.html#cb277-4" aria-hidden="true"></a>        .<span class="op">$</span>region <span class="op">%in%</span><span class="st"> </span>west <span class="op">~</span><span class="st"> &quot;West&quot;</span>,</span>
<span id="cb277-5"><a href="section-4-overview.html#cb277-5" aria-hidden="true"></a>        .<span class="op">$</span>region <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Eastern Asia&quot;</span>, <span class="st">&quot;South-Eastern Asia&quot;</span>) <span class="op">~</span><span class="st"> &quot;East Asia&quot;</span>,</span>
<span id="cb277-6"><a href="section-4-overview.html#cb277-6" aria-hidden="true"></a>        .<span class="op">$</span>region <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Caribbean&quot;</span>, <span class="st">&quot;Central America&quot;</span>, <span class="st">&quot;South America&quot;</span>) <span class="op">~</span><span class="st"> &quot;Latin America&quot;</span>,</span>
<span id="cb277-7"><a href="section-4-overview.html#cb277-7" aria-hidden="true"></a>        .<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Africa&quot;</span> <span class="op">&amp;</span><span class="st"> </span>.<span class="op">$</span>region <span class="op">!=</span><span class="st"> &quot;Northern Africa&quot;</span> <span class="op">~</span><span class="st"> &quot;Sub-Saharan Africa&quot;</span>,</span>
<span id="cb277-8"><a href="section-4-overview.html#cb277-8" aria-hidden="true"></a>        <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Others&quot;</span>))</span>
<span id="cb277-9"><a href="section-4-overview.html#cb277-9" aria-hidden="true"></a></span>
<span id="cb277-10"><a href="section-4-overview.html#cb277-10" aria-hidden="true"></a><span class="co"># reorder factor levels</span></span>
<span id="cb277-11"><a href="section-4-overview.html#cb277-11" aria-hidden="true"></a>gapminder &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span></span>
<span id="cb277-12"><a href="section-4-overview.html#cb277-12" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">factor</span>(group, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Others&quot;</span>, <span class="st">&quot;Latin America&quot;</span>, <span class="st">&quot;East Asia&quot;</span>, <span class="st">&quot;Sub-Saharan Africa&quot;</span>, <span class="st">&quot;West&quot;</span>)))</span></code></pre></div>
<p><em>Code: Stacked density plot</em></p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="section-4-overview.html#cb278-1" aria-hidden="true"></a><span class="co"># note you must redefine p with the new gapminder object first</span></span>
<span id="cb278-2"><a href="section-4-overview.html#cb278-2" aria-hidden="true"></a>p &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span></span>
<span id="cb278-3"><a href="section-4-overview.html#cb278-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(past_year, present_year) <span class="op">&amp;</span><span class="st"> </span>country <span class="op">%in%</span><span class="st"> </span>country_list) <span class="op">%&gt;%</span></span>
<span id="cb278-4"><a href="section-4-overview.html#cb278-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(dollars_per_day, <span class="dt">fill =</span> group)) <span class="op">+</span></span>
<span id="cb278-5"><a href="section-4-overview.html#cb278-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>)</span>
<span id="cb278-6"><a href="section-4-overview.html#cb278-6" aria-hidden="true"></a></span>
<span id="cb278-7"><a href="section-4-overview.html#cb278-7" aria-hidden="true"></a><span class="co"># stacked density plot</span></span>
<span id="cb278-8"><a href="section-4-overview.html#cb278-8" aria-hidden="true"></a>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">bw =</span> <span class="fl">0.75</span>, <span class="dt">position =</span> <span class="st">&quot;stack&quot;</span>) <span class="op">+</span></span>
<span id="cb278-9"><a href="section-4-overview.html#cb278-9" aria-hidden="true"></a><span class="st">    </span><span class="kw">facet_grid</span>(year <span class="op">~</span><span class="st"> </span>.)</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-123-1.png" width="672" /></p>
<p><em>Code: Weighted stacked density plot</em></p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="section-4-overview.html#cb279-1" aria-hidden="true"></a><span class="co"># weighted stacked density plot</span></span>
<span id="cb279-2"><a href="section-4-overview.html#cb279-2" aria-hidden="true"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb279-3"><a href="section-4-overview.html#cb279-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(past_year, present_year) <span class="op">&amp;</span><span class="st"> </span>country <span class="op">%in%</span><span class="st"> </span>country_list) <span class="op">%&gt;%</span></span>
<span id="cb279-4"><a href="section-4-overview.html#cb279-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb279-5"><a href="section-4-overview.html#cb279-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">weight =</span> population<span class="op">/</span><span class="kw">sum</span>(population<span class="op">*</span><span class="dv">2</span>)) <span class="op">%&gt;%</span></span>
<span id="cb279-6"><a href="section-4-overview.html#cb279-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb279-7"><a href="section-4-overview.html#cb279-7" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(dollars_per_day, <span class="dt">fill =</span> group, <span class="dt">weight =</span> weight)) <span class="op">+</span></span>
<span id="cb279-8"><a href="section-4-overview.html#cb279-8" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span></span>
<span id="cb279-9"><a href="section-4-overview.html#cb279-9" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">bw =</span> <span class="fl">0.75</span>, <span class="dt">position =</span> <span class="st">&quot;stack&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(year <span class="op">~</span><span class="st"> </span>.)</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-124-1.png" width="672" /></p>
</div>
<div id="ecological-fallacy" class="section level2" number="5.10">
<h2><span class="header-section-number">5.10</span> Ecological Fallacy</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/gapminder.html#the-ecological-fallacy-and-importance-of-showing-the-data" target="_blank">here</a>.</p>
<p><strong>Key points</strong></p>
<ul>
<li>The <em>breaks</em> argument allows us to set the location of the axis labels and tick marks.</li>
<li>The <em>logistic</em> or <em>logit transformation</em> is defined as <span class="math inline">\(f(p) = log \frac{p}{1-p}\)</span>, or the log of odds. This scale is useful for highlighting differences near 0 or near 1 and converts fold changes into constant increases.</li>
<li>The <em>ecological fallacy</em> is assuming that conclusions made from the average of a group apply to all members of that group.</li>
</ul>
<p><em>Code</em></p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="section-4-overview.html#cb280-1" aria-hidden="true"></a><span class="co"># add additional cases</span></span>
<span id="cb280-2"><a href="section-4-overview.html#cb280-2" aria-hidden="true"></a>gapminder &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span></span>
<span id="cb280-3"><a href="section-4-overview.html#cb280-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">case_when</span>(</span>
<span id="cb280-4"><a href="section-4-overview.html#cb280-4" aria-hidden="true"></a>        .<span class="op">$</span>region <span class="op">%in%</span><span class="st"> </span>west <span class="op">~</span><span class="st"> &quot;The West&quot;</span>,</span>
<span id="cb280-5"><a href="section-4-overview.html#cb280-5" aria-hidden="true"></a>        .<span class="op">$</span>region <span class="op">%in%</span><span class="st"> &quot;Northern Africa&quot;</span> <span class="op">~</span><span class="st"> &quot;Northern Africa&quot;</span>,</span>
<span id="cb280-6"><a href="section-4-overview.html#cb280-6" aria-hidden="true"></a>        .<span class="op">$</span>region <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Eastern Asia&quot;</span>, <span class="st">&quot;South-Eastern Asia&quot;</span>) <span class="op">~</span><span class="st"> &quot;East Asia&quot;</span>,</span>
<span id="cb280-7"><a href="section-4-overview.html#cb280-7" aria-hidden="true"></a>        .<span class="op">$</span>region <span class="op">==</span><span class="st"> &quot;Southern Asia&quot;</span> <span class="op">~</span><span class="st"> &quot;Southern Asia&quot;</span>,</span>
<span id="cb280-8"><a href="section-4-overview.html#cb280-8" aria-hidden="true"></a>        .<span class="op">$</span>region <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Central America&quot;</span>, <span class="st">&quot;South America&quot;</span>, <span class="st">&quot;Caribbean&quot;</span>) <span class="op">~</span><span class="st"> &quot;Latin America&quot;</span>,</span>
<span id="cb280-9"><a href="section-4-overview.html#cb280-9" aria-hidden="true"></a>        .<span class="op">$</span>continent <span class="op">==</span><span class="st"> &quot;Africa&quot;</span> <span class="op">&amp;</span><span class="st"> </span>.<span class="op">$</span>region <span class="op">!=</span><span class="st"> &quot;Northern Africa&quot;</span> <span class="op">~</span><span class="st"> &quot;Sub-Saharan Africa&quot;</span>,</span>
<span id="cb280-10"><a href="section-4-overview.html#cb280-10" aria-hidden="true"></a>        .<span class="op">$</span>region <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Melanesia&quot;</span>, <span class="st">&quot;Micronesia&quot;</span>, <span class="st">&quot;Polynesia&quot;</span>) <span class="op">~</span><span class="st"> &quot;Pacific Islands&quot;</span>))</span>
<span id="cb280-11"><a href="section-4-overview.html#cb280-11" aria-hidden="true"></a></span>
<span id="cb280-12"><a href="section-4-overview.html#cb280-12" aria-hidden="true"></a><span class="co"># define a data frame with group average income and average infant survival rate</span></span>
<span id="cb280-13"><a href="section-4-overview.html#cb280-13" aria-hidden="true"></a>surv_income &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span></span>
<span id="cb280-14"><a href="section-4-overview.html#cb280-14" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">%in%</span><span class="st"> </span>present_year <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(gdp) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(infant_mortality) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(group)) <span class="op">%&gt;%</span></span>
<span id="cb280-15"><a href="section-4-overview.html#cb280-15" aria-hidden="true"></a><span class="st">    </span><span class="kw">group_by</span>(group) <span class="op">%&gt;%</span></span>
<span id="cb280-16"><a href="section-4-overview.html#cb280-16" aria-hidden="true"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">income =</span> <span class="kw">sum</span>(gdp)<span class="op">/</span><span class="kw">sum</span>(population)<span class="op">/</span><span class="dv">365</span>,</span>
<span id="cb280-17"><a href="section-4-overview.html#cb280-17" aria-hidden="true"></a>                        <span class="dt">infant_survival_rate =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(infant_mortality<span class="op">/</span><span class="dv">1000</span><span class="op">*</span>population)<span class="op">/</span><span class="kw">sum</span>(population))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="section-4-overview.html#cb282-1" aria-hidden="true"></a>surv_income <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(income)</span></code></pre></div>
<pre><code>## # A tibble: 7 x 3
##   group              income infant_survival_rate
##   &lt;chr&gt;               &lt;dbl&gt;                &lt;dbl&gt;
## 1 Sub-Saharan Africa   1.76                0.936
## 2 Southern Asia        2.07                0.952
## 3 Pacific Islands      2.70                0.956
## 4 Northern Africa      4.94                0.970
## 5 Latin America       13.2                 0.983
## 6 East Asia           13.4                 0.985
## 7 The West            77.1                 0.995</code></pre>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="section-4-overview.html#cb284-1" aria-hidden="true"></a><span class="co"># plot infant survival versus income, with transformed axes</span></span>
<span id="cb284-2"><a href="section-4-overview.html#cb284-2" aria-hidden="true"></a>surv_income <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(income, infant_survival_rate, <span class="dt">label =</span> group, <span class="dt">color =</span> group)) <span class="op">+</span></span>
<span id="cb284-3"><a href="section-4-overview.html#cb284-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>, <span class="dt">limit =</span> <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="dv">150</span>)) <span class="op">+</span></span>
<span id="cb284-4"><a href="section-4-overview.html#cb284-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;logit&quot;</span>, <span class="dt">limit =</span> <span class="kw">c</span>(<span class="fl">0.875</span>, <span class="fl">.9981</span>),</span>
<span id="cb284-5"><a href="section-4-overview.html#cb284-5" aria-hidden="true"></a>                                       <span class="dt">breaks =</span> <span class="kw">c</span>(.<span class="dv">85</span>, <span class="fl">.90</span>, <span class="fl">.95</span>, <span class="fl">.99</span>, <span class="fl">.995</span>, <span class="fl">.998</span>)) <span class="op">+</span></span>
<span id="cb284-6"><a href="section-4-overview.html#cb284-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_label</span>(<span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-125-1.png" width="672" /></p>
</div>
<div id="assessment---exploring-the-gapminder-dataset" class="section level2" number="5.11">
<h2><span class="header-section-number">5.11</span> Assessment - Exploring the Gapminder Dataset</h2>
<ol style="list-style-type: decimal">
<li>The <a href="https://www.gapminder.org" target="_blank">Gapminder Foundation</a> is a non-profit organization based in Sweden that promotes global development through the use of statistics that can help reduce misconceptions about global development.</li>
</ol>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="section-4-overview.html#cb285-1" aria-hidden="true"></a><span class="co">## fill out the missing parts in filter and aes</span></span>
<span id="cb285-2"><a href="section-4-overview.html#cb285-2" aria-hidden="true"></a>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2012</span> <span class="op">&amp;</span><span class="st"> </span>continent <span class="op">==</span><span class="st"> &quot;Africa&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb285-3"><a href="section-4-overview.html#cb285-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(fertility, life_expectancy)) <span class="op">+</span></span>
<span id="cb285-4"><a href="section-4-overview.html#cb285-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-126-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Note that there is quite a bit of variability in life expectancy and fertility with some African countries having very high life expectancies.</li>
</ol>
<p>There also appear to be three clusters in the plot.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="section-4-overview.html#cb286-1" aria-hidden="true"></a>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2012</span> <span class="op">&amp;</span><span class="st"> </span>continent <span class="op">==</span><span class="st"> &quot;Africa&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb286-2"><a href="section-4-overview.html#cb286-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(fertility, life_expectancy, <span class="dt">color =</span> region)) <span class="op">+</span></span>
<span id="cb286-3"><a href="section-4-overview.html#cb286-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-127-1.png" width="672" /></p>
<ol start="3" style="list-style-type: decimal">
<li>While many of the countries in the high life expectancy/low fertility cluster are from Northern Africa, three countries are not.</li>
</ol>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="section-4-overview.html#cb287-1" aria-hidden="true"></a>df &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2012</span> <span class="op">&amp;</span><span class="st"> </span>continent <span class="op">==</span><span class="st"> &quot;Africa&quot;</span>, fertility <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;</span><span class="st"> </span>life_expectancy <span class="op">&gt;=</span><span class="st"> </span><span class="dv">70</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(country, region)</span>
<span id="cb287-2"><a href="section-4-overview.html#cb287-2" aria-hidden="true"></a>df</span></code></pre></div>
<pre><code>##      country          region
## 1    Algeria Northern Africa
## 2 Cape Verde  Western Africa
## 3      Egypt Northern Africa
## 4      Libya Northern Africa
## 5  Mauritius  Eastern Africa
## 6    Morocco Northern Africa
## 7 Seychelles  Eastern Africa
## 8    Tunisia Northern Africa</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>The Vietnam War lasted from 1955 to 1975.</li>
</ol>
<p>Do the data support war having a negative effect on life expectancy? We will create a time series plot that covers the period from 1960 to 2010 of life expectancy for Vietnam and the United States, using color to distinguish the two countries. In this start we start the analysis by generating a table.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="section-4-overview.html#cb289-1" aria-hidden="true"></a>tab &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1960</span> <span class="op">&amp;</span><span class="st"> </span>year <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2010</span> <span class="op">&amp;</span><span class="st"> </span>country<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;Vietnam&quot;</span>, <span class="st">&quot;United States&quot;</span>))</span>
<span id="cb289-2"><a href="section-4-overview.html#cb289-2" aria-hidden="true"></a>tab</span></code></pre></div>
<pre><code>##          country year infant_mortality life_expectancy fertility population          gdp continent             region dollars_per_day     group
## 1  United States 1960             25.9           69.91      3.67  186176524 2.479391e+12  Americas   Northern America      36.4860841  The West
## 2        Vietnam 1960             75.6           58.52      6.35   32670623           NA      Asia South-Eastern Asia              NA East Asia
## 3  United States 1961             25.4           70.32      3.63  189077076 2.536417e+12  Americas   Northern America      36.7526728  The West
## 4        Vietnam 1961             72.6           59.17      6.39   33666768           NA      Asia South-Eastern Asia              NA East Asia
## 5  United States 1962             24.9           70.21      3.48  191860710 2.691139e+12  Americas   Northern America      38.4288283  The West
## 6        Vietnam 1962             69.9           59.82      6.43   34684164           NA      Asia South-Eastern Asia              NA East Asia
## 7  United States 1963             24.4           70.04      3.35  194513911 2.809549e+12  Americas   Northern America      39.5724576  The West
## 8        Vietnam 1963             67.3           60.42      6.45   35722092           NA      Asia South-Eastern Asia              NA East Asia
## 9  United States 1964             23.8           70.33      3.22  197028908 2.972502e+12  Americas   Northern America      41.3332358  The West
## 10       Vietnam 1964             61.7           60.95      6.46   36780984           NA      Asia South-Eastern Asia              NA East Asia
## 11 United States 1965             23.3           70.41      2.93  199403532 3.162743e+12  Americas   Northern America      43.4548382  The West
## 12       Vietnam 1965             60.7           61.32      6.48   37860014           NA      Asia South-Eastern Asia              NA East Asia
## 13 United States 1966             22.7           70.43      2.71  201629471 3.368321e+12  Americas   Northern America      45.7684897  The West
## 14       Vietnam 1966             59.9           61.36      6.49   38959335           NA      Asia South-Eastern Asia              NA East Asia
## 15 United States 1967             22.0           70.76      2.56  203713082 3.452529e+12  Americas   Northern America      46.4328711  The West
## 16       Vietnam 1967             59.0           61.06      6.49   40074695           NA      Asia South-Eastern Asia              NA East Asia
## 17 United States 1968             21.3           70.42      2.47  205687611 3.618250e+12  Americas   Northern America      48.1945141  The West
## 18       Vietnam 1968             58.2           60.45      6.49   41195833           NA      Asia South-Eastern Asia              NA East Asia
## 19 United States 1969             20.6           70.66      2.46  207599308 3.730416e+12  Americas   Northern America      49.2309826  The West
## 20       Vietnam 1969             57.3           59.63      6.49   42309662           NA      Asia South-Eastern Asia              NA East Asia
## 21 United States 1970             19.9           70.92      2.46  209485807 3.737877e+12  Americas   Northern America      48.8852142  The West
## 22       Vietnam 1970             56.4           58.78      6.47   43407291           NA      Asia South-Eastern Asia              NA East Asia
## 23 United States 1971             19.1           71.24      2.27  211357912 3.867133e+12  Americas   Northern America      50.1276977  The West
## 24       Vietnam 1971             55.5           58.17      6.42   44485910           NA      Asia South-Eastern Asia              NA East Asia
## 25 United States 1972             18.3           71.34      2.01  213219515 4.080668e+12  Americas   Northern America      52.4338121  The West
## 26       Vietnam 1972             54.7           58.00      6.35   45549487           NA      Asia South-Eastern Asia              NA East Asia
## 27 United States 1973             17.5           71.54      1.87  215092900 4.321881e+12  Americas   Northern America      55.0495657  The West
## 28       Vietnam 1973             53.8           58.35      6.25   46604726           NA      Asia South-Eastern Asia              NA East Asia
## 29 United States 1974             16.7           72.08      1.83  217001865 4.299437e+12  Americas   Northern America      54.2819231  The West
## 30       Vietnam 1974             52.8           59.23      6.13   47661770           NA      Asia South-Eastern Asia              NA East Asia
## 31 United States 1975             16.0           72.68      1.77  218963561 4.291009e+12  Americas   Northern America      53.6901599  The West
## 32       Vietnam 1975             51.8           60.54      5.97   48729397           NA      Asia South-Eastern Asia              NA East Asia
## 33 United States 1976             15.2           72.99      1.74  220993166 4.523528e+12  Americas   Northern America      56.0796900  The West
## 34       Vietnam 1976             50.9           62.07      5.80   49808071           NA      Asia South-Eastern Asia              NA East Asia
## 35 United States 1977             14.5           73.38      1.78  223090871 4.733337e+12  Americas   Northern America      58.1289879  The West
## 36       Vietnam 1977             49.8           63.58      5.61   50899504           NA      Asia South-Eastern Asia              NA East Asia
## 37 United States 1978             13.8           73.58      1.75  225239456 4.999656e+12  Americas   Northern America      60.8138968  The West
## 38       Vietnam 1978             48.8           64.86      5.42   52015279           NA      Asia South-Eastern Asia              NA East Asia
## 39 United States 1979             13.2           74.03      1.80  227411604 5.157035e+12  Americas   Northern America      62.1290351  The West
## 40       Vietnam 1979             47.8           65.84      5.23   53169674           NA      Asia South-Eastern Asia              NA East Asia
## 41 United States 1980             12.6           73.93      1.82  229588208 5.142220e+12  Americas   Northern America      61.3632291  The West
## 42       Vietnam 1980             46.8           66.49      5.05   54372518           NA      Asia South-Eastern Asia              NA East Asia
## 43 United States 1981             12.1           74.36      1.81  231765783 5.272896e+12  Americas   Northern America      62.3314167  The West
## 44       Vietnam 1981             45.8           66.86      4.87   55627743           NA      Asia South-Eastern Asia              NA East Asia
## 45 United States 1982             11.7           74.65      1.81  233953874 5.168479e+12  Americas   Northern America      60.5256797  The West
## 46       Vietnam 1982             44.8           67.10      4.69   56931822           NA      Asia South-Eastern Asia              NA East Asia
## 47 United States 1983             11.2           74.71      1.78  236161961 5.401886e+12  Americas   Northern America      62.6675327  The West
## 48       Vietnam 1983             43.9           67.30      4.52   58277391           NA      Asia South-Eastern Asia              NA East Asia
## 49 United States 1984             10.9           74.81      1.79  238404223 5.790542e+12  Americas   Northern America      66.5445377  The West
## 50       Vietnam 1984             43.0           67.51      4.36   59653092 1.145347e+10      Asia South-Eastern Asia       0.5260311 East Asia
## 51 United States 1985             10.6           74.79      1.84  240691557 6.028651e+12  Americas   Northern America      68.6224765  The West
## 52       Vietnam 1985             42.0           67.77      4.21   61049370 1.188938e+10      Asia South-Eastern Asia       0.5335622 East Asia
## 53 United States 1986             10.4           74.87      1.84  243032017 6.235265e+12  Americas   Northern America      70.2908174  The West
## 54       Vietnam 1986             41.0           68.07      4.06   62459557 1.222101e+10      Asia South-Eastern Asia       0.5360622 East Asia
## 55 United States 1987             10.2           75.01      1.87  245425409 6.432743e+12  Americas   Northern America      71.8098149  The West
## 56       Vietnam 1987             40.0           68.38      3.93   63881296 1.265894e+10      Asia South-Eastern Asia       0.5429137 East Asia
## 57 United States 1988             10.0           75.02      1.92  247865202 6.696490e+12  Americas   Northern America      74.0182447  The West
## 58       Vietnam 1988             38.9           68.68      3.81   65313709 1.330898e+10      Asia South-Eastern Asia       0.5582742 East Asia
## 59 United States 1989              9.7           75.10      2.00  250340795 6.935219e+12  Americas   Northern America      75.8989379  The West
## 60       Vietnam 1989             37.7           69.00      3.68   66757401 1.428912e+10      Asia South-Eastern Asia       0.5864260 East Asia
## 61 United States 1990              9.4           75.40      2.07  252847810 7.063943e+12  Americas   Northern America      76.5411775  The West
## 62       Vietnam 1990             36.6           69.30      3.56   68209604 1.501800e+10      Asia South-Eastern Asia       0.6032171 East Asia
## 63 United States 1991              9.1           75.50      2.06  255367160 7.045491e+12  Americas   Northern America      75.5880837  The West
## 64       Vietnam 1991             35.4           69.60      3.42   69670620 1.591320e+10      Asia South-Eastern Asia       0.6257703 East Asia
## 65 United States 1992              8.8           75.80      2.04  257908206 7.285373e+12  Americas   Northern America      77.3915942  The West
## 66       Vietnam 1992             34.3           69.80      3.26   71129537 1.728906e+10      Asia South-Eastern Asia       0.6659299 East Asia
## 67 United States 1993              8.5           75.70      2.02  260527420 7.494650e+12  Americas   Northern America      78.8143037  The West
## 68       Vietnam 1993             33.1           70.10      3.07   72558986 1.868476e+10      Asia South-Eastern Asia       0.7055104 East Asia
## 69 United States 1994              8.2           75.80      2.00  263301323 7.803020e+12  Americas   Northern America      81.1926662  The West
## 70       Vietnam 1994             32.0           70.30      2.88   73923849 2.033630e+10      Asia South-Eastern Asia       0.7536931 East Asia
## 71 United States 1995              8.0           75.90      1.98  266275528 8.001917e+12  Americas   Northern America      82.3322348  The West
## 72       Vietnam 1995             30.9           70.60      2.68   75198975 2.227648e+10      Asia South-Eastern Asia       0.8115996 East Asia
## 73 United States 1996              7.7           76.30      1.98  269483224 8.304875e+12  Americas   Northern America      84.4322774  The West
## 74       Vietnam 1996             29.9           70.90      2.48   76375677 2.435711e+10      Asia South-Eastern Asia       0.8737312 East Asia
## 75 United States 1997              7.5           76.60      1.97  272882865 8.679071e+12  Americas   Northern America      87.1373006  The West
## 76       Vietnam 1997             28.9           71.10      2.31   77460429 2.634272e+10      Asia South-Eastern Asia       0.9317253 East Asia
## 77 United States 1998              7.3           76.80      2.00  276354096 9.061073e+12  Americas   Northern America      89.8298924  The West
## 78       Vietnam 1998             27.9           71.50      2.17   78462888 2.786124e+10      Asia South-Eastern Asia       0.9728441 East Asia
## 79 United States 1999              7.2           76.90      2.01  279730801 9.502248e+12  Americas   Northern America      93.0664656  The West
## 80       Vietnam 1999             27.0           71.70      2.06   79399708 2.919122e+10      Asia South-Eastern Asia       1.0072573 East Asia
## 81 United States 2000              7.1           76.90      2.05  282895741 9.898800e+12  Americas   Northern America      95.8657062  The West
## 82       Vietnam 2000             26.1           72.00      1.98   80285563 3.117252e+10      Asia South-Eastern Asia       1.0637548 East Asia
## 83 United States 2001              7.0           76.90      2.03  285796198 1.000703e+13  Americas   Northern America      95.9303301  The West
## 84       Vietnam 2001             25.3           72.20      1.94   81123685 3.332183e+10      Asia South-Eastern Asia       1.1253518 East Asia
## 85 United States 2002              6.9           77.10      2.02  288470847 1.018996e+13  Americas   Northern America      96.7782269  The West
## 86       Vietnam 2002             24.6           72.50      1.92   81917488 3.568108e+10      Asia South-Eastern Asia       1.1933517 East Asia
## 87 United States 2003              6.8           77.30      2.05  291005482 1.045007e+13  Americas   Northern America      98.3841464  The West
## 88       Vietnam 2003             23.9           72.80      1.91   82683039 3.830049e+10      Asia South-Eastern Asia       1.2690975 East Asia
## 89 United States 2004              6.9           77.60      2.06  293530886 1.081371e+13  Americas   Northern America     100.9317862  The West
## 90       Vietnam 2004             23.2           73.00      1.90   83439812 4.128394e+10      Asia South-Eastern Asia       1.3555482 East Asia
##  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 12 rows ]</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Now that you have created the data table in Exercise 4, it is time to plot the data for the two countries.</li>
</ol>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="section-4-overview.html#cb291-1" aria-hidden="true"></a>p &lt;-<span class="st"> </span>tab <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year,life_expectancy,<span class="dt">color=</span>country)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>()</span>
<span id="cb291-2"><a href="section-4-overview.html#cb291-2" aria-hidden="true"></a>p</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-130-1.png" width="672" /></p>
<ol start="6" style="list-style-type: decimal">
<li>Cambodia was also involved in this conflict and, after the war, Pol Pot and his communist Khmer Rouge took control and ruled Cambodia from 1975 to 1979.</li>
</ol>
<p>He is considered one of the most brutal dictators in history. Do the data support this claim?</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="section-4-overview.html#cb292-1" aria-hidden="true"></a>p &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1960</span> <span class="op">&amp;</span><span class="st"> </span>year <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2010</span> <span class="op">&amp;</span><span class="st"> </span>country <span class="op">==</span><span class="st"> &quot;Cambodia&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, life_expectancy)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>()</span>
<span id="cb292-2"><a href="section-4-overview.html#cb292-2" aria-hidden="true"></a>p</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-131-1.png" width="672" /></p>
<ol start="7" style="list-style-type: decimal">
<li>Now we are going to calculate and plot dollars per day for African countries in 2010 using GDP data.</li>
</ol>
<p>In the first part of this analysis, we will create the dollars per day variable.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="section-4-overview.html#cb293-1" aria-hidden="true"></a>daydollars &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span></span>
<span id="cb293-2"><a href="section-4-overview.html#cb293-2" aria-hidden="true"></a><span class="kw">mutate</span>(<span class="dt">dollars_per_day =</span> gdp<span class="op">/</span>population<span class="op">/</span><span class="dv">365</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(continent <span class="op">==</span><span class="st"> &quot;Africa&quot;</span> <span class="op">&amp;</span><span class="st"> </span>year <span class="op">==</span><span class="st"> </span><span class="dv">2010</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(gdp))</span>
<span id="cb293-3"><a href="section-4-overview.html#cb293-3" aria-hidden="true"></a>daydollars</span></code></pre></div>
<pre><code>##                     country year infant_mortality life_expectancy fertility population          gdp continent          region dollars_per_day              group
## 1                   Algeria 2010             23.5            76.0      2.82   36036159  79164339611    Africa Northern Africa       6.0186382    Northern Africa
## 2                    Angola 2010            109.6            57.6      6.22   21219954  26125663270    Africa   Middle Africa       3.3731063 Sub-Saharan Africa
## 3                     Benin 2010             71.0            60.8      5.10    9509798   3336801340    Africa  Western Africa       0.9613161 Sub-Saharan Africa
## 4                  Botswana 2010             39.8            55.6      2.76    2047831   8408166868    Africa Southern Africa      11.2490111 Sub-Saharan Africa
## 5              Burkina Faso 2010             69.7            59.0      5.87   15632066   4655655008    Africa  Western Africa       0.8159650 Sub-Saharan Africa
## 6                   Burundi 2010             63.8            60.4      6.30    9461117   1158914103    Africa  Eastern Africa       0.3355954 Sub-Saharan Africa
## 7                  Cameroon 2010             66.2            57.8      5.02   20590666  13986616694    Africa   Middle Africa       1.8610130 Sub-Saharan Africa
## 8                Cape Verde 2010             23.3            71.1      2.43     490379    971606715    Africa  Western Africa       5.4283242 Sub-Saharan Africa
## 9  Central African Republic 2010            101.7            47.9      4.63    4444973   1054122016    Africa   Middle Africa       0.6497240 Sub-Saharan Africa
## 10                     Chad 2010             93.6            55.8      6.60   11896380   3369354207    Africa   Middle Africa       0.7759594 Sub-Saharan Africa
## 11                  Comoros 2010             63.1            67.7      4.92     698695    247231031    Africa  Eastern Africa       0.9694434 Sub-Saharan Africa
## 12         Congo, Dem. Rep. 2010             84.8            58.4      6.25   65938712   6961485000    Africa   Middle Africa       0.2892468 Sub-Saharan Africa
## 13              Congo, Rep. 2010             42.2            60.4      5.07    4066078   5067059617    Africa   Middle Africa       3.4141881 Sub-Saharan Africa
## 14            Cote d&#39;Ivoire 2010             76.9            56.6      4.91   20131707  11603002049    Africa  Western Africa       1.5790537 Sub-Saharan Africa
## 15                    Egypt 2010             24.3            70.1      2.88   82040994 160258746162    Africa Northern Africa       5.3517764    Northern Africa
## 16        Equatorial Guinea 2010             78.9            58.6      5.14     728710   5979285835    Africa   Middle Africa      22.4802803 Sub-Saharan Africa
## 17                  Eritrea 2010             39.4            60.1      4.97    4689664    771116883    Africa  Eastern Africa       0.4504905 Sub-Saharan Africa
## 18                 Ethiopia 2010             50.8            62.1      4.90   87561814  18291486355    Africa  Eastern Africa       0.5723232 Sub-Saharan Africa
## 19                    Gabon 2010             42.8            63.0      4.21    1541936   6343809583    Africa   Middle Africa      11.2717391 Sub-Saharan Africa
## 20                   Gambia 2010             51.7            66.5      5.80    1693002   1217357172    Africa  Western Africa       1.9700066 Sub-Saharan Africa
## 21                    Ghana 2010             50.2            62.9      4.05   24317734   8779397392    Africa  Western Africa       0.9891194 Sub-Saharan Africa
## 22                   Guinea 2010             71.2            57.9      5.17   11012406   5493989673    Africa  Western Africa       1.3668245 Sub-Saharan Africa
## 23            Guinea-Bissau 2010             73.4            54.3      5.12    1634196    244395463    Africa  Western Africa       0.4097285 Sub-Saharan Africa
## 24                    Kenya 2010             42.4            62.9      4.62   40328313  18988282813    Africa  Eastern Africa       1.2899794 Sub-Saharan Africa
## 25                  Lesotho 2010             75.2            46.4      3.21    2010586   1076239050    Africa Southern Africa       1.4665377 Sub-Saharan Africa
## 26                  Liberia 2010             65.2            60.8      5.02    3957990   1040653199    Africa  Western Africa       0.7203416 Sub-Saharan Africa
## 27               Madagascar 2010             42.1            62.4      4.65   21079532   5026822443    Africa  Eastern Africa       0.6533407 Sub-Saharan Africa
## 28                   Malawi 2010             57.5            55.4      5.64   14769824   2758392725    Africa  Eastern Africa       0.5116676 Sub-Saharan Africa
## 29                     Mali 2010             82.9            59.2      6.84   15167286   4199858651    Africa  Western Africa       0.7586368 Sub-Saharan Africa
## 30               Mauritania 2010             70.1            68.6      4.84    3591400   2107593972    Africa  Western Africa       1.6077936 Sub-Saharan Africa
## 31                Mauritius 2010             13.3            73.4      1.52    1247951   6636426093    Africa  Eastern Africa      14.5694737 Sub-Saharan Africa
## 32                  Morocco 2010             28.5            73.7      2.58   32107739  59908047776    Africa Northern Africa       5.1119027    Northern Africa
## 33               Mozambique 2010             71.9            54.4      5.41   24321457   8972305823    Africa  Eastern Africa       1.0106985 Sub-Saharan Africa
## 34                  Namibia 2010             37.5            61.4      3.23    2193643   6155469329    Africa Southern Africa       7.6878050 Sub-Saharan Africa
## 35                    Niger 2010             66.1            59.2      7.58   16291990   2781188119    Africa  Western Africa       0.4676957 Sub-Saharan Africa
## 36                  Nigeria 2010             81.5            61.2      6.02  159424742  85581744176    Africa  Western Africa       1.4707286 Sub-Saharan Africa
## 37                   Rwanda 2010             43.8            65.1      4.84   10293669   3583713093    Africa  Eastern Africa       0.9538282 Sub-Saharan Africa
## 38                  Senegal 2010             46.7            64.2      5.05   12956791   6984284544    Africa  Western Africa       1.4768337 Sub-Saharan Africa
## 39               Seychelles 2010             12.2            73.1      2.26      93081    760361490    Africa  Eastern Africa      22.3803157 Sub-Saharan Africa
## 40             Sierra Leone 2010            107.0            55.0      4.94    5775902   1574302614    Africa  Western Africa       0.7467505 Sub-Saharan Africa
## 41             South Africa 2010             38.2            54.9      2.47   51621594 187639624489    Africa Southern Africa       9.9586457 Sub-Saharan Africa
## 42                    Sudan 2010             53.3            66.1      4.64   36114885  22819076998    Africa Northern Africa       1.7310873    Northern Africa
## 43                Swaziland 2010             59.1            46.4      3.56    1193148   1911603442    Africa Southern Africa       4.3894552 Sub-Saharan Africa
## 44                 Tanzania 2010             42.4            61.4      5.43   45648525  19965679449    Africa  Eastern Africa       1.1982970 Sub-Saharan Africa
## 45                     Togo 2010             59.3            58.7      4.79    6390851   1595792895    Africa  Western Africa       0.6841085 Sub-Saharan Africa
## 46                  Tunisia 2010             14.9            77.1      2.04   10639194  33161453137    Africa Northern Africa       8.5394905    Northern Africa
## 47                   Uganda 2010             49.5            57.8      6.16   33149417  12701095116    Africa  Eastern Africa       1.0497174 Sub-Saharan Africa
## 48                   Zambia 2010             52.9            53.1      5.81   13917439   5587389858    Africa  Eastern Africa       1.0999091 Sub-Saharan Africa
## 49                 Zimbabwe 2010             55.8            49.1      3.72   13973897   4032423429    Africa  Eastern Africa       0.7905980 Sub-Saharan Africa</code></pre>
<ol start="8" style="list-style-type: decimal">
<li>Now we are going to calculate and plot dollars per day for African countries in 2010 using GDP data.</li>
</ol>
<p>In the second part of this analysis, we will plot the smooth density plot using a log (base 2) x axis.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="section-4-overview.html#cb295-1" aria-hidden="true"></a>p &lt;-<span class="st"> </span>daydollars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(dollars_per_day)) <span class="op">+</span></span>
<span id="cb295-2"><a href="section-4-overview.html#cb295-2" aria-hidden="true"></a><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>()</span>
<span id="cb295-3"><a href="section-4-overview.html#cb295-3" aria-hidden="true"></a>p</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-133-1.png" width="672" /></p>
<ol start="9" style="list-style-type: decimal">
<li>Now we are going to combine the plotting tools we have used in the past two exercises to create density plots for multiple years.</li>
</ol>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="section-4-overview.html#cb296-1" aria-hidden="true"></a>daydollars &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span></span>
<span id="cb296-2"><a href="section-4-overview.html#cb296-2" aria-hidden="true"></a><span class="kw">mutate</span>(<span class="dt">dollars_per_day =</span> gdp<span class="op">/</span>population<span class="op">/</span><span class="dv">365</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(continent <span class="op">==</span><span class="st"> &quot;Africa&quot;</span> <span class="op">&amp;</span><span class="st"> </span>year<span class="op">%in%</span><span class="kw">c</span>(<span class="dv">1970</span>,<span class="dv">2010</span>) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(gdp))</span>
<span id="cb296-3"><a href="section-4-overview.html#cb296-3" aria-hidden="true"></a>daydollars</span></code></pre></div>
<pre><code>##                     country year infant_mortality life_expectancy fertility population          gdp continent          region dollars_per_day              group
## 1                   Algeria 1970            146.0           52.41      7.64   14550033  19741305571    Africa Northern Africa       3.7172265    Northern Africa
## 2                     Benin 1970            157.1           43.93      6.75    2907769    831774871    Africa  Western Africa       0.7837057 Sub-Saharan Africa
## 3                  Botswana 1970             85.3           54.30      6.64     693021    283867117    Africa Southern Africa       1.1222144 Sub-Saharan Africa
## 4              Burkina Faso 1970            149.3           40.27      6.62    5624597    795164207    Africa  Western Africa       0.3873223 Sub-Saharan Africa
## 5                   Burundi 1970            146.4           42.76      7.31    3457113    524049198    Africa  Eastern Africa       0.4153035 Sub-Saharan Africa
## 6                  Cameroon 1970            126.2           48.97      6.21    6770967   3372153343    Africa   Middle Africa       1.3644693 Sub-Saharan Africa
## 7  Central African Republic 1970            137.0           43.36      5.95    1828710    647622869    Africa   Middle Africa       0.9702518 Sub-Saharan Africa
## 8                      Chad 1970            135.9           45.72      6.53    3644911    829387598    Africa   Middle Africa       0.6234157 Sub-Saharan Africa
## 9          Congo, Dem. Rep. 1970            149.0           48.13      6.21   20009902   6728080745    Africa   Middle Africa       0.9211988 Sub-Saharan Africa
## 10              Congo, Rep. 1970             88.5           52.85      6.26    1335090    939633199    Africa   Middle Africa       1.9282127 Sub-Saharan Africa
## 11            Cote d&#39;Ivoire 1970            161.0           45.38      7.91    5241914   4619775632    Africa  Western Africa       2.4145607 Sub-Saharan Africa
## 12                    Egypt 1970            162.0           52.54      5.94   34808599  20331718433    Africa Northern Africa       1.6002752    Northern Africa
## 13                    Gabon 1970               NA           45.55      5.08     590119   1722664256    Africa   Middle Africa       7.9977566 Sub-Saharan Africa
## 14                   Gambia 1970            126.0           43.31      6.09     447283    247459869    Africa  Western Africa       1.5157568 Sub-Saharan Africa
## 15                    Ghana 1970            120.1           50.08      6.95    8596977   2549677064    Africa  Western Africa       0.8125434 Sub-Saharan Africa
## 16            Guinea-Bissau 1970               NA           45.50      6.07     711828    104038537    Africa  Western Africa       0.4004297 Sub-Saharan Africa
## 17                    Kenya 1970             91.3           53.83      8.08   11252466   3276361787    Africa  Eastern Africa       0.7977215 Sub-Saharan Africa
## 18                  Lesotho 1970            131.6           49.67      5.81    1032240    184783955    Africa Southern Africa       0.4904454 Sub-Saharan Africa
## 19                  Liberia 1970            191.3           40.10      6.70    1419728   1094083642    Africa  Western Africa       2.1113125 Sub-Saharan Africa
## 20               Madagascar 1970             93.2           47.77      7.33    6576301   2807129955    Africa  Eastern Africa       1.1694670 Sub-Saharan Africa
## 21                   Malawi 1970            207.7           41.62      7.30    4603739    549382768    Africa  Eastern Africa       0.3269426 Sub-Saharan Africa
## 22                     Mali 1970            195.7           34.51      6.90    5949043   1038617256    Africa  Western Africa       0.4783167 Sub-Saharan Africa
## 23               Mauritania 1970            108.5           49.77      6.78    1148908    700627427    Africa  Western Africa       1.6707406 Sub-Saharan Africa
## 24                  Morocco 1970            120.8           54.34      6.69   16039600  12097898528    Africa Northern Africa       2.0664435    Northern Africa
## 25                    Niger 1970            137.6           38.24      7.42    4497355   1343819364    Africa  Western Africa       0.8186360 Sub-Saharan Africa
## 26                  Nigeria 1970            168.9           41.79      6.47   56131844  19793025795    Africa  Western Africa       0.9660732 Sub-Saharan Africa
## 27                   Rwanda 1970            129.4           45.58      8.23    3754546    809941587    Africa  Eastern Africa       0.5910217 Sub-Saharan Africa
## 28                  Senegal 1970            121.7           39.59      7.34    4217754   2266115562    Africa  Western Africa       1.4720005 Sub-Saharan Africa
## 29               Seychelles 1970             54.1           64.62      5.76      52364    141888524    Africa  Eastern Africa       7.4237202 Sub-Saharan Africa
## 30             Sierra Leone 1970            191.0           43.15      6.70    2514151    739785784    Africa  Western Africa       0.8061610 Sub-Saharan Africa
## 31             South Africa 1970               NA           52.77      5.59   22502502  68558449204    Africa Southern Africa       8.3471326 Sub-Saharan Africa
## 32                    Sudan 1970             94.7           54.26      6.89   10232758   3901968151    Africa Northern Africa       1.0447158    Northern Africa
## 33                Swaziland 1970            119.3           48.79      6.88     445844    257078586    Africa Southern Africa       1.5797564 Sub-Saharan Africa
## 34                     Togo 1970            132.8           47.72      7.08    2115521    618863063    Africa  Western Africa       0.8014646 Sub-Saharan Africa
## 35                  Tunisia 1970            122.2           52.94      6.44    5060393   4688590613    Africa Northern Africa       2.5384301    Northern Africa
## 36                   Zambia 1970            109.3           53.88      7.44    4185378   2384401746    Africa  Eastern Africa       1.5608166 Sub-Saharan Africa
## 37                 Zimbabwe 1970             72.4           57.22      7.42    5206311   2682438620    Africa  Eastern Africa       1.4115843 Sub-Saharan Africa
## 38                  Algeria 2010             23.5           76.00      2.82   36036159  79164339611    Africa Northern Africa       6.0186382    Northern Africa
## 39                   Angola 2010            109.6           57.60      6.22   21219954  26125663270    Africa   Middle Africa       3.3731063 Sub-Saharan Africa
## 40                    Benin 2010             71.0           60.80      5.10    9509798   3336801340    Africa  Western Africa       0.9613161 Sub-Saharan Africa
## 41                 Botswana 2010             39.8           55.60      2.76    2047831   8408166868    Africa Southern Africa      11.2490111 Sub-Saharan Africa
## 42             Burkina Faso 2010             69.7           59.00      5.87   15632066   4655655008    Africa  Western Africa       0.8159650 Sub-Saharan Africa
## 43                  Burundi 2010             63.8           60.40      6.30    9461117   1158914103    Africa  Eastern Africa       0.3355954 Sub-Saharan Africa
## 44                 Cameroon 2010             66.2           57.80      5.02   20590666  13986616694    Africa   Middle Africa       1.8610130 Sub-Saharan Africa
## 45               Cape Verde 2010             23.3           71.10      2.43     490379    971606715    Africa  Western Africa       5.4283242 Sub-Saharan Africa
## 46 Central African Republic 2010            101.7           47.90      4.63    4444973   1054122016    Africa   Middle Africa       0.6497240 Sub-Saharan Africa
## 47                     Chad 2010             93.6           55.80      6.60   11896380   3369354207    Africa   Middle Africa       0.7759594 Sub-Saharan Africa
## 48                  Comoros 2010             63.1           67.70      4.92     698695    247231031    Africa  Eastern Africa       0.9694434 Sub-Saharan Africa
## 49         Congo, Dem. Rep. 2010             84.8           58.40      6.25   65938712   6961485000    Africa   Middle Africa       0.2892468 Sub-Saharan Africa
## 50              Congo, Rep. 2010             42.2           60.40      5.07    4066078   5067059617    Africa   Middle Africa       3.4141881 Sub-Saharan Africa
## 51            Cote d&#39;Ivoire 2010             76.9           56.60      4.91   20131707  11603002049    Africa  Western Africa       1.5790537 Sub-Saharan Africa
## 52                    Egypt 2010             24.3           70.10      2.88   82040994 160258746162    Africa Northern Africa       5.3517764    Northern Africa
## 53        Equatorial Guinea 2010             78.9           58.60      5.14     728710   5979285835    Africa   Middle Africa      22.4802803 Sub-Saharan Africa
## 54                  Eritrea 2010             39.4           60.10      4.97    4689664    771116883    Africa  Eastern Africa       0.4504905 Sub-Saharan Africa
## 55                 Ethiopia 2010             50.8           62.10      4.90   87561814  18291486355    Africa  Eastern Africa       0.5723232 Sub-Saharan Africa
## 56                    Gabon 2010             42.8           63.00      4.21    1541936   6343809583    Africa   Middle Africa      11.2717391 Sub-Saharan Africa
## 57                   Gambia 2010             51.7           66.50      5.80    1693002   1217357172    Africa  Western Africa       1.9700066 Sub-Saharan Africa
## 58                    Ghana 2010             50.2           62.90      4.05   24317734   8779397392    Africa  Western Africa       0.9891194 Sub-Saharan Africa
## 59                   Guinea 2010             71.2           57.90      5.17   11012406   5493989673    Africa  Western Africa       1.3668245 Sub-Saharan Africa
## 60            Guinea-Bissau 2010             73.4           54.30      5.12    1634196    244395463    Africa  Western Africa       0.4097285 Sub-Saharan Africa
## 61                    Kenya 2010             42.4           62.90      4.62   40328313  18988282813    Africa  Eastern Africa       1.2899794 Sub-Saharan Africa
## 62                  Lesotho 2010             75.2           46.40      3.21    2010586   1076239050    Africa Southern Africa       1.4665377 Sub-Saharan Africa
## 63                  Liberia 2010             65.2           60.80      5.02    3957990   1040653199    Africa  Western Africa       0.7203416 Sub-Saharan Africa
## 64               Madagascar 2010             42.1           62.40      4.65   21079532   5026822443    Africa  Eastern Africa       0.6533407 Sub-Saharan Africa
## 65                   Malawi 2010             57.5           55.40      5.64   14769824   2758392725    Africa  Eastern Africa       0.5116676 Sub-Saharan Africa
## 66                     Mali 2010             82.9           59.20      6.84   15167286   4199858651    Africa  Western Africa       0.7586368 Sub-Saharan Africa
## 67               Mauritania 2010             70.1           68.60      4.84    3591400   2107593972    Africa  Western Africa       1.6077936 Sub-Saharan Africa
## 68                Mauritius 2010             13.3           73.40      1.52    1247951   6636426093    Africa  Eastern Africa      14.5694737 Sub-Saharan Africa
## 69                  Morocco 2010             28.5           73.70      2.58   32107739  59908047776    Africa Northern Africa       5.1119027    Northern Africa
## 70               Mozambique 2010             71.9           54.40      5.41   24321457   8972305823    Africa  Eastern Africa       1.0106985 Sub-Saharan Africa
## 71                  Namibia 2010             37.5           61.40      3.23    2193643   6155469329    Africa Southern Africa       7.6878050 Sub-Saharan Africa
## 72                    Niger 2010             66.1           59.20      7.58   16291990   2781188119    Africa  Western Africa       0.4676957 Sub-Saharan Africa
## 73                  Nigeria 2010             81.5           61.20      6.02  159424742  85581744176    Africa  Western Africa       1.4707286 Sub-Saharan Africa
## 74                   Rwanda 2010             43.8           65.10      4.84   10293669   3583713093    Africa  Eastern Africa       0.9538282 Sub-Saharan Africa
## 75                  Senegal 2010             46.7           64.20      5.05   12956791   6984284544    Africa  Western Africa       1.4768337 Sub-Saharan Africa
## 76               Seychelles 2010             12.2           73.10      2.26      93081    760361490    Africa  Eastern Africa      22.3803157 Sub-Saharan Africa
## 77             Sierra Leone 2010            107.0           55.00      4.94    5775902   1574302614    Africa  Western Africa       0.7467505 Sub-Saharan Africa
## 78             South Africa 2010             38.2           54.90      2.47   51621594 187639624489    Africa Southern Africa       9.9586457 Sub-Saharan Africa
## 79                    Sudan 2010             53.3           66.10      4.64   36114885  22819076998    Africa Northern Africa       1.7310873    Northern Africa
## 80                Swaziland 2010             59.1           46.40      3.56    1193148   1911603442    Africa Southern Africa       4.3894552 Sub-Saharan Africa
## 81                 Tanzania 2010             42.4           61.40      5.43   45648525  19965679449    Africa  Eastern Africa       1.1982970 Sub-Saharan Africa
## 82                     Togo 2010             59.3           58.70      4.79    6390851   1595792895    Africa  Western Africa       0.6841085 Sub-Saharan Africa
## 83                  Tunisia 2010             14.9           77.10      2.04   10639194  33161453137    Africa Northern Africa       8.5394905    Northern Africa
## 84                   Uganda 2010             49.5           57.80      6.16   33149417  12701095116    Africa  Eastern Africa       1.0497174 Sub-Saharan Africa
## 85                   Zambia 2010             52.9           53.10      5.81   13917439   5587389858    Africa  Eastern Africa       1.0999091 Sub-Saharan Africa
## 86                 Zimbabwe 2010             55.8           49.10      3.72   13973897   4032423429    Africa  Eastern Africa       0.7905980 Sub-Saharan Africa</code></pre>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="section-4-overview.html#cb298-1" aria-hidden="true"></a>p &lt;-<span class="st"> </span>daydollars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(dollars_per_day)) <span class="op">+</span></span>
<span id="cb298-2"><a href="section-4-overview.html#cb298-2" aria-hidden="true"></a><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(.<span class="op">~</span>year)</span>
<span id="cb298-3"><a href="section-4-overview.html#cb298-3" aria-hidden="true"></a>p</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-134-1.png" width="672" /></p>
<ol start="10" style="list-style-type: decimal">
<li>Now we are going to edit the code from Exercise 9 to show stacked histograms of each region in Africa.</li>
</ol>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="section-4-overview.html#cb299-1" aria-hidden="true"></a>daydollars &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span></span>
<span id="cb299-2"><a href="section-4-overview.html#cb299-2" aria-hidden="true"></a><span class="kw">mutate</span>(<span class="dt">dollars_per_day =</span> gdp<span class="op">/</span>population<span class="op">/</span><span class="dv">365</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(continent <span class="op">==</span><span class="st"> &quot;Africa&quot;</span> <span class="op">&amp;</span><span class="st"> </span>year<span class="op">%in%</span><span class="kw">c</span>(<span class="dv">1970</span>,<span class="dv">2010</span>) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(gdp))</span>
<span id="cb299-3"><a href="section-4-overview.html#cb299-3" aria-hidden="true"></a>daydollars</span></code></pre></div>
<pre><code>##                     country year infant_mortality life_expectancy fertility population          gdp continent          region dollars_per_day              group
## 1                   Algeria 1970            146.0           52.41      7.64   14550033  19741305571    Africa Northern Africa       3.7172265    Northern Africa
## 2                     Benin 1970            157.1           43.93      6.75    2907769    831774871    Africa  Western Africa       0.7837057 Sub-Saharan Africa
## 3                  Botswana 1970             85.3           54.30      6.64     693021    283867117    Africa Southern Africa       1.1222144 Sub-Saharan Africa
## 4              Burkina Faso 1970            149.3           40.27      6.62    5624597    795164207    Africa  Western Africa       0.3873223 Sub-Saharan Africa
## 5                   Burundi 1970            146.4           42.76      7.31    3457113    524049198    Africa  Eastern Africa       0.4153035 Sub-Saharan Africa
## 6                  Cameroon 1970            126.2           48.97      6.21    6770967   3372153343    Africa   Middle Africa       1.3644693 Sub-Saharan Africa
## 7  Central African Republic 1970            137.0           43.36      5.95    1828710    647622869    Africa   Middle Africa       0.9702518 Sub-Saharan Africa
## 8                      Chad 1970            135.9           45.72      6.53    3644911    829387598    Africa   Middle Africa       0.6234157 Sub-Saharan Africa
## 9          Congo, Dem. Rep. 1970            149.0           48.13      6.21   20009902   6728080745    Africa   Middle Africa       0.9211988 Sub-Saharan Africa
## 10              Congo, Rep. 1970             88.5           52.85      6.26    1335090    939633199    Africa   Middle Africa       1.9282127 Sub-Saharan Africa
## 11            Cote d&#39;Ivoire 1970            161.0           45.38      7.91    5241914   4619775632    Africa  Western Africa       2.4145607 Sub-Saharan Africa
## 12                    Egypt 1970            162.0           52.54      5.94   34808599  20331718433    Africa Northern Africa       1.6002752    Northern Africa
## 13                    Gabon 1970               NA           45.55      5.08     590119   1722664256    Africa   Middle Africa       7.9977566 Sub-Saharan Africa
## 14                   Gambia 1970            126.0           43.31      6.09     447283    247459869    Africa  Western Africa       1.5157568 Sub-Saharan Africa
## 15                    Ghana 1970            120.1           50.08      6.95    8596977   2549677064    Africa  Western Africa       0.8125434 Sub-Saharan Africa
## 16            Guinea-Bissau 1970               NA           45.50      6.07     711828    104038537    Africa  Western Africa       0.4004297 Sub-Saharan Africa
## 17                    Kenya 1970             91.3           53.83      8.08   11252466   3276361787    Africa  Eastern Africa       0.7977215 Sub-Saharan Africa
## 18                  Lesotho 1970            131.6           49.67      5.81    1032240    184783955    Africa Southern Africa       0.4904454 Sub-Saharan Africa
## 19                  Liberia 1970            191.3           40.10      6.70    1419728   1094083642    Africa  Western Africa       2.1113125 Sub-Saharan Africa
## 20               Madagascar 1970             93.2           47.77      7.33    6576301   2807129955    Africa  Eastern Africa       1.1694670 Sub-Saharan Africa
## 21                   Malawi 1970            207.7           41.62      7.30    4603739    549382768    Africa  Eastern Africa       0.3269426 Sub-Saharan Africa
## 22                     Mali 1970            195.7           34.51      6.90    5949043   1038617256    Africa  Western Africa       0.4783167 Sub-Saharan Africa
## 23               Mauritania 1970            108.5           49.77      6.78    1148908    700627427    Africa  Western Africa       1.6707406 Sub-Saharan Africa
## 24                  Morocco 1970            120.8           54.34      6.69   16039600  12097898528    Africa Northern Africa       2.0664435    Northern Africa
## 25                    Niger 1970            137.6           38.24      7.42    4497355   1343819364    Africa  Western Africa       0.8186360 Sub-Saharan Africa
## 26                  Nigeria 1970            168.9           41.79      6.47   56131844  19793025795    Africa  Western Africa       0.9660732 Sub-Saharan Africa
## 27                   Rwanda 1970            129.4           45.58      8.23    3754546    809941587    Africa  Eastern Africa       0.5910217 Sub-Saharan Africa
## 28                  Senegal 1970            121.7           39.59      7.34    4217754   2266115562    Africa  Western Africa       1.4720005 Sub-Saharan Africa
## 29               Seychelles 1970             54.1           64.62      5.76      52364    141888524    Africa  Eastern Africa       7.4237202 Sub-Saharan Africa
## 30             Sierra Leone 1970            191.0           43.15      6.70    2514151    739785784    Africa  Western Africa       0.8061610 Sub-Saharan Africa
## 31             South Africa 1970               NA           52.77      5.59   22502502  68558449204    Africa Southern Africa       8.3471326 Sub-Saharan Africa
## 32                    Sudan 1970             94.7           54.26      6.89   10232758   3901968151    Africa Northern Africa       1.0447158    Northern Africa
## 33                Swaziland 1970            119.3           48.79      6.88     445844    257078586    Africa Southern Africa       1.5797564 Sub-Saharan Africa
## 34                     Togo 1970            132.8           47.72      7.08    2115521    618863063    Africa  Western Africa       0.8014646 Sub-Saharan Africa
## 35                  Tunisia 1970            122.2           52.94      6.44    5060393   4688590613    Africa Northern Africa       2.5384301    Northern Africa
## 36                   Zambia 1970            109.3           53.88      7.44    4185378   2384401746    Africa  Eastern Africa       1.5608166 Sub-Saharan Africa
## 37                 Zimbabwe 1970             72.4           57.22      7.42    5206311   2682438620    Africa  Eastern Africa       1.4115843 Sub-Saharan Africa
## 38                  Algeria 2010             23.5           76.00      2.82   36036159  79164339611    Africa Northern Africa       6.0186382    Northern Africa
## 39                   Angola 2010            109.6           57.60      6.22   21219954  26125663270    Africa   Middle Africa       3.3731063 Sub-Saharan Africa
## 40                    Benin 2010             71.0           60.80      5.10    9509798   3336801340    Africa  Western Africa       0.9613161 Sub-Saharan Africa
## 41                 Botswana 2010             39.8           55.60      2.76    2047831   8408166868    Africa Southern Africa      11.2490111 Sub-Saharan Africa
## 42             Burkina Faso 2010             69.7           59.00      5.87   15632066   4655655008    Africa  Western Africa       0.8159650 Sub-Saharan Africa
## 43                  Burundi 2010             63.8           60.40      6.30    9461117   1158914103    Africa  Eastern Africa       0.3355954 Sub-Saharan Africa
## 44                 Cameroon 2010             66.2           57.80      5.02   20590666  13986616694    Africa   Middle Africa       1.8610130 Sub-Saharan Africa
## 45               Cape Verde 2010             23.3           71.10      2.43     490379    971606715    Africa  Western Africa       5.4283242 Sub-Saharan Africa
## 46 Central African Republic 2010            101.7           47.90      4.63    4444973   1054122016    Africa   Middle Africa       0.6497240 Sub-Saharan Africa
## 47                     Chad 2010             93.6           55.80      6.60   11896380   3369354207    Africa   Middle Africa       0.7759594 Sub-Saharan Africa
## 48                  Comoros 2010             63.1           67.70      4.92     698695    247231031    Africa  Eastern Africa       0.9694434 Sub-Saharan Africa
## 49         Congo, Dem. Rep. 2010             84.8           58.40      6.25   65938712   6961485000    Africa   Middle Africa       0.2892468 Sub-Saharan Africa
## 50              Congo, Rep. 2010             42.2           60.40      5.07    4066078   5067059617    Africa   Middle Africa       3.4141881 Sub-Saharan Africa
## 51            Cote d&#39;Ivoire 2010             76.9           56.60      4.91   20131707  11603002049    Africa  Western Africa       1.5790537 Sub-Saharan Africa
## 52                    Egypt 2010             24.3           70.10      2.88   82040994 160258746162    Africa Northern Africa       5.3517764    Northern Africa
## 53        Equatorial Guinea 2010             78.9           58.60      5.14     728710   5979285835    Africa   Middle Africa      22.4802803 Sub-Saharan Africa
## 54                  Eritrea 2010             39.4           60.10      4.97    4689664    771116883    Africa  Eastern Africa       0.4504905 Sub-Saharan Africa
## 55                 Ethiopia 2010             50.8           62.10      4.90   87561814  18291486355    Africa  Eastern Africa       0.5723232 Sub-Saharan Africa
## 56                    Gabon 2010             42.8           63.00      4.21    1541936   6343809583    Africa   Middle Africa      11.2717391 Sub-Saharan Africa
## 57                   Gambia 2010             51.7           66.50      5.80    1693002   1217357172    Africa  Western Africa       1.9700066 Sub-Saharan Africa
## 58                    Ghana 2010             50.2           62.90      4.05   24317734   8779397392    Africa  Western Africa       0.9891194 Sub-Saharan Africa
## 59                   Guinea 2010             71.2           57.90      5.17   11012406   5493989673    Africa  Western Africa       1.3668245 Sub-Saharan Africa
## 60            Guinea-Bissau 2010             73.4           54.30      5.12    1634196    244395463    Africa  Western Africa       0.4097285 Sub-Saharan Africa
## 61                    Kenya 2010             42.4           62.90      4.62   40328313  18988282813    Africa  Eastern Africa       1.2899794 Sub-Saharan Africa
## 62                  Lesotho 2010             75.2           46.40      3.21    2010586   1076239050    Africa Southern Africa       1.4665377 Sub-Saharan Africa
## 63                  Liberia 2010             65.2           60.80      5.02    3957990   1040653199    Africa  Western Africa       0.7203416 Sub-Saharan Africa
## 64               Madagascar 2010             42.1           62.40      4.65   21079532   5026822443    Africa  Eastern Africa       0.6533407 Sub-Saharan Africa
## 65                   Malawi 2010             57.5           55.40      5.64   14769824   2758392725    Africa  Eastern Africa       0.5116676 Sub-Saharan Africa
## 66                     Mali 2010             82.9           59.20      6.84   15167286   4199858651    Africa  Western Africa       0.7586368 Sub-Saharan Africa
## 67               Mauritania 2010             70.1           68.60      4.84    3591400   2107593972    Africa  Western Africa       1.6077936 Sub-Saharan Africa
## 68                Mauritius 2010             13.3           73.40      1.52    1247951   6636426093    Africa  Eastern Africa      14.5694737 Sub-Saharan Africa
## 69                  Morocco 2010             28.5           73.70      2.58   32107739  59908047776    Africa Northern Africa       5.1119027    Northern Africa
## 70               Mozambique 2010             71.9           54.40      5.41   24321457   8972305823    Africa  Eastern Africa       1.0106985 Sub-Saharan Africa
## 71                  Namibia 2010             37.5           61.40      3.23    2193643   6155469329    Africa Southern Africa       7.6878050 Sub-Saharan Africa
## 72                    Niger 2010             66.1           59.20      7.58   16291990   2781188119    Africa  Western Africa       0.4676957 Sub-Saharan Africa
## 73                  Nigeria 2010             81.5           61.20      6.02  159424742  85581744176    Africa  Western Africa       1.4707286 Sub-Saharan Africa
## 74                   Rwanda 2010             43.8           65.10      4.84   10293669   3583713093    Africa  Eastern Africa       0.9538282 Sub-Saharan Africa
## 75                  Senegal 2010             46.7           64.20      5.05   12956791   6984284544    Africa  Western Africa       1.4768337 Sub-Saharan Africa
## 76               Seychelles 2010             12.2           73.10      2.26      93081    760361490    Africa  Eastern Africa      22.3803157 Sub-Saharan Africa
## 77             Sierra Leone 2010            107.0           55.00      4.94    5775902   1574302614    Africa  Western Africa       0.7467505 Sub-Saharan Africa
## 78             South Africa 2010             38.2           54.90      2.47   51621594 187639624489    Africa Southern Africa       9.9586457 Sub-Saharan Africa
## 79                    Sudan 2010             53.3           66.10      4.64   36114885  22819076998    Africa Northern Africa       1.7310873    Northern Africa
## 80                Swaziland 2010             59.1           46.40      3.56    1193148   1911603442    Africa Southern Africa       4.3894552 Sub-Saharan Africa
## 81                 Tanzania 2010             42.4           61.40      5.43   45648525  19965679449    Africa  Eastern Africa       1.1982970 Sub-Saharan Africa
## 82                     Togo 2010             59.3           58.70      4.79    6390851   1595792895    Africa  Western Africa       0.6841085 Sub-Saharan Africa
## 83                  Tunisia 2010             14.9           77.10      2.04   10639194  33161453137    Africa Northern Africa       8.5394905    Northern Africa
## 84                   Uganda 2010             49.5           57.80      6.16   33149417  12701095116    Africa  Eastern Africa       1.0497174 Sub-Saharan Africa
## 85                   Zambia 2010             52.9           53.10      5.81   13917439   5587389858    Africa  Eastern Africa       1.0999091 Sub-Saharan Africa
## 86                 Zimbabwe 2010             55.8           49.10      3.72   13973897   4032423429    Africa  Eastern Africa       0.7905980 Sub-Saharan Africa</code></pre>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="section-4-overview.html#cb301-1" aria-hidden="true"></a>daydollars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(dollars_per_day, <span class="dt">fill =</span> region)) <span class="op">+</span></span>
<span id="cb301-2"><a href="section-4-overview.html#cb301-2" aria-hidden="true"></a><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">bw =</span> <span class="fl">0.5</span>, <span class="dt">position =</span> <span class="st">&quot;stack&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(.<span class="op">~</span>year)</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-135-1.png" width="672" /></p>
<ol start="11" style="list-style-type: decimal">
<li>We are going to continue looking at patterns in the gapminder dataset by plotting infant mortality rates versus dollars per day for African countries.</li>
</ol>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="section-4-overview.html#cb302-1" aria-hidden="true"></a>gapminder_Africa_<span class="dv">2010</span> &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span></span>
<span id="cb302-2"><a href="section-4-overview.html#cb302-2" aria-hidden="true"></a><span class="kw">mutate</span>(<span class="dt">dollars_per_day =</span> gdp<span class="op">/</span>population<span class="op">/</span><span class="dv">365</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(continent <span class="op">==</span><span class="st"> &quot;Africa&quot;</span> <span class="op">&amp;</span><span class="st"> </span>year <span class="op">==</span><span class="st"> </span><span class="dv">2010</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(gdp))</span>
<span id="cb302-3"><a href="section-4-overview.html#cb302-3" aria-hidden="true"></a><span class="co"># now make the scatter plot</span></span>
<span id="cb302-4"><a href="section-4-overview.html#cb302-4" aria-hidden="true"></a>gapminder_Africa_<span class="dv">2010</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(dollars_per_day, infant_mortality, <span class="dt">color =</span> region)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-136-1.png" width="672" /></p>
<ol start="12" style="list-style-type: decimal">
<li>Now we are going to transform the x axis of the plot from the previous exercise.</li>
</ol>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="section-4-overview.html#cb303-1" aria-hidden="true"></a>gapminder_Africa_<span class="dv">2010</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(dollars_per_day, infant_mortality, <span class="dt">color =</span> region)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-137-1.png" width="672" /></p>
<ol start="13" style="list-style-type: decimal">
<li>Note that there is a large variation in infant mortality and dollars per day among African countries.</li>
</ol>
<p>As an example, one country has infant mortality rates of less than 20 per 1000 and dollars per day of 16, while another country has infant mortality rates over 10% and dollars per day of about 1.</p>
<p>In this exercise, we will remake the plot from Exercise 12 with country names instead of points so we can identify which countries are which.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="section-4-overview.html#cb304-1" aria-hidden="true"></a>gapminder_Africa_<span class="dv">2010</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(dollars_per_day, infant_mortality, <span class="dt">color =</span> region, <span class="dt">label =</span> country)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_text</span>()</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-138-1.png" width="672" /></p>
<ol start="14" style="list-style-type: decimal">
<li>Now we are going to look at changes in the infant mortality and dollars per day patterns African countries between 1970 and 2010.</li>
</ol>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="section-4-overview.html#cb305-1" aria-hidden="true"></a>gapminder_Africa_<span class="dv">1970</span>_<span class="dv">2019</span> &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">dollars_per_day =</span> gdp<span class="op">/</span>population<span class="op">/</span><span class="dv">365</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(continent <span class="op">==</span><span class="st"> &quot;Africa&quot;</span> <span class="op">&amp;</span><span class="st"> </span>year<span class="op">%in%</span><span class="kw">c</span>(<span class="dv">1970</span>,<span class="dv">2010</span>) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(gdp) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(infant_mortality))</span>
<span id="cb305-2"><a href="section-4-overview.html#cb305-2" aria-hidden="true"></a>gapminder_Africa_<span class="dv">1970</span>_<span class="dv">2019</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(dollars_per_day, infant_mortality, <span class="dt">color =</span> region, <span class="dt">label =</span> country)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_text</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(year <span class="op">~</span><span class="st"> </span>.)</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-139-1.png" width="672" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="section-3-overview.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="section-5-overview.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
