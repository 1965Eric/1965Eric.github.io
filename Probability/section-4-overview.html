<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Section 4 Overview | Data Science Probability</title>
  <meta name="description" content="5 Section 4 Overview | Data Science Probability" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Section 4 Overview | Data Science Probability" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Section 4 Overview | Data Science Probability" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="section-3-overview.html"/>

<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning Objectives</a>
<ul>
<li class="chapter" data-level="1.1" data-path="learning-objectives.html"><a href="learning-objectives.html#course-overview"><i class="fa fa-check"></i><b>1.1</b> Course Overview</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="learning-objectives.html"><a href="learning-objectives.html#section-1-discrete-probability"><i class="fa fa-check"></i><b>1.1.1</b> Section 1: Discrete Probability</a></li>
<li class="chapter" data-level="1.1.2" data-path="learning-objectives.html"><a href="learning-objectives.html#section-2-continuous-probability"><i class="fa fa-check"></i><b>1.1.2</b> Section 2: Continuous Probability</a></li>
<li class="chapter" data-level="1.1.3" data-path="learning-objectives.html"><a href="learning-objectives.html#section-3-random-variables-sampling-models-and-the-central-limit-theorem"><i class="fa fa-check"></i><b>1.1.3</b> Section 3: Random Variables, Sampling Models, and The Central Limit Theorem</a></li>
<li class="chapter" data-level="1.1.4" data-path="learning-objectives.html"><a href="learning-objectives.html#section-4-the-big-short"><i class="fa fa-check"></i><b>1.1.4</b> Section 4: The Big Short</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="section-1-overview.html"><a href="section-1-overview.html"><i class="fa fa-check"></i><b>2</b> Section 1 Overview</a>
<ul>
<li class="chapter" data-level="2.1" data-path="section-1-overview.html"><a href="section-1-overview.html#discrete-probability"><i class="fa fa-check"></i><b>2.1</b> Discrete Probability</a></li>
<li class="chapter" data-level="2.2" data-path="section-1-overview.html"><a href="section-1-overview.html#monte-carlo-simulations"><i class="fa fa-check"></i><b>2.2</b> Monte Carlo Simulations</a></li>
<li class="chapter" data-level="2.3" data-path="section-1-overview.html"><a href="section-1-overview.html#setting-the-random-seed"><i class="fa fa-check"></i><b>2.3</b> Setting the Random Seed</a></li>
<li class="chapter" data-level="2.4" data-path="section-1-overview.html"><a href="section-1-overview.html#using-the-mean-function-for-probability"><i class="fa fa-check"></i><b>2.4</b> Using the mean Function for Probability</a></li>
<li class="chapter" data-level="2.5" data-path="section-1-overview.html"><a href="section-1-overview.html#probability-distributions"><i class="fa fa-check"></i><b>2.5</b> Probability Distributions</a></li>
<li class="chapter" data-level="2.6" data-path="section-1-overview.html"><a href="section-1-overview.html#independence"><i class="fa fa-check"></i><b>2.6</b> Independence</a></li>
<li class="chapter" data-level="2.7" data-path="section-1-overview.html"><a href="section-1-overview.html#assessment---introduction-to-discrete-probability-using-r"><i class="fa fa-check"></i><b>2.7</b> Assessment - Introduction to Discrete Probability (using R)</a></li>
<li class="chapter" data-level="2.8" data-path="section-1-overview.html"><a href="section-1-overview.html#combinations-and-permutations"><i class="fa fa-check"></i><b>2.8</b> Combinations and Permutations</a></li>
<li class="chapter" data-level="2.9" data-path="section-1-overview.html"><a href="section-1-overview.html#the-birthday-problem"><i class="fa fa-check"></i><b>2.9</b> The Birthday Problem</a></li>
<li class="chapter" data-level="2.10" data-path="section-1-overview.html"><a href="section-1-overview.html#sapply"><i class="fa fa-check"></i><b>2.10</b> sapply</a></li>
<li class="chapter" data-level="2.11" data-path="section-1-overview.html"><a href="section-1-overview.html#how-many-monte-carlo-experiments-are-enough"><i class="fa fa-check"></i><b>2.11</b> How many Monte Carlo Experiments are enough?</a></li>
<li class="chapter" data-level="2.12" data-path="section-1-overview.html"><a href="section-1-overview.html#assessment---combinations-and-permutations"><i class="fa fa-check"></i><b>2.12</b> Assessment - Combinations and Permutations</a></li>
<li class="chapter" data-level="2.13" data-path="section-1-overview.html"><a href="section-1-overview.html#the-addition-rule"><i class="fa fa-check"></i><b>2.13</b> The Addition rule</a></li>
<li class="chapter" data-level="2.14" data-path="section-1-overview.html"><a href="section-1-overview.html#the-monty-hall-problem"><i class="fa fa-check"></i><b>2.14</b> The Monty Hall Problem</a></li>
<li class="chapter" data-level="2.15" data-path="section-1-overview.html"><a href="section-1-overview.html#assessment---the-addition-rule-and-monty-hall"><i class="fa fa-check"></i><b>2.15</b> Assessment - The Addition Rule and Monty Hall</a></li>
<li class="chapter" data-level="2.16" data-path="section-1-overview.html"><a href="section-1-overview.html#assessment---olympic-running"><i class="fa fa-check"></i><b>2.16</b> Assessment - Olympic Running</a></li>
<li class="chapter" data-level="2.17" data-path="section-1-overview.html"><a href="section-1-overview.html#assessment---restaurant-management"><i class="fa fa-check"></i><b>2.17</b> Assessment - Restaurant Management</a></li>
<li class="chapter" data-level="2.18" data-path="section-1-overview.html"><a href="section-1-overview.html#assessment---esophageal-cancer-and-alcoholtobacco-use"><i class="fa fa-check"></i><b>2.18</b> Assessment - Esophageal cancer and alcohol/tobacco use</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="section-2-overview.html"><a href="section-2-overview.html"><i class="fa fa-check"></i><b>3</b> Section 2 Overview</a>
<ul>
<li class="chapter" data-level="3.1" data-path="section-2-overview.html"><a href="section-2-overview.html#continuous-probability"><i class="fa fa-check"></i><b>3.1</b> Continuous Probability</a></li>
<li class="chapter" data-level="3.2" data-path="section-2-overview.html"><a href="section-2-overview.html#theoretical-distribution"><i class="fa fa-check"></i><b>3.2</b> Theoretical Distribution</a></li>
<li class="chapter" data-level="3.3" data-path="section-2-overview.html"><a href="section-2-overview.html#probability-density"><i class="fa fa-check"></i><b>3.3</b> Probability Density</a></li>
<li class="chapter" data-level="3.4" data-path="section-2-overview.html"><a href="section-2-overview.html#monte-carlo-simulations-1"><i class="fa fa-check"></i><b>3.4</b> Monte Carlo simulations</a></li>
<li class="chapter" data-level="3.5" data-path="section-2-overview.html"><a href="section-2-overview.html#other-continuous-distributions"><i class="fa fa-check"></i><b>3.5</b> Other Continuous Distributions</a></li>
<li class="chapter" data-level="3.6" data-path="section-2-overview.html"><a href="section-2-overview.html#assessment---continuous-probability"><i class="fa fa-check"></i><b>3.6</b> Assessment - Continuous Probability</a></li>
<li class="chapter" data-level="3.7" data-path="section-2-overview.html"><a href="section-2-overview.html#assessment---act-scores-part-1"><i class="fa fa-check"></i><b>3.7</b> Assessment - ACT scores, part 1</a></li>
<li class="chapter" data-level="3.8" data-path="section-2-overview.html"><a href="section-2-overview.html#assessment---act-scores-part-2"><i class="fa fa-check"></i><b>3.8</b> Assessment - ACT scores, part 2</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="section-3-overview.html"><a href="section-3-overview.html"><i class="fa fa-check"></i><b>4</b> Section 3 Overview</a>
<ul>
<li class="chapter" data-level="4.1" data-path="section-3-overview.html"><a href="section-3-overview.html#random-variables"><i class="fa fa-check"></i><b>4.1</b> Random variables</a></li>
<li class="chapter" data-level="4.2" data-path="section-3-overview.html"><a href="section-3-overview.html#sampling-models"><i class="fa fa-check"></i><b>4.2</b> Sampling Models</a></li>
<li class="chapter" data-level="4.3" data-path="section-3-overview.html"><a href="section-3-overview.html#distributions-versus-probability-distributions"><i class="fa fa-check"></i><b>4.3</b> Distributions versus Probability Distributions</a></li>
<li class="chapter" data-level="4.4" data-path="section-3-overview.html"><a href="section-3-overview.html#notation-for-random-variables"><i class="fa fa-check"></i><b>4.4</b> Notation for Random Variables</a></li>
<li class="chapter" data-level="4.5" data-path="section-3-overview.html"><a href="section-3-overview.html#central-limit-theorem-clt"><i class="fa fa-check"></i><b>4.5</b> Central Limit Theorem (CLT)</a></li>
<li class="chapter" data-level="4.6" data-path="section-3-overview.html"><a href="section-3-overview.html#assessment---random-variables-and-sampling-models"><i class="fa fa-check"></i><b>4.6</b> Assessment - Random Variables and Sampling Models</a></li>
<li class="chapter" data-level="4.7" data-path="section-3-overview.html"><a href="section-3-overview.html#averages-and-proportions"><i class="fa fa-check"></i><b>4.7</b> Averages and Proportions</a></li>
<li class="chapter" data-level="4.8" data-path="section-3-overview.html"><a href="section-3-overview.html#law-of-large-numbers"><i class="fa fa-check"></i><b>4.8</b> Law of Large Numbers</a></li>
<li class="chapter" data-level="4.9" data-path="section-3-overview.html"><a href="section-3-overview.html#how-large-is-large-in-clt"><i class="fa fa-check"></i><b>4.9</b> How Large is Large in CLT?</a></li>
<li class="chapter" data-level="4.10" data-path="section-3-overview.html"><a href="section-3-overview.html#assessment---the-central-limit-theorem"><i class="fa fa-check"></i><b>4.10</b> Assessment - The Central Limit Theorem</a></li>
<li class="chapter" data-level="4.11" data-path="section-3-overview.html"><a href="section-3-overview.html#assessment---sat-testing"><i class="fa fa-check"></i><b>4.11</b> Assessment - SAT Testing</a></li>
<li class="chapter" data-level="4.12" data-path="section-3-overview.html"><a href="section-3-overview.html#assessment---betting-on-roulette"><i class="fa fa-check"></i><b>4.12</b> Assessment - Betting on Roulette</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="section-4-overview.html"><a href="section-4-overview.html"><i class="fa fa-check"></i><b>5</b> Section 4 Overview</a>
<ul>
<li class="chapter" data-level="5.1" data-path="section-4-overview.html"><a href="section-4-overview.html#interest-rates-explained"><i class="fa fa-check"></i><b>5.1</b> Interest Rates Explained</a></li>
<li class="chapter" data-level="5.2" data-path="section-4-overview.html"><a href="section-4-overview.html#the-big-short"><i class="fa fa-check"></i><b>5.2</b> The Big Short</a></li>
<li class="chapter" data-level="5.3" data-path="section-4-overview.html"><a href="section-4-overview.html#assessment---the-big-short"><i class="fa fa-check"></i><b>5.3</b> Assessment - The Big Short</a></li>
<li class="chapter" data-level="5.4" data-path="section-4-overview.html"><a href="section-4-overview.html#assessment---the-big-short-edx"><i class="fa fa-check"></i><b>5.4</b> Assessment - The Big Short (edX)</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science Probability</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="section-4-overview" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Section 4 Overview</h1>
<p>Section 4 introduces you to the Big Short.</p>
<p>After completing Section 4, you will:</p>
<ul>
<li>understand the relationship between sampling models and interest rates as determined by banks.</li>
<li>understand how interest rates can be set to minimize the chances of the bank losing money.</li>
<li>understand how inappropriate assumptions of independence contributed to the financial meltdown of 2007.</li>
</ul>
<div id="interest-rates-explained" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Interest Rates Explained</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/random-variables.html#case-study-the-big-short">here</a></p>
<p><strong>Key points</strong></p>
<ul>
<li>Interest rates for loans are set using the probability of loan defaults to calculate a rate that minimizes the probability of losing money.</li>
<li>We can define the outcome of loans as a random variable. We can also define the sum of outcomes of many loans as a random variable.</li>
<li>The Central Limit Theorem can be applied to fit a normal distribution to the sum of profits over many loans. We can use properties of the normal distribution to calculate the interest rate needed to ensure a certain probability of losing money for a given probability of default.</li>
</ul>
<p><em>Code: Interest rate sampling model</em></p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="section-4-overview.html#cb293-1" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb293-2"><a href="section-4-overview.html#cb293-2" aria-hidden="true"></a>loss_per_foreclosure &lt;-<span class="st"> </span><span class="dv">-200000</span></span>
<span id="cb293-3"><a href="section-4-overview.html#cb293-3" aria-hidden="true"></a>p &lt;-<span class="st"> </span><span class="fl">0.02</span></span>
<span id="cb293-4"><a href="section-4-overview.html#cb293-4" aria-hidden="true"></a>defaults &lt;-<span class="st"> </span><span class="kw">sample</span>( <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), n, <span class="dt">prob=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p, p), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb293-5"><a href="section-4-overview.html#cb293-5" aria-hidden="true"></a><span class="kw">sum</span>(defaults <span class="op">*</span><span class="st"> </span>loss_per_foreclosure)</span></code></pre></div>
<pre><code>## [1] -6400000</code></pre>
<p><em>Code: Interest rate Monte Carlo simulation</em></p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="section-4-overview.html#cb295-1" aria-hidden="true"></a>B &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb295-2"><a href="section-4-overview.html#cb295-2" aria-hidden="true"></a>losses &lt;-<span class="st"> </span><span class="kw">replicate</span>(B, {</span>
<span id="cb295-3"><a href="section-4-overview.html#cb295-3" aria-hidden="true"></a>    defaults &lt;-<span class="st"> </span><span class="kw">sample</span>( <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), n, <span class="dt">prob=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p, p), <span class="dt">replace =</span> <span class="ot">TRUE</span>) </span>
<span id="cb295-4"><a href="section-4-overview.html#cb295-4" aria-hidden="true"></a>  <span class="kw">sum</span>(defaults <span class="op">*</span><span class="st"> </span>loss_per_foreclosure)</span>
<span id="cb295-5"><a href="section-4-overview.html#cb295-5" aria-hidden="true"></a>})</span></code></pre></div>
<p><em>Code: Plotting expected losses</em></p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="section-4-overview.html#cb296-1" aria-hidden="true"></a><span class="kw">data.frame</span>(<span class="dt">losses_in_millions =</span> losses<span class="op">/</span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span>) <span class="op">%&gt;%</span></span>
<span id="cb296-2"><a href="section-4-overview.html#cb296-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(losses_in_millions)) <span class="op">+</span></span>
<span id="cb296-3"><a href="section-4-overview.html#cb296-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.6</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-139-1.png" width="672" /></p>
<p><em>Code: Expected value and standard error of the sum of 1,000 loans</em></p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="section-4-overview.html#cb297-1" aria-hidden="true"></a>n<span class="op">*</span>(p<span class="op">*</span>loss_per_foreclosure <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">*</span><span class="dv">0</span>)    <span class="co"># expected value </span></span></code></pre></div>
<pre><code>## [1] -4e+06</code></pre>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="section-4-overview.html#cb299-1" aria-hidden="true"></a><span class="kw">sqrt</span>(n)<span class="op">*</span><span class="kw">abs</span>(loss_per_foreclosure)<span class="op">*</span><span class="kw">sqrt</span>(p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p))    <span class="co"># standard error</span></span></code></pre></div>
<pre><code>## [1] 885438</code></pre>
<p><em>Code: Calculating interest rates for expected value of 0</em></p>
<p>We can calculate the amount <span class="math inline">\(x\)</span> to add to each loan so that the expected value is 0 using the equation <span class="math inline">\(lp + x(1-p) = 0\)</span>. Note that this equation is the definition of expected value given a loss per foreclosure <span class="math inline">\(l\)</span> with foreclosure probability <span class="math inline">\(p\)</span> and profit <span class="math inline">\(x\)</span> if there is no foreclosure (probability <span class="math inline">\(1-p\)</span>).</p>
<p>We solve for <span class="math inline">\(x = - \frac {lp}{1-p}\)</span> and calculate <span class="math inline">\(x\)</span>:</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="section-4-overview.html#cb301-1" aria-hidden="true"></a>x =<span class="st"> </span><span class="op">-</span><span class="st"> </span>loss_per_foreclosure<span class="op">*</span>p<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>p)</span>
<span id="cb301-2"><a href="section-4-overview.html#cb301-2" aria-hidden="true"></a>x</span></code></pre></div>
<pre><code>## [1] 4082</code></pre>
<p>On a $180,000 loan, this equals an interest rate of:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="section-4-overview.html#cb303-1" aria-hidden="true"></a>x<span class="op">/</span><span class="dv">180000</span></span></code></pre></div>
<pre><code>## [1] 0.0227</code></pre>
<p><em>Equations: Calculating interest rate for 1% probability of losing money</em></p>
<p>We want to calculate the value of <span class="math inline">\(x\)</span> for which <span class="math inline">\(\mbox{Pr}(S &lt; 0) = 0.01\)</span>. The expected value <span class="math inline">\(E \left[ S \right]\)</span> of the sum of <span class="math inline">\(n = 1000\)</span> loans given our definitions of <span class="math inline">\(x\)</span>, <span class="math inline">\(l\)</span> and <span class="math inline">\(p\)</span> is:</p>
<p><span class="math inline">\(\mu_S = (lp + x(1-p))*n\)</span></p>
<p>And the standard error of the sum of <span class="math inline">\(n\)</span> loans, <span class="math inline">\(SE \left [ S \right]\)</span>, is:</p>
<p><span class="math inline">\(\sigma_S = |x-l|\sqrt{np(1-p)}\)</span></p>
<p>Because we know the definition of a Z-score is <span class="math inline">\(Z = \frac{x-\mu}{\sigma}\)</span>, we know that <span class="math inline">\(\mbox{Pr}(S &lt; 0) = \mbox{Pr}(Z &lt; - \frac{\mu}{\sigma})\)</span>. Thus, <span class="math inline">\(\mbox{Pr}(S &lt; 0) = 0.01\)</span> equals:</p>
<p><span class="math inline">\(\mbox{Pr}(Z &lt; \frac{-[lp + x(1-p)]n}{(x-l)\sqrt{np(1-p)}}) = 0.01\)</span></p>
<p>We know that <code>z&lt;-qnorm(0.01)</code> gives us the value of <span class="math inline">\(z\)</span> for which <span class="math inline">\(\mbox{Pr}(Z \le z) = 0.01\)</span>, meaning:</p>
<p><span class="math inline">\(z = \frac{-[lp + x(1-p)]n}{(x-l)\sqrt{np(1-p)}}\)</span></p>
<p>Solving for <span class="math inline">\(x\)</span> gives:</p>
<p><span class="math inline">\(x = -l \frac {np - z \sqrt{np(1-p)}}{n(1-p) + z \sqrt{np(1-p)}}\)</span></p>
<p><em>Code: Calculating interest rate for 1% probability of losing money</em></p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="section-4-overview.html#cb305-1" aria-hidden="true"></a>l &lt;-<span class="st"> </span>loss_per_foreclosure</span>
<span id="cb305-2"><a href="section-4-overview.html#cb305-2" aria-hidden="true"></a>z &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.01</span>)</span>
<span id="cb305-3"><a href="section-4-overview.html#cb305-3" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="op">-</span>l<span class="op">*</span>( n<span class="op">*</span>p <span class="op">-</span><span class="st"> </span>z<span class="op">*</span><span class="kw">sqrt</span>(n<span class="op">*</span>p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)))<span class="op">/</span><span class="st"> </span>( n<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p) <span class="op">+</span><span class="st"> </span>z<span class="op">*</span><span class="kw">sqrt</span>(n<span class="op">*</span>p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)))</span>
<span id="cb305-4"><a href="section-4-overview.html#cb305-4" aria-hidden="true"></a>x    <span class="co"># required profit when loan is not a foreclosure</span></span></code></pre></div>
<pre><code>## [1] 6249</code></pre>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="section-4-overview.html#cb307-1" aria-hidden="true"></a>x<span class="op">/</span><span class="dv">180000</span>    <span class="co"># interest rate</span></span></code></pre></div>
<pre><code>## [1] 0.0347</code></pre>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="section-4-overview.html#cb309-1" aria-hidden="true"></a>loss_per_foreclosure<span class="op">*</span>p <span class="op">+</span><span class="st"> </span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)    <span class="co"># expected value of the profit per loan</span></span></code></pre></div>
<pre><code>## [1] 2124</code></pre>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="section-4-overview.html#cb311-1" aria-hidden="true"></a>n<span class="op">*</span>(loss_per_foreclosure<span class="op">*</span>p <span class="op">+</span><span class="st"> </span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)) <span class="co"># expected value of the profit over n loans</span></span></code></pre></div>
<pre><code>## [1] 2124198</code></pre>
<p><em>Code: Monte Carlo simulation for 1% probability of losing money</em></p>
<p>Note that your results will vary from the video because the seed is not set.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="section-4-overview.html#cb313-1" aria-hidden="true"></a>B &lt;-<span class="st"> </span><span class="dv">100000</span></span>
<span id="cb313-2"><a href="section-4-overview.html#cb313-2" aria-hidden="true"></a>profit &lt;-<span class="st"> </span><span class="kw">replicate</span>(B, {</span>
<span id="cb313-3"><a href="section-4-overview.html#cb313-3" aria-hidden="true"></a>    draws &lt;-<span class="st"> </span><span class="kw">sample</span>( <span class="kw">c</span>(x, loss_per_foreclosure), n, </span>
<span id="cb313-4"><a href="section-4-overview.html#cb313-4" aria-hidden="true"></a>                        <span class="dt">prob=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p, p), <span class="dt">replace =</span> <span class="ot">TRUE</span>) </span>
<span id="cb313-5"><a href="section-4-overview.html#cb313-5" aria-hidden="true"></a>    <span class="kw">sum</span>(draws)</span>
<span id="cb313-6"><a href="section-4-overview.html#cb313-6" aria-hidden="true"></a>})</span>
<span id="cb313-7"><a href="section-4-overview.html#cb313-7" aria-hidden="true"></a><span class="kw">mean</span>(profit)    <span class="co"># expected value of the profit over n loans</span></span></code></pre></div>
<pre><code>## [1] 2126219</code></pre>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="section-4-overview.html#cb315-1" aria-hidden="true"></a><span class="kw">mean</span>(profit<span class="op">&lt;</span><span class="dv">0</span>)    <span class="co"># probability of losing money</span></span></code></pre></div>
<pre><code>## [1] 0.0125</code></pre>
</div>
<div id="the-big-short" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> The Big Short</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/random-variables.html#the-big-short">here</a></p>
<p><strong>Key points</strong></p>
<ul>
<li>The Central Limit Theorem states that the sum of independent draws of a random variable follows a normal distribution. However, when the draws are not independent, this assumption does not hold.</li>
<li>If an event changes the probability of default for all borrowers, then the probability of the bank losing money changes.</li>
<li>Monte Carlo simulations can be used to model the effects of unknown changes in the probability of default.</li>
</ul>
<p><em>Code: Expected value with higher default rate and interest rate</em></p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="section-4-overview.html#cb317-1" aria-hidden="true"></a>p &lt;-<span class="st"> </span><span class="fl">.04</span></span>
<span id="cb317-2"><a href="section-4-overview.html#cb317-2" aria-hidden="true"></a>loss_per_foreclosure &lt;-<span class="st"> </span><span class="dv">-200000</span></span>
<span id="cb317-3"><a href="section-4-overview.html#cb317-3" aria-hidden="true"></a>r &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb317-4"><a href="section-4-overview.html#cb317-4" aria-hidden="true"></a>x &lt;-<span class="st"> </span>r<span class="op">*</span><span class="dv">180000</span></span>
<span id="cb317-5"><a href="section-4-overview.html#cb317-5" aria-hidden="true"></a>loss_per_foreclosure<span class="op">*</span>p <span class="op">+</span><span class="st"> </span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)</span></code></pre></div>
<pre><code>## [1] 640</code></pre>
<p><em>Equations: Probability of losing money</em></p>
<p>We can define our desired probability of losing money, <span class="math inline">\(z\)</span>, as:</p>
<p><span class="math inline">\(\mbox{Pr}(S &lt; 0) = \mbox{Pr}(Z &lt; - \frac{E \left [S \right]}{SE \left [S \right]}) = \mbox{Pr}(Z &lt; z)\)</span></p>
<p>If <span class="math inline">\(\mu\)</span> is the expected value of the urn (one loan) and <span class="math inline">\(\sigma\)</span> is the standard deviation of the urn (one loan), then <span class="math inline">\(E \left [S \right] = n \mu\)</span> and <span class="math inline">\(SE \left [S \right] = \sqrt{n \sigma}\)</span>.</p>
<p>We define the probability of losing money <span class="math inline">\(z = 0.01\)</span>. In the first equation, we can see that:</p>
<p><span class="math inline">\(z = - \frac{E \left [S \right]}{SE \left [S \right]}\)</span></p>
<p>It follows that:</p>
<p><span class="math inline">\(z = - \frac {n \mu}{\sqrt{n \sigma}} = - \frac {\sqrt{n \mu}}{\sigma}\)</span></p>
<p>To find the value of <span class="math inline">\(n\)</span> for which <span class="math inline">\(z\)</span> is less than or equal to our desired value, we take <span class="math inline">\(z \le - \frac {\sqrt{n \mu}}{\sigma}\)</span> and solve for <span class="math inline">\(n\)</span>:</p>
<p><span class="math inline">\(n \ge \frac {z^2 \sigma^2}{\mu^2}\)</span></p>
<p><em>Code: Calculating number of loans for desired probability of losing money</em></p>
<p>The number of loans required is:</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="section-4-overview.html#cb319-1" aria-hidden="true"></a>z &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.01</span>)</span>
<span id="cb319-2"><a href="section-4-overview.html#cb319-2" aria-hidden="true"></a>l &lt;-<span class="st"> </span>loss_per_foreclosure</span>
<span id="cb319-3"><a href="section-4-overview.html#cb319-3" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="kw">ceiling</span>((z<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(x<span class="op">-</span>l)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p))<span class="op">/</span>(l<span class="op">*</span>p <span class="op">+</span><span class="st"> </span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p))<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb319-4"><a href="section-4-overview.html#cb319-4" aria-hidden="true"></a>n    <span class="co"># number of loans required</span></span></code></pre></div>
<pre><code>## [1] 22163</code></pre>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="section-4-overview.html#cb321-1" aria-hidden="true"></a>n<span class="op">*</span>(loss_per_foreclosure<span class="op">*</span>p <span class="op">+</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>p))    <span class="co"># expected profit over n loans</span></span></code></pre></div>
<pre><code>## [1] 14184320</code></pre>
<p>Code: Monte Carlo simulation with known default probability</p>
<p>This Monte Carlo simulation estimates the expected profit given a known probability of default <span class="math inline">\(p = 0.04\)</span>. Note that your results will differ from the video because the seed is not set.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="section-4-overview.html#cb323-1" aria-hidden="true"></a>B &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb323-2"><a href="section-4-overview.html#cb323-2" aria-hidden="true"></a>p &lt;-<span class="st"> </span><span class="fl">0.04</span></span>
<span id="cb323-3"><a href="section-4-overview.html#cb323-3" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="fl">0.05</span> <span class="op">*</span><span class="st"> </span><span class="dv">180000</span></span>
<span id="cb323-4"><a href="section-4-overview.html#cb323-4" aria-hidden="true"></a>profit &lt;-<span class="st"> </span><span class="kw">replicate</span>(B, {</span>
<span id="cb323-5"><a href="section-4-overview.html#cb323-5" aria-hidden="true"></a>    draws &lt;-<span class="st"> </span><span class="kw">sample</span>( <span class="kw">c</span>(x, loss_per_foreclosure), n, </span>
<span id="cb323-6"><a href="section-4-overview.html#cb323-6" aria-hidden="true"></a>                        <span class="dt">prob=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p, p), <span class="dt">replace =</span> <span class="ot">TRUE</span>) </span>
<span id="cb323-7"><a href="section-4-overview.html#cb323-7" aria-hidden="true"></a>    <span class="kw">sum</span>(draws)</span>
<span id="cb323-8"><a href="section-4-overview.html#cb323-8" aria-hidden="true"></a>})</span>
<span id="cb323-9"><a href="section-4-overview.html#cb323-9" aria-hidden="true"></a><span class="kw">mean</span>(profit)</span></code></pre></div>
<pre><code>## [1] 14182962</code></pre>
<p><em>Code: Monte Carlo simulation with unknown default probability</em></p>
<p>This Monte Carlo simulation estimates the expected profit given an unknown probability of default <span class="math inline">\(0.03 \le p \le 0.05\)</span>, modeling the situation where an event changes the probability of default for all borrowers simultaneously. Note that your results will differ from the video because the seed is not set.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="section-4-overview.html#cb325-1" aria-hidden="true"></a>p &lt;-<span class="st"> </span><span class="fl">0.04</span></span>
<span id="cb325-2"><a href="section-4-overview.html#cb325-2" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="fl">0.05</span><span class="op">*</span><span class="dv">180000</span></span>
<span id="cb325-3"><a href="section-4-overview.html#cb325-3" aria-hidden="true"></a>profit &lt;-<span class="st"> </span><span class="kw">replicate</span>(B, {</span>
<span id="cb325-4"><a href="section-4-overview.html#cb325-4" aria-hidden="true"></a>    new_p &lt;-<span class="st"> </span><span class="fl">0.04</span> <span class="op">+</span><span class="st"> </span><span class="kw">sample</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="dt">length =</span> <span class="dv">100</span>), <span class="dv">1</span>)</span>
<span id="cb325-5"><a href="section-4-overview.html#cb325-5" aria-hidden="true"></a>    draws &lt;-<span class="st"> </span><span class="kw">sample</span>( <span class="kw">c</span>(x, loss_per_foreclosure), n, </span>
<span id="cb325-6"><a href="section-4-overview.html#cb325-6" aria-hidden="true"></a>                        <span class="dt">prob=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>new_p, new_p), <span class="dt">replace =</span> <span class="ot">TRUE</span>) </span>
<span id="cb325-7"><a href="section-4-overview.html#cb325-7" aria-hidden="true"></a>    <span class="kw">sum</span>(draws)</span>
<span id="cb325-8"><a href="section-4-overview.html#cb325-8" aria-hidden="true"></a>})</span>
<span id="cb325-9"><a href="section-4-overview.html#cb325-9" aria-hidden="true"></a><span class="kw">mean</span>(profit)    <span class="co"># expected profit</span></span></code></pre></div>
<pre><code>## [1] 14074302</code></pre>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="section-4-overview.html#cb327-1" aria-hidden="true"></a><span class="kw">mean</span>(profit <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)    <span class="co"># probability of losing money</span></span></code></pre></div>
<pre><code>## [1] 0.348</code></pre>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="section-4-overview.html#cb329-1" aria-hidden="true"></a><span class="kw">mean</span>(profit <span class="op">&lt;</span><span class="st"> </span><span class="dv">-10000000</span>)    <span class="co"># probability of losing over $10 million</span></span></code></pre></div>
<pre><code>## [1] 0.241</code></pre>
</div>
<div id="assessment---the-big-short" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Assessment - The Big Short</h2>
<ol style="list-style-type: decimal">
<li>Say you manage a bank that gives out 10,000 loans.</li>
</ol>
<p>The default rate is 0.03 and you lose $200,000 in each foreclosure.</p>
<p>Create a random variable <span class="math inline">\(S\)</span> that contains the earnings of your bank. Calculate the total amount of money lost in this scenario.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="section-4-overview.html#cb331-1" aria-hidden="true"></a><span class="co"># Assign the number of loans to the variable `n`</span></span>
<span id="cb331-2"><a href="section-4-overview.html#cb331-2" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb331-3"><a href="section-4-overview.html#cb331-3" aria-hidden="true"></a></span>
<span id="cb331-4"><a href="section-4-overview.html#cb331-4" aria-hidden="true"></a><span class="co"># Assign the loss per foreclosure to the variable `loss_per_foreclosure`</span></span>
<span id="cb331-5"><a href="section-4-overview.html#cb331-5" aria-hidden="true"></a>loss_per_foreclosure &lt;-<span class="st"> </span><span class="dv">-200000</span></span>
<span id="cb331-6"><a href="section-4-overview.html#cb331-6" aria-hidden="true"></a></span>
<span id="cb331-7"><a href="section-4-overview.html#cb331-7" aria-hidden="true"></a><span class="co"># Assign the probability of default to the variable `p_default`</span></span>
<span id="cb331-8"><a href="section-4-overview.html#cb331-8" aria-hidden="true"></a>p_default &lt;-<span class="st"> </span><span class="fl">0.03</span></span>
<span id="cb331-9"><a href="section-4-overview.html#cb331-9" aria-hidden="true"></a></span>
<span id="cb331-10"><a href="section-4-overview.html#cb331-10" aria-hidden="true"></a><span class="co"># Use the `set.seed` function to make sure your answer matches the expected result after random sampling</span></span>
<span id="cb331-11"><a href="section-4-overview.html#cb331-11" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb331-12"><a href="section-4-overview.html#cb331-12" aria-hidden="true"></a></span>
<span id="cb331-13"><a href="section-4-overview.html#cb331-13" aria-hidden="true"></a><span class="co"># Generate a vector called `defaults` that contains the default outcomes of `n` loans</span></span>
<span id="cb331-14"><a href="section-4-overview.html#cb331-14" aria-hidden="true"></a>defaults &lt;-<span class="st"> </span><span class="kw">sample</span>( <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), n, <span class="dt">prob=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p_default, p_default), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb331-15"><a href="section-4-overview.html#cb331-15" aria-hidden="true"></a></span>
<span id="cb331-16"><a href="section-4-overview.html#cb331-16" aria-hidden="true"></a><span class="co"># Generate `S`, the total amount of money lost across all foreclosures. Print the value to the console.</span></span>
<span id="cb331-17"><a href="section-4-overview.html#cb331-17" aria-hidden="true"></a>S &lt;-<span class="st"> </span><span class="kw">sum</span>(defaults <span class="op">*</span><span class="st"> </span>loss_per_foreclosure)</span>
<span id="cb331-18"><a href="section-4-overview.html#cb331-18" aria-hidden="true"></a>S</span></code></pre></div>
<pre><code>## [1] -6.3e+07</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Run a Monte Carlo simulation with 10,000 outcomes for <span class="math inline">\(S\)</span>, the sum of losses over 10,000 loans. Make a histogram of the results.</li>
</ol>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="section-4-overview.html#cb333-1" aria-hidden="true"></a><span class="co"># Assign the number of loans to the variable `n`</span></span>
<span id="cb333-2"><a href="section-4-overview.html#cb333-2" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb333-3"><a href="section-4-overview.html#cb333-3" aria-hidden="true"></a></span>
<span id="cb333-4"><a href="section-4-overview.html#cb333-4" aria-hidden="true"></a><span class="co"># Assign the loss per foreclosure to the variable `loss_per_foreclosure`</span></span>
<span id="cb333-5"><a href="section-4-overview.html#cb333-5" aria-hidden="true"></a>loss_per_foreclosure &lt;-<span class="st"> </span><span class="dv">-200000</span></span>
<span id="cb333-6"><a href="section-4-overview.html#cb333-6" aria-hidden="true"></a></span>
<span id="cb333-7"><a href="section-4-overview.html#cb333-7" aria-hidden="true"></a><span class="co"># Assign the probability of default to the variable `p_default`</span></span>
<span id="cb333-8"><a href="section-4-overview.html#cb333-8" aria-hidden="true"></a>p_default &lt;-<span class="st"> </span><span class="fl">0.03</span></span>
<span id="cb333-9"><a href="section-4-overview.html#cb333-9" aria-hidden="true"></a></span>
<span id="cb333-10"><a href="section-4-overview.html#cb333-10" aria-hidden="true"></a><span class="co"># Use the `set.seed` function to make sure your answer matches the expected result after random sampling</span></span>
<span id="cb333-11"><a href="section-4-overview.html#cb333-11" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb333-12"><a href="section-4-overview.html#cb333-12" aria-hidden="true"></a></span>
<span id="cb333-13"><a href="section-4-overview.html#cb333-13" aria-hidden="true"></a><span class="co"># The variable `B` specifies the number of times we want the simulation to run</span></span>
<span id="cb333-14"><a href="section-4-overview.html#cb333-14" aria-hidden="true"></a>B &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb333-15"><a href="section-4-overview.html#cb333-15" aria-hidden="true"></a></span>
<span id="cb333-16"><a href="section-4-overview.html#cb333-16" aria-hidden="true"></a><span class="co"># Generate a list of summed losses &#39;S&#39;. Replicate the code from the previous exercise over &#39;B&#39; iterations to generate a list of summed losses for &#39;n&#39; loans.  Ignore any warnings for now.</span></span>
<span id="cb333-17"><a href="section-4-overview.html#cb333-17" aria-hidden="true"></a>S &lt;-<span class="st"> </span><span class="kw">replicate</span>(B, {</span>
<span id="cb333-18"><a href="section-4-overview.html#cb333-18" aria-hidden="true"></a>    defaults &lt;-<span class="st"> </span><span class="kw">sample</span>( <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), n, <span class="dt">prob=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p_default, p_default), <span class="dt">replace =</span> <span class="ot">TRUE</span>) </span>
<span id="cb333-19"><a href="section-4-overview.html#cb333-19" aria-hidden="true"></a>  <span class="kw">sum</span>(defaults <span class="op">*</span><span class="st"> </span>loss_per_foreclosure)</span>
<span id="cb333-20"><a href="section-4-overview.html#cb333-20" aria-hidden="true"></a>})</span>
<span id="cb333-21"><a href="section-4-overview.html#cb333-21" aria-hidden="true"></a></span>
<span id="cb333-22"><a href="section-4-overview.html#cb333-22" aria-hidden="true"></a><span class="co"># Plot a histogram of &#39;S&#39;.  Ignore any warnings for now.</span></span>
<span id="cb333-23"><a href="section-4-overview.html#cb333-23" aria-hidden="true"></a><span class="kw">hist</span>(S)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-150-1.png" width="672" /></p>
<ol start="3" style="list-style-type: decimal">
<li>What is the expected value of <span class="math inline">\(S\)</span>, the sum of losses over 10,000 loans? For now, assume a bank makes no money if the loan is paid.</li>
</ol>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="section-4-overview.html#cb334-1" aria-hidden="true"></a><span class="co"># Assign the number of loans to the variable `n`</span></span>
<span id="cb334-2"><a href="section-4-overview.html#cb334-2" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb334-3"><a href="section-4-overview.html#cb334-3" aria-hidden="true"></a></span>
<span id="cb334-4"><a href="section-4-overview.html#cb334-4" aria-hidden="true"></a><span class="co"># Assign the loss per foreclosure to the variable `loss_per_foreclosure`</span></span>
<span id="cb334-5"><a href="section-4-overview.html#cb334-5" aria-hidden="true"></a>loss_per_foreclosure &lt;-<span class="st"> </span><span class="dv">-200000</span></span>
<span id="cb334-6"><a href="section-4-overview.html#cb334-6" aria-hidden="true"></a></span>
<span id="cb334-7"><a href="section-4-overview.html#cb334-7" aria-hidden="true"></a><span class="co"># Assign the probability of default to the variable `p_default`</span></span>
<span id="cb334-8"><a href="section-4-overview.html#cb334-8" aria-hidden="true"></a>p_default &lt;-<span class="st"> </span><span class="fl">0.03</span></span>
<span id="cb334-9"><a href="section-4-overview.html#cb334-9" aria-hidden="true"></a></span>
<span id="cb334-10"><a href="section-4-overview.html#cb334-10" aria-hidden="true"></a><span class="co"># Calculate the expected loss due to default out of 10,000 loans</span></span>
<span id="cb334-11"><a href="section-4-overview.html#cb334-11" aria-hidden="true"></a>n<span class="op">*</span>(p_default<span class="op">*</span>loss_per_foreclosure <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>p_default)<span class="op">*</span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] -6e+07</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>What is the standard error of <span class="math inline">\(S\)</span>?</li>
</ol>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="section-4-overview.html#cb336-1" aria-hidden="true"></a><span class="co"># Assign the number of loans to the variable `n`</span></span>
<span id="cb336-2"><a href="section-4-overview.html#cb336-2" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb336-3"><a href="section-4-overview.html#cb336-3" aria-hidden="true"></a></span>
<span id="cb336-4"><a href="section-4-overview.html#cb336-4" aria-hidden="true"></a><span class="co"># Assign the loss per foreclosure to the variable `loss_per_foreclosure`</span></span>
<span id="cb336-5"><a href="section-4-overview.html#cb336-5" aria-hidden="true"></a>loss_per_foreclosure &lt;-<span class="st"> </span><span class="dv">-200000</span></span>
<span id="cb336-6"><a href="section-4-overview.html#cb336-6" aria-hidden="true"></a></span>
<span id="cb336-7"><a href="section-4-overview.html#cb336-7" aria-hidden="true"></a><span class="co"># Assign the probability of default to the variable `p_default`</span></span>
<span id="cb336-8"><a href="section-4-overview.html#cb336-8" aria-hidden="true"></a>p_default &lt;-<span class="st"> </span><span class="fl">0.03</span></span>
<span id="cb336-9"><a href="section-4-overview.html#cb336-9" aria-hidden="true"></a></span>
<span id="cb336-10"><a href="section-4-overview.html#cb336-10" aria-hidden="true"></a><span class="co"># Compute the standard error of the sum of 10,000 loans</span></span>
<span id="cb336-11"><a href="section-4-overview.html#cb336-11" aria-hidden="true"></a><span class="kw">sqrt</span>(n)<span class="op">*</span><span class="kw">abs</span>(loss_per_foreclosure)<span class="op">*</span><span class="kw">sqrt</span>(p_default<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p_default))</span></code></pre></div>
<pre><code>## [1] 3411744</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>So far, weve been assuming that we make no money when people pay their loans and we lose a lot of money when people default on their loans.</li>
</ol>
<p>Assume we give out loans for $180,000. How much money do we need to make when people pay their loans so that our net loss is $0?</p>
<p>In other words, what interest rate do we need to charge in order to not lose money?</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="section-4-overview.html#cb338-1" aria-hidden="true"></a><span class="co"># Assign the loss per foreclosure to the variable `loss_per_foreclosure`</span></span>
<span id="cb338-2"><a href="section-4-overview.html#cb338-2" aria-hidden="true"></a>loss_per_foreclosure &lt;-<span class="st"> </span><span class="dv">-200000</span></span>
<span id="cb338-3"><a href="section-4-overview.html#cb338-3" aria-hidden="true"></a></span>
<span id="cb338-4"><a href="section-4-overview.html#cb338-4" aria-hidden="true"></a><span class="co"># Assign the probability of default to the variable `p_default`</span></span>
<span id="cb338-5"><a href="section-4-overview.html#cb338-5" aria-hidden="true"></a>p_default &lt;-<span class="st"> </span><span class="fl">0.03</span></span>
<span id="cb338-6"><a href="section-4-overview.html#cb338-6" aria-hidden="true"></a></span>
<span id="cb338-7"><a href="section-4-overview.html#cb338-7" aria-hidden="true"></a><span class="co"># Assign a variable `x` as the total amount necessary to have an expected outcome of $0</span></span>
<span id="cb338-8"><a href="section-4-overview.html#cb338-8" aria-hidden="true"></a>x =<span class="st"> </span><span class="op">-</span><span class="st"> </span>loss_per_foreclosure<span class="op">*</span>p_default<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>p_default)</span>
<span id="cb338-9"><a href="section-4-overview.html#cb338-9" aria-hidden="true"></a></span>
<span id="cb338-10"><a href="section-4-overview.html#cb338-10" aria-hidden="true"></a><span class="co"># Convert `x` to a rate, given that the loan amount is $180,000. Print this value to the console.</span></span>
<span id="cb338-11"><a href="section-4-overview.html#cb338-11" aria-hidden="true"></a>x &lt;-<span class="st"> </span>x<span class="op">/</span><span class="dv">180000</span></span>
<span id="cb338-12"><a href="section-4-overview.html#cb338-12" aria-hidden="true"></a>x</span></code></pre></div>
<pre><code>## [1] 0.0344</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>With the interest rate calculated in the last example, we still lose money 50% of the time.</li>
</ol>
<p>What should the interest rate be so that the chance of losing money is 1 in 20?</p>
<p>In math notation, what should the interest rate be so that <span class="math inline">\(\mbox{Pr}(S &lt; 0) = 0.05\)</span>?</p>
<p>Remember that we can add a constant to both sides of the equation to get:</p>
<p><span class="math inline">\(\mbox{Pr}(\frac{SE \left [S \right ]}{SE \left [S \right ]} &lt; \frac{E \left [S \right ]}{SE \left [S \right ]})\)</span></p>
<p>which is</p>
<p><span class="math inline">\(\mbox{Pr}(Z &lt; \frac{-[lp + x(1-p)]n}{(x-l)\sqrt{np(1-p)}}) = 0.05\)</span></p>
<p>Let <code>z = qnorm(0.05)</code> give us the value of <code>z</code> for which:</p>
<p><span class="math inline">\(\mbox{Pr}(Z \le z) = 0.05\)</span></p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="section-4-overview.html#cb340-1" aria-hidden="true"></a><span class="co"># Assign the number of loans to the variable `n`</span></span>
<span id="cb340-2"><a href="section-4-overview.html#cb340-2" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb340-3"><a href="section-4-overview.html#cb340-3" aria-hidden="true"></a></span>
<span id="cb340-4"><a href="section-4-overview.html#cb340-4" aria-hidden="true"></a><span class="co"># Assign the loss per foreclosure to the variable `loss_per_foreclosure`</span></span>
<span id="cb340-5"><a href="section-4-overview.html#cb340-5" aria-hidden="true"></a>loss_per_foreclosure &lt;-<span class="st"> </span><span class="dv">-200000</span></span>
<span id="cb340-6"><a href="section-4-overview.html#cb340-6" aria-hidden="true"></a></span>
<span id="cb340-7"><a href="section-4-overview.html#cb340-7" aria-hidden="true"></a><span class="co"># Assign the probability of default to the variable `p_default`</span></span>
<span id="cb340-8"><a href="section-4-overview.html#cb340-8" aria-hidden="true"></a>p_default &lt;-<span class="st"> </span><span class="fl">0.03</span></span>
<span id="cb340-9"><a href="section-4-overview.html#cb340-9" aria-hidden="true"></a></span>
<span id="cb340-10"><a href="section-4-overview.html#cb340-10" aria-hidden="true"></a><span class="co"># Generate a variable `z` using the `qnorm` function</span></span>
<span id="cb340-11"><a href="section-4-overview.html#cb340-11" aria-hidden="true"></a>z &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.05</span>)</span>
<span id="cb340-12"><a href="section-4-overview.html#cb340-12" aria-hidden="true"></a></span>
<span id="cb340-13"><a href="section-4-overview.html#cb340-13" aria-hidden="true"></a><span class="co"># Generate a variable `x` using `z`, `p_default`, `loss_per_foreclosure`, and `n`</span></span>
<span id="cb340-14"><a href="section-4-overview.html#cb340-14" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="op">-</span>loss_per_foreclosure<span class="op">*</span>( n<span class="op">*</span>p_default <span class="op">-</span><span class="st"> </span>z<span class="op">*</span><span class="kw">sqrt</span>(n<span class="op">*</span>p_default<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p_default)))<span class="op">/</span><span class="st"> </span>( n<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p_default) <span class="op">+</span><span class="st"> </span>z<span class="op">*</span><span class="kw">sqrt</span>(n<span class="op">*</span>p_default<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p_default)))</span>
<span id="cb340-15"><a href="section-4-overview.html#cb340-15" aria-hidden="true"></a></span>
<span id="cb340-16"><a href="section-4-overview.html#cb340-16" aria-hidden="true"></a><span class="co"># Convert `x` to an interest rate, given that the loan amount is $180,000. Print this value to the console.</span></span>
<span id="cb340-17"><a href="section-4-overview.html#cb340-17" aria-hidden="true"></a>x &lt;-<span class="st"> </span>x<span class="op">/</span><span class="dv">180000</span></span>
<span id="cb340-18"><a href="section-4-overview.html#cb340-18" aria-hidden="true"></a>x</span></code></pre></div>
<pre><code>## [1] 0.0377</code></pre>
<ol start="7" style="list-style-type: decimal">
<li>The bank wants to minimize the probability of losing money.</li>
</ol>
<p>Which of the following achieves their goal without making interest rates go up?</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A. A smaller pool of loans</li>
<li><input type="checkbox" disabled="" />
B. A larger probability of default</li>
<li><input type="checkbox" disabled="" checked="" />
C. A reduced default rate</li>
<li><input type="checkbox" disabled="" />
D. A larger cost per loan default</li>
</ul>
</div>
<div id="assessment---the-big-short-edx" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Assessment - The Big Short (edX)</h2>
<p>These exercises review and assess the following concepts:</p>
<ul>
<li>Expected value and standard error of a single draw of a random variable</li>
<li>Expected value and standard error of the sum of draws of a random variable</li>
<li>Monte Carlo simulation of the sum of draws of a random variable</li>
<li>The Central Limit Theorem approximation of the sum of draws of a random variable</li>
<li>Using z-scores to calculate values related to the normal distribution and normal random variables</li>
<li>Calculating interest/premium rates to minimize chance of losing money</li>
<li>Determining a number of loans/policies required to profit</li>
<li>Simulating the effects of a change in event probability</li>
</ul>
<p><strong>Setup and libraries</strong></p>
<p>Run the code below to set up your environment and load the libraries you will need for the following exercises:</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="section-4-overview.html#cb342-1" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb342-2"><a href="section-4-overview.html#cb342-2" aria-hidden="true"></a><span class="kw">library</span>(dslabs)</span></code></pre></div>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="section-4-overview.html#cb343-1" aria-hidden="true"></a><span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><em>IMPORTANT</em>: Some of these exercises use <strong>dslabs</strong> datasets that were added in a July 2019 update. Make sure your package is up to date with the command <code>update.packages("dslabs")</code>. You can also update all packages on your system by running <code>update.packages()</code> with no arguments, and you should consider doing this routinely.</p>
<p><strong>Background</strong></p>
<p>In the motivating example <strong>The Big Short</strong>, we discussed how discrete and continuous probability concepts relate to bank loans and interest rates. Similar business problems are faced by the insurance industry.</p>
<p>Just as banks must decide how much to charge as interest on loans based on estimates of loan defaults, insurance companies must decide how much to charge as premiums for policies given estimates of the probability that an individual will collect on that policy.</p>
<p>We will use data from 2015 <a href="https://www.ssa.gov/oact/STATS/table4c6.html">US Period Life Tables</a>. Here is the code you will need to load and examine the data from <strong>dslabs</strong>:</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="section-4-overview.html#cb344-1" aria-hidden="true"></a><span class="kw">data</span>(death_prob)</span>
<span id="cb344-2"><a href="section-4-overview.html#cb344-2" aria-hidden="true"></a><span class="kw">head</span>(death_prob)</span></code></pre></div>
<pre><code>##   age  sex     prob
## 1   0 Male 0.006383
## 2   1 Male 0.000453
## 3   2 Male 0.000282
## 4   3 Male 0.000230
## 5   4 Male 0.000169
## 6   5 Male 0.000155</code></pre>
<p>There are six multi-part questions for you to answer that follow.</p>
<div id="and-2.-insurance-rates-part-1" class="section level4" number="5.4.0.1">
<h4><span class="header-section-number">5.4.0.1</span> 1. and 2. Insurance rates, part 1</h4>
<p>Use the information below as you answer this 6-part question.</p>
<p>An insurance company offers a one-year term life insurance policy that pays $150,000 in the event of death within one year. The premium (annual cost) for this policy for a 50 year old female is $1,150. Suppose that in the event of a claim, the company forfeits the premium and loses a total of $150,000, and if there is no claim the company gains the premium amount of $1,150. The company plans to sell 1,000 policies to this demographic.</p>
<p>1a. The <code>death_prob</code> data frame contains information about the estimated probability of death within 1 year (<code>prob</code>) for different ages and sexes.</p>
<p>Use <code>death_prob</code> to determine the death probability of a 50 year old female, <code>p</code>.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="section-4-overview.html#cb346-1" aria-hidden="true"></a>p &lt;-<span class="st"> </span>death_prob <span class="op">%&gt;%</span></span>
<span id="cb346-2"><a href="section-4-overview.html#cb346-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(sex <span class="op">==</span><span class="st"> &quot;Female&quot;</span> <span class="op">&amp;</span><span class="st"> </span>age <span class="op">==</span><span class="st"> &quot;50&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb346-3"><a href="section-4-overview.html#cb346-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">pull</span>(prob)</span>
<span id="cb346-4"><a href="section-4-overview.html#cb346-4" aria-hidden="true"></a>p</span></code></pre></div>
<pre><code>## [1] 0.00319</code></pre>
<p>1b. The loss in the event of the policy holders death is -$150,000 and the gain if the policy holder remains alive is the premium $1,150.</p>
<p>What is the expected value of the companys net profit on one policy for a 50 year old female?</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="section-4-overview.html#cb348-1" aria-hidden="true"></a>a &lt;-<span class="st"> </span><span class="dv">-150000</span></span>
<span id="cb348-2"><a href="section-4-overview.html#cb348-2" aria-hidden="true"></a>b &lt;-<span class="st"> </span><span class="dv">1150</span></span>
<span id="cb348-3"><a href="section-4-overview.html#cb348-3" aria-hidden="true"></a></span>
<span id="cb348-4"><a href="section-4-overview.html#cb348-4" aria-hidden="true"></a>mu &lt;-<span class="st"> </span>a<span class="op">*</span>p <span class="op">+</span><span class="st"> </span>b<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)</span>
<span id="cb348-5"><a href="section-4-overview.html#cb348-5" aria-hidden="true"></a>mu</span></code></pre></div>
<pre><code>## [1] 667</code></pre>
<p>1c. Calculate the standard error of the profit on one policy for a 50 year old female.</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="section-4-overview.html#cb350-1" aria-hidden="true"></a>sigma &lt;-<span class="st"> </span><span class="kw">abs</span>(b<span class="op">-</span>a) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p))</span>
<span id="cb350-2"><a href="section-4-overview.html#cb350-2" aria-hidden="true"></a>sigma</span></code></pre></div>
<pre><code>## [1] 8527</code></pre>
<p>1d. What is the expected value of the companys profit over all 1,000 policies for 50 year old females?</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="section-4-overview.html#cb352-1" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb352-2"><a href="section-4-overview.html#cb352-2" aria-hidden="true"></a>n<span class="op">*</span>mu</span></code></pre></div>
<pre><code>## [1] 667378</code></pre>
<p>1e. What is the standard error of the sum of the expected value over all 1,000 policies for 50 year old females?</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="section-4-overview.html#cb354-1" aria-hidden="true"></a><span class="kw">sqrt</span>(n) <span class="op">*</span><span class="st"> </span>sigma</span></code></pre></div>
<pre><code>## [1] 269658</code></pre>
<p>1f. Use the Central Limit Theorem to calculate the probability that the insurance company loses money on this set of 1,000 policies.</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="section-4-overview.html#cb356-1" aria-hidden="true"></a><span class="kw">pnorm</span>(<span class="dv">0</span>, n<span class="op">*</span>mu, <span class="kw">sqrt</span>(n)<span class="op">*</span>sigma)</span></code></pre></div>
<pre><code>## [1] 0.00666</code></pre>
<p>50 year old males have a different probability of death than 50 year old females. We will calculate a profitable premium for 50 year old males in the following four-part question.</p>
<p>2a. Use <code>death_prob</code> to determine the probability of death within one year for a 50 year old male.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="section-4-overview.html#cb358-1" aria-hidden="true"></a>p_male &lt;-<span class="st"> </span>death_prob <span class="op">%&gt;%</span></span>
<span id="cb358-2"><a href="section-4-overview.html#cb358-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(sex <span class="op">==</span><span class="st"> &quot;Male&quot;</span> <span class="op">&amp;</span><span class="st"> </span>age <span class="op">==</span><span class="st"> &quot;50&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb358-3"><a href="section-4-overview.html#cb358-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">pull</span>(prob)</span>
<span id="cb358-4"><a href="section-4-overview.html#cb358-4" aria-hidden="true"></a>p_male</span></code></pre></div>
<pre><code>## [1] 0.00501</code></pre>
<p>2b. Suppose the company wants its expected profits from 1,000 50 year old males with $150,000 life insurance policies to be $700,000.</p>
<p>Use the formula for expected value of the sum of draws with the following values and solve for the premium <span class="math inline">\(b\)</span>:</p>
<p><span class="math inline">\(E \left [ \right ] = \mu S = 700000\)</span></p>
<p><span class="math inline">\(n=1000\)</span></p>
<p><span class="math inline">\(p = \mbox{death probability of age 50 male}\)</span></p>
<p><span class="math inline">\(a = 150000\)</span></p>
<p><span class="math inline">\(b = \mbox{premium}\)</span></p>
<p><span class="math inline">\(\mu_S = n(ap + b(1-p))\)</span></p>
<p><span class="math inline">\(b = \frac{\frac{\mu_S}{n}-ap}{1-p}\)</span></p>
<p>What premium should be charged?</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="section-4-overview.html#cb360-1" aria-hidden="true"></a>p &lt;-<span class="st"> </span>p_male</span>
<span id="cb360-2"><a href="section-4-overview.html#cb360-2" aria-hidden="true"></a>mu_sum &lt;-<span class="st"> </span><span class="dv">700000</span></span>
<span id="cb360-3"><a href="section-4-overview.html#cb360-3" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb360-4"><a href="section-4-overview.html#cb360-4" aria-hidden="true"></a>a &lt;-<span class="st"> </span><span class="dv">-150000</span></span>
<span id="cb360-5"><a href="section-4-overview.html#cb360-5" aria-hidden="true"></a></span>
<span id="cb360-6"><a href="section-4-overview.html#cb360-6" aria-hidden="true"></a>b &lt;-<span class="st"> </span>(mu_sum<span class="op">/</span>n<span class="op">-</span>a<span class="op">*</span>p)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>p)</span>
<span id="cb360-7"><a href="section-4-overview.html#cb360-7" aria-hidden="true"></a>b</span></code></pre></div>
<pre><code>## [1] 1459</code></pre>
<p>2c. Using the new 50 year old male premium rate, calculate the standard error of the sum of 1,000 premiums.</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="section-4-overview.html#cb362-1" aria-hidden="true"></a>sigma_sum &lt;-<span class="st"> </span><span class="kw">sqrt</span>(n)<span class="op">*</span><span class="kw">abs</span>(b<span class="op">-</span>a)<span class="op">*</span><span class="kw">sqrt</span>(p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p))</span>
<span id="cb362-2"><a href="section-4-overview.html#cb362-2" aria-hidden="true"></a>sigma_sum</span></code></pre></div>
<pre><code>## [1] 338262</code></pre>
<p>2d. What is the probability of losing money on a series of 1,000 policies to 50 year old males?</p>
<p>Use the Central Limit Theorem.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="section-4-overview.html#cb364-1" aria-hidden="true"></a><span class="kw">pnorm</span>(<span class="dv">0</span>, mu_sum, sigma_sum)</span></code></pre></div>
<pre><code>## [1] 0.0193</code></pre>
</div>
<div id="and-4.-insurance-rates-part-2" class="section level4" number="5.4.0.2">
<h4><span class="header-section-number">5.4.0.2</span> 3. and 4. Insurance rates, part 2</h4>
<p>Life insurance rates are calculated using mortality statistics from the recent past. They are priced such that companies are almost assured to profit as long as the probability of death remains similar. If an event occurs that changes the probability of death in a given age group, the company risks significant losses.</p>
<p>In this 6-part question, well look at a scenario in which a lethal pandemic disease increases the probability of death within 1 year for a 50 year old to .015. Unable to predict the outbreak, the company has sold 1,000 $150,000 life insurance policies for $1,150.</p>
<p>3a. What is the expected value of the companys profits over 1,000 policies?</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="section-4-overview.html#cb366-1" aria-hidden="true"></a>p &lt;-<span class="st"> </span><span class="fl">.015</span>    <span class="co"># probability of claim</span></span>
<span id="cb366-2"><a href="section-4-overview.html#cb366-2" aria-hidden="true"></a>a &lt;-<span class="st"> </span><span class="dv">-150000</span>    <span class="co"># loss per claim</span></span>
<span id="cb366-3"><a href="section-4-overview.html#cb366-3" aria-hidden="true"></a>b &lt;-<span class="st"> </span><span class="dv">1150</span>    <span class="co"># premium - profit when no claim</span></span>
<span id="cb366-4"><a href="section-4-overview.html#cb366-4" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb366-5"><a href="section-4-overview.html#cb366-5" aria-hidden="true"></a></span>
<span id="cb366-6"><a href="section-4-overview.html#cb366-6" aria-hidden="true"></a>exp_val &lt;-<span class="st"> </span>n<span class="op">*</span>(a<span class="op">*</span>p <span class="op">+</span><span class="st"> </span>b<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p))</span>
<span id="cb366-7"><a href="section-4-overview.html#cb366-7" aria-hidden="true"></a>exp_val</span></code></pre></div>
<pre><code>## [1] -1117250</code></pre>
<p>3b. What is the standard error of the expected value of the companys profits over 1,000 policies?</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="section-4-overview.html#cb368-1" aria-hidden="true"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(n) <span class="op">*</span><span class="st"> </span><span class="kw">abs</span>(b<span class="op">-</span>a) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p))</span>
<span id="cb368-2"><a href="section-4-overview.html#cb368-2" aria-hidden="true"></a>se</span></code></pre></div>
<pre><code>## [1] 580994</code></pre>
<p>3c. What is the probability of the company losing money?</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="section-4-overview.html#cb370-1" aria-hidden="true"></a><span class="kw">pnorm</span>(<span class="dv">0</span>, exp_val, se)</span></code></pre></div>
<pre><code>## [1] 0.973</code></pre>
<p>3d. Suppose the company can afford to sustain one-time losses of $1 million, but larger losses will force it to go out of business.</p>
<p>What is the probability of losing more than $1 million?</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="section-4-overview.html#cb372-1" aria-hidden="true"></a><span class="kw">pnorm</span>(<span class="op">-</span><span class="dv">1</span><span class="op">*</span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span>, exp_val, se)</span></code></pre></div>
<pre><code>## [1] 0.58</code></pre>
<p>3e. Investigate death probabilities <code>p &lt;- seq(.01, .03, .001)</code>.</p>
<p>What is the lowest death probability for which the chance of losing money exceeds 90%?</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="section-4-overview.html#cb374-1" aria-hidden="true"></a>p &lt;-<span class="st"> </span><span class="kw">seq</span>(.<span class="dv">01</span>, <span class="fl">.03</span>, <span class="fl">.001</span>)</span>
<span id="cb374-2"><a href="section-4-overview.html#cb374-2" aria-hidden="true"></a>a &lt;-<span class="st"> </span><span class="dv">-150000</span>    <span class="co"># loss per claim</span></span>
<span id="cb374-3"><a href="section-4-overview.html#cb374-3" aria-hidden="true"></a>b &lt;-<span class="st"> </span><span class="dv">1150</span>    <span class="co"># premium - profit when no claim</span></span>
<span id="cb374-4"><a href="section-4-overview.html#cb374-4" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb374-5"><a href="section-4-overview.html#cb374-5" aria-hidden="true"></a></span>
<span id="cb374-6"><a href="section-4-overview.html#cb374-6" aria-hidden="true"></a>p_lose_money &lt;-<span class="st"> </span><span class="kw">sapply</span>(p, <span class="cf">function</span>(p){</span>
<span id="cb374-7"><a href="section-4-overview.html#cb374-7" aria-hidden="true"></a>  exp_val &lt;-<span class="st"> </span>n<span class="op">*</span>(a<span class="op">*</span>p <span class="op">+</span><span class="st"> </span>b<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p))</span>
<span id="cb374-8"><a href="section-4-overview.html#cb374-8" aria-hidden="true"></a>  se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(n) <span class="op">*</span><span class="st"> </span><span class="kw">abs</span>(b<span class="op">-</span>a) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p))</span>
<span id="cb374-9"><a href="section-4-overview.html#cb374-9" aria-hidden="true"></a>  <span class="kw">pnorm</span>(<span class="dv">0</span>, exp_val, se)</span>
<span id="cb374-10"><a href="section-4-overview.html#cb374-10" aria-hidden="true"></a>})</span>
<span id="cb374-11"><a href="section-4-overview.html#cb374-11" aria-hidden="true"></a></span>
<span id="cb374-12"><a href="section-4-overview.html#cb374-12" aria-hidden="true"></a><span class="kw">data.frame</span>(p, p_lose_money) <span class="op">%&gt;%</span></span>
<span id="cb374-13"><a href="section-4-overview.html#cb374-13" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(p_lose_money <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.9</span>) <span class="op">%&gt;%</span></span>
<span id="cb374-14"><a href="section-4-overview.html#cb374-14" aria-hidden="true"></a><span class="st">  </span><span class="kw">pull</span>(p) <span class="op">%&gt;%</span></span>
<span id="cb374-15"><a href="section-4-overview.html#cb374-15" aria-hidden="true"></a><span class="st">  </span><span class="kw">min</span>()</span></code></pre></div>
<pre><code>## [1] 0.013</code></pre>
<p>3f. Investigate death probabilities <code>p &lt;- seq(.01, .03, .0025)</code>.</p>
<p>What is the lowest death probability for which the chance of losing over $1 million exceeds 90%?</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="section-4-overview.html#cb376-1" aria-hidden="true"></a>p_lose_million &lt;-<span class="st"> </span><span class="kw">sapply</span>(p, <span class="cf">function</span>(p){</span>
<span id="cb376-2"><a href="section-4-overview.html#cb376-2" aria-hidden="true"></a>  exp_val &lt;-<span class="st"> </span>n<span class="op">*</span>(a<span class="op">*</span>p <span class="op">+</span><span class="st"> </span>b<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p))</span>
<span id="cb376-3"><a href="section-4-overview.html#cb376-3" aria-hidden="true"></a>  se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(n) <span class="op">*</span><span class="st"> </span><span class="kw">abs</span>(b<span class="op">-</span>a) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p))</span>
<span id="cb376-4"><a href="section-4-overview.html#cb376-4" aria-hidden="true"></a>  <span class="kw">pnorm</span>(<span class="op">-</span><span class="dv">1</span><span class="op">*</span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span>, exp_val, se)</span>
<span id="cb376-5"><a href="section-4-overview.html#cb376-5" aria-hidden="true"></a>})</span>
<span id="cb376-6"><a href="section-4-overview.html#cb376-6" aria-hidden="true"></a></span>
<span id="cb376-7"><a href="section-4-overview.html#cb376-7" aria-hidden="true"></a><span class="kw">data.frame</span>(p, p_lose_million) <span class="op">%&gt;%</span></span>
<span id="cb376-8"><a href="section-4-overview.html#cb376-8" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(p_lose_million <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.9</span>) <span class="op">%&gt;%</span></span>
<span id="cb376-9"><a href="section-4-overview.html#cb376-9" aria-hidden="true"></a><span class="st">  </span><span class="kw">pull</span>(p) <span class="op">%&gt;%</span></span>
<span id="cb376-10"><a href="section-4-overview.html#cb376-10" aria-hidden="true"></a><span class="st">  </span><span class="kw">min</span>()</span></code></pre></div>
<pre><code>## [1] 0.02</code></pre>
<p>4a. Define a sampling model for simulating the total profit over 1,000 loans with probability of claim <code>p_loss = .015</code>, loss of -$150,000 on a claim, and profit of $1,150 when there is no claim. Set the seed to 25, then run the model once.</p>
<p>(IMPORTANT! If you use R 3.6 or later, you will need to use the command <code>set.seed(x, sample.kind = "Rounding")</code> instead of <code>set.seed(x)</code>. Your R version will be printed at the top of the Console window when you start RStudio.)</p>
<p>What is the reported profit (or loss) in millions (that is, divided by <span class="math inline">\(10^6\)</span>)?</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="section-4-overview.html#cb378-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">25</span>)</span>
<span id="cb378-2"><a href="section-4-overview.html#cb378-2" aria-hidden="true"></a></span>
<span id="cb378-3"><a href="section-4-overview.html#cb378-3" aria-hidden="true"></a>p &lt;-<span class="st"> </span><span class="fl">.015</span></span>
<span id="cb378-4"><a href="section-4-overview.html#cb378-4" aria-hidden="true"></a>loss &lt;-<span class="st"> </span><span class="dv">-150000</span></span>
<span id="cb378-5"><a href="section-4-overview.html#cb378-5" aria-hidden="true"></a>profit &lt;-<span class="st"> </span><span class="dv">1150</span></span>
<span id="cb378-6"><a href="section-4-overview.html#cb378-6" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb378-7"><a href="section-4-overview.html#cb378-7" aria-hidden="true"></a></span>
<span id="cb378-8"><a href="section-4-overview.html#cb378-8" aria-hidden="true"></a>outcomes &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(loss, profit), n, <span class="dt">prob =</span> <span class="kw">c</span>(p, <span class="dv">1</span><span class="op">-</span>p), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb378-9"><a href="section-4-overview.html#cb378-9" aria-hidden="true"></a><span class="kw">sum</span>(outcomes)<span class="op">/</span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span></span></code></pre></div>
<pre><code>## [1] -1.42</code></pre>
<p>4b. Set the seed to 27, then run a Monte Carlo simulation of your sampling model with 10,000 replicates to simulate the range of profits/losses over 1,000 loans.</p>
<p>(IMPORTANT! If you use R 3.6 or later, you will need to use the command <code>set.seed(x, sample.kind = "Rounding")</code> instead of <code>set.seed(x)</code>. Your R version will be printed at the top of the Console window when you start RStudio.)</p>
<p>What is the observed probability of losing $1 million or more?</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="section-4-overview.html#cb380-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">27</span>)</span>
<span id="cb380-2"><a href="section-4-overview.html#cb380-2" aria-hidden="true"></a>B &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb380-3"><a href="section-4-overview.html#cb380-3" aria-hidden="true"></a></span>
<span id="cb380-4"><a href="section-4-overview.html#cb380-4" aria-hidden="true"></a>profits &lt;-<span class="st"> </span><span class="kw">replicate</span>(B, {</span>
<span id="cb380-5"><a href="section-4-overview.html#cb380-5" aria-hidden="true"></a>  outcomes &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(loss, profit), n, <span class="dt">prob =</span> <span class="kw">c</span>(p, <span class="dv">1</span><span class="op">-</span>p), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb380-6"><a href="section-4-overview.html#cb380-6" aria-hidden="true"></a>  <span class="kw">sum</span>(outcomes)<span class="op">/</span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span></span>
<span id="cb380-7"><a href="section-4-overview.html#cb380-7" aria-hidden="true"></a>})</span>
<span id="cb380-8"><a href="section-4-overview.html#cb380-8" aria-hidden="true"></a></span>
<span id="cb380-9"><a href="section-4-overview.html#cb380-9" aria-hidden="true"></a><span class="kw">mean</span>(profits <span class="op">&lt;</span><span class="st"> </span><span class="dv">-1</span>)</span></code></pre></div>
<pre><code>## [1] 0.539</code></pre>
</div>
<div id="and-6.-insurance-rates-part-3" class="section level4" number="5.4.0.3">
<h4><span class="header-section-number">5.4.0.3</span> 5. and 6. Insurance rates, part 3</h4>
<p>Question 5, which has 4 parts, continues the pandemic scenario from Questions 3 and 4.</p>
<p>Suppose that there is a massive demand for life insurance due to the pandemic, and the company wants to find a premium cost for which the probability of losing money is under 5%, assuming the death rate stays stable at <span class="math inline">\(p = 0.015\)</span>.</p>
<p>5a. Calculate the premium required for a 5% chance of losing money given <span class="math inline">\(n = 1000\)</span> loans, probability of death <span class="math inline">\(p = 0.015\)</span>, and loss per claim <span class="math inline">\(l = -150000\)</span>. Save this premium as <code>x</code> for use in further questions.</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="section-4-overview.html#cb382-1" aria-hidden="true"></a>p &lt;-<span class="st"> </span><span class="fl">.015</span></span>
<span id="cb382-2"><a href="section-4-overview.html#cb382-2" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb382-3"><a href="section-4-overview.html#cb382-3" aria-hidden="true"></a>l &lt;-<span class="st"> </span><span class="dv">-150000</span></span>
<span id="cb382-4"><a href="section-4-overview.html#cb382-4" aria-hidden="true"></a>z &lt;-<span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">05</span>)</span>
<span id="cb382-5"><a href="section-4-overview.html#cb382-5" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="op">-</span>l<span class="op">*</span>( n<span class="op">*</span>p <span class="op">-</span><span class="st"> </span>z<span class="op">*</span><span class="kw">sqrt</span>(n<span class="op">*</span>p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)))<span class="op">/</span><span class="st"> </span>( n<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p) <span class="op">+</span><span class="st"> </span>z<span class="op">*</span><span class="kw">sqrt</span>(n<span class="op">*</span>p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)))</span>
<span id="cb382-6"><a href="section-4-overview.html#cb382-6" aria-hidden="true"></a>x</span></code></pre></div>
<pre><code>## [1] 3268</code></pre>
<p>5b. What is the expected profit per policy at this rate?</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="section-4-overview.html#cb384-1" aria-hidden="true"></a>l<span class="op">*</span>p <span class="op">+</span><span class="st"> </span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)</span></code></pre></div>
<pre><code>## [1] 969</code></pre>
<p>5c. What is the expected profit over 1,000 policies?</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="section-4-overview.html#cb386-1" aria-hidden="true"></a>mu &lt;-<span class="st"> </span>n<span class="op">*</span>(l<span class="op">*</span>p <span class="op">+</span><span class="st"> </span>x<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p))</span>
<span id="cb386-2"><a href="section-4-overview.html#cb386-2" aria-hidden="true"></a>mu</span></code></pre></div>
<pre><code>## [1] 969042</code></pre>
<p>5d. Run a Monte Carlo simulation with <span class="math inline">\(B = 10000\)</span> to determine the probability of losing money on 1,000 policies given the new premium <code>x</code>, loss on a claim of $150,000, and probability of claim <span class="math inline">\(p = .015\)</span>. Set the seed to 28 before running your simulation.</p>
<p>(IMPORTANT! If you use R 3.6 or later, you will need to use the command <code>set.seed(x, sample.kind = "Rounding")</code> instead of <code>set.seed(x)</code>. Your R version will be printed at the top of the Console window when you start RStudio.)</p>
<p>What is the probability of losing money here?</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="section-4-overview.html#cb388-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">28</span>)</span>
<span id="cb388-2"><a href="section-4-overview.html#cb388-2" aria-hidden="true"></a>B &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb388-3"><a href="section-4-overview.html#cb388-3" aria-hidden="true"></a>profit &lt;-<span class="st"> </span><span class="kw">replicate</span>(B, {</span>
<span id="cb388-4"><a href="section-4-overview.html#cb388-4" aria-hidden="true"></a>  draws &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(x, l), n,</span>
<span id="cb388-5"><a href="section-4-overview.html#cb388-5" aria-hidden="true"></a>                  <span class="dt">prob=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p, p), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb388-6"><a href="section-4-overview.html#cb388-6" aria-hidden="true"></a>  <span class="kw">sum</span>(draws)</span>
<span id="cb388-7"><a href="section-4-overview.html#cb388-7" aria-hidden="true"></a>})</span>
<span id="cb388-8"><a href="section-4-overview.html#cb388-8" aria-hidden="true"></a></span>
<span id="cb388-9"><a href="section-4-overview.html#cb388-9" aria-hidden="true"></a><span class="kw">mean</span>(profit <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 0.0554</code></pre>
<p>The company cannot predict whether the pandemic death rate will stay stable. Set the seed to 29, then write a Monte Carlo simulation that for each of <span class="math inline">\(B = 10000\)</span> iterations:</p>
<ul>
<li>randomly changes <span class="math inline">\(p\)</span> by adding a value between -0.01 and 0.01 with <strong>sample(seq(-0.01, 0.01, length = 100), 1)</strong></li>
<li>uses the new random <span class="math inline">\(p\)</span> to generate a sample of <span class="math inline">\(n = 1000\)</span> policies with premium <strong>x</strong> and loss per claim <span class="math inline">\(l = -150000\)</span></li>
<li>returns the profit over <span class="math inline">\(n\)</span> policies (sum of random variable)</li>
</ul>
<p>(IMPORTANT! If you use R 3.6 or later, you will need to use the command <strong>set.seed(x, sample.kind = Rounding)</strong> instead of <strong>set.seed(x)</strong>. Your R version will be printed at the top of the Console window when you start RStudio.)</p>
<p>The outcome should be a vector of <span class="math inline">\(B\)</span> total profits. Use the results of the Monte Carlo simulation to answer the following three questions.</p>
<p>(Hint: Use the process from lecture for modeling a situation for loans that changes the probability of default for all borrowers simultaneously.)</p>
<p>6a. What is the expected value over 1,000 policies?</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="section-4-overview.html#cb390-1" aria-hidden="true"></a><span class="co"># n, p, l and x as defined in the problem information</span></span>
<span id="cb390-2"><a href="section-4-overview.html#cb390-2" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">29</span>)    <span class="co"># in R 3.6, set.seed(29, sample.kind=&quot;Rounding&quot;)</span></span>
<span id="cb390-3"><a href="section-4-overview.html#cb390-3" aria-hidden="true"></a>  </span>
<span id="cb390-4"><a href="section-4-overview.html#cb390-4" aria-hidden="true"></a>profit &lt;-<span class="st"> </span><span class="kw">replicate</span>(B, {</span>
<span id="cb390-5"><a href="section-4-overview.html#cb390-5" aria-hidden="true"></a>    new_p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">sample</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="dt">length =</span> <span class="dv">100</span>), <span class="dv">1</span>)</span>
<span id="cb390-6"><a href="section-4-overview.html#cb390-6" aria-hidden="true"></a>    draws &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(x, l), n, </span>
<span id="cb390-7"><a href="section-4-overview.html#cb390-7" aria-hidden="true"></a>                    <span class="dt">prob=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>new_p, new_p), <span class="dt">replace =</span> <span class="ot">TRUE</span>) </span>
<span id="cb390-8"><a href="section-4-overview.html#cb390-8" aria-hidden="true"></a>    <span class="kw">sum</span>(draws)</span>
<span id="cb390-9"><a href="section-4-overview.html#cb390-9" aria-hidden="true"></a>})</span></code></pre></div>
<p>6b. What is the probability of losing money?</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="section-4-overview.html#cb391-1" aria-hidden="true"></a><span class="kw">mean</span>(profit <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 0.191</code></pre>
<p>6c. What is the probability of losing more than $1 million?</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="section-4-overview.html#cb393-1" aria-hidden="true"></a><span class="kw">mean</span>(profit <span class="op">&lt;</span><span class="st"> </span><span class="dv">-1</span><span class="op">*</span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 0.0424</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="section-3-overview.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
