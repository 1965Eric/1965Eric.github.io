<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Section 2 Overview | Data Science Wrangling</title>
  <meta name="description" content="3 Section 2 Overview | Data Science Wrangling" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Section 2 Overview | Data Science Wrangling" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Section 2 Overview | Data Science Wrangling" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="section-1-overview.html"/>
<link rel="next" href="section-3-overview.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning Objectives</a>
<ul>
<li class="chapter" data-level="1.1" data-path="learning-objectives.html"><a href="learning-objectives.html#course-overview"><i class="fa fa-check"></i><b>1.1</b> Course Overview</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="learning-objectives.html"><a href="learning-objectives.html#section-1-data-import"><i class="fa fa-check"></i><b>1.1.1</b> Section 1: Data Import</a></li>
<li class="chapter" data-level="1.1.2" data-path="learning-objectives.html"><a href="learning-objectives.html#section-2-tidy-data"><i class="fa fa-check"></i><b>1.1.2</b> Section 2: Tidy Data</a></li>
<li class="chapter" data-level="1.1.3" data-path="learning-objectives.html"><a href="learning-objectives.html#section-3-string-processing"><i class="fa fa-check"></i><b>1.1.3</b> Section 3: String Processing</a></li>
<li class="chapter" data-level="1.1.4" data-path="learning-objectives.html"><a href="learning-objectives.html#section-4-dates-times-and-text-mining"><i class="fa fa-check"></i><b>1.1.4</b> Section 4: Dates, Times, and Text Mining</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="learning-objectives.html"><a href="learning-objectives.html#introduction-to-wrangling"><i class="fa fa-check"></i><b>1.2</b> Introduction to Wrangling</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="section-1-overview.html"><a href="section-1-overview.html"><i class="fa fa-check"></i><b>2</b> Section 1 Overview</a>
<ul>
<li class="chapter" data-level="2.1" data-path="section-1-overview.html"><a href="section-1-overview.html#importing-spreadsheets"><i class="fa fa-check"></i><b>2.1</b> Importing Spreadsheets</a></li>
<li class="chapter" data-level="2.2" data-path="section-1-overview.html"><a href="section-1-overview.html#paths-and-the-working-directory"><i class="fa fa-check"></i><b>2.2</b> Paths and the Working Directory</a></li>
<li class="chapter" data-level="2.3" data-path="section-1-overview.html"><a href="section-1-overview.html#the-readr-and-readxl-packages"><i class="fa fa-check"></i><b>2.3</b> The readr and readxl Packages</a></li>
<li class="chapter" data-level="2.4" data-path="section-1-overview.html"><a href="section-1-overview.html#importing-data-using-r-base-functions"><i class="fa fa-check"></i><b>2.4</b> Importing Data Using R-base Functions</a></li>
<li class="chapter" data-level="2.5" data-path="section-1-overview.html"><a href="section-1-overview.html#downloading-files-from-the-internet"><i class="fa fa-check"></i><b>2.5</b> Downloading Files from the Internet</a></li>
<li class="chapter" data-level="2.6" data-path="section-1-overview.html"><a href="section-1-overview.html#assessment-part-1---data-import"><i class="fa fa-check"></i><b>2.6</b> Assessment Part 1 - Data Import</a></li>
<li class="chapter" data-level="2.7" data-path="section-1-overview.html"><a href="section-1-overview.html#assessment-part-2---data-import"><i class="fa fa-check"></i><b>2.7</b> Assessment Part 2 - Data Import</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="section-2-overview.html"><a href="section-2-overview.html"><i class="fa fa-check"></i><b>3</b> Section 2 Overview</a>
<ul>
<li class="chapter" data-level="3.1" data-path="section-2-overview.html"><a href="section-2-overview.html#tidy-data"><i class="fa fa-check"></i><b>3.1</b> Tidy Data</a></li>
<li class="chapter" data-level="3.2" data-path="section-2-overview.html"><a href="section-2-overview.html#reshaping-data"><i class="fa fa-check"></i><b>3.2</b> Reshaping Data</a></li>
<li class="chapter" data-level="3.3" data-path="section-2-overview.html"><a href="section-2-overview.html#separate-and-unite"><i class="fa fa-check"></i><b>3.3</b> Separate and Unite</a></li>
<li class="chapter" data-level="3.4" data-path="section-2-overview.html"><a href="section-2-overview.html#assessment-part-1---reshaping-data"><i class="fa fa-check"></i><b>3.4</b> Assessment Part 1 - Reshaping Data</a></li>
<li class="chapter" data-level="3.5" data-path="section-2-overview.html"><a href="section-2-overview.html#assessment-part-2---reshaping-data"><i class="fa fa-check"></i><b>3.5</b> Assessment Part 2 - Reshaping Data</a></li>
<li class="chapter" data-level="3.6" data-path="section-2-overview.html"><a href="section-2-overview.html#combining-tables"><i class="fa fa-check"></i><b>3.6</b> Combining Tables</a></li>
<li class="chapter" data-level="3.7" data-path="section-2-overview.html"><a href="section-2-overview.html#binding"><i class="fa fa-check"></i><b>3.7</b> Binding</a></li>
<li class="chapter" data-level="3.8" data-path="section-2-overview.html"><a href="section-2-overview.html#set-operators"><i class="fa fa-check"></i><b>3.8</b> Set Operators</a></li>
<li class="chapter" data-level="3.9" data-path="section-2-overview.html"><a href="section-2-overview.html#assessment---combining-tables"><i class="fa fa-check"></i><b>3.9</b> Assessment - Combining Tables</a></li>
<li class="chapter" data-level="3.10" data-path="section-2-overview.html"><a href="section-2-overview.html#web-scraping"><i class="fa fa-check"></i><b>3.10</b> Web Scraping</a></li>
<li class="chapter" data-level="3.11" data-path="section-2-overview.html"><a href="section-2-overview.html#css-selectors"><i class="fa fa-check"></i><b>3.11</b> CSS Selectors</a></li>
<li class="chapter" data-level="3.12" data-path="section-2-overview.html"><a href="section-2-overview.html#assessment---web-scraping"><i class="fa fa-check"></i><b>3.12</b> Assessment - Web Scraping</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="section-3-overview.html"><a href="section-3-overview.html"><i class="fa fa-check"></i><b>4</b> Section 3 Overview</a>
<ul>
<li class="chapter" data-level="4.1" data-path="section-3-overview.html"><a href="section-3-overview.html#string-parsing"><i class="fa fa-check"></i><b>4.1</b> String Parsing</a></li>
<li class="chapter" data-level="4.2" data-path="section-3-overview.html"><a href="section-3-overview.html#defining-strings-single-and-double-quotes-and-how-to-escape"><i class="fa fa-check"></i><b>4.2</b> Defining Strings: Single and Double Quotes and How to Escape</a></li>
<li class="chapter" data-level="4.3" data-path="section-3-overview.html"><a href="section-3-overview.html#stringr-package"><i class="fa fa-check"></i><b>4.3</b> stringr Package</a></li>
<li class="chapter" data-level="4.4" data-path="section-3-overview.html"><a href="section-3-overview.html#case-study-1-us-murders-data"><i class="fa fa-check"></i><b>4.4</b> Case Study 1: US Murders Data</a></li>
<li class="chapter" data-level="4.5" data-path="section-3-overview.html"><a href="section-3-overview.html#assessment---string-processing-part-1"><i class="fa fa-check"></i><b>4.5</b> Assessment - String Processing Part 1</a></li>
<li class="chapter" data-level="4.6" data-path="section-3-overview.html"><a href="section-3-overview.html#case-study-2-reported-heights"><i class="fa fa-check"></i><b>4.6</b> Case Study 2: Reported Heights</a></li>
<li class="chapter" data-level="4.7" data-path="section-3-overview.html"><a href="section-3-overview.html#regex"><i class="fa fa-check"></i><b>4.7</b> Regex</a></li>
<li class="chapter" data-level="4.8" data-path="section-3-overview.html"><a href="section-3-overview.html#character-classes-anchors-and-quantifiers"><i class="fa fa-check"></i><b>4.8</b> Character Classes, Anchors and Quantifiers</a></li>
<li class="chapter" data-level="4.9" data-path="section-3-overview.html"><a href="section-3-overview.html#search-and-replace-with-regex"><i class="fa fa-check"></i><b>4.9</b> Search and Replace with Regex</a></li>
<li class="chapter" data-level="4.10" data-path="section-3-overview.html"><a href="section-3-overview.html#groups-with-regex"><i class="fa fa-check"></i><b>4.10</b> Groups with Regex</a></li>
<li class="chapter" data-level="4.11" data-path="section-3-overview.html"><a href="section-3-overview.html#testing-and-improving"><i class="fa fa-check"></i><b>4.11</b> Testing and Improving</a></li>
<li class="chapter" data-level="4.12" data-path="section-3-overview.html"><a href="section-3-overview.html#assessment---string-processing-part-2"><i class="fa fa-check"></i><b>4.12</b> Assessment - String Processing Part 2</a></li>
<li class="chapter" data-level="4.13" data-path="section-3-overview.html"><a href="section-3-overview.html#separate-with-regex"><i class="fa fa-check"></i><b>4.13</b> Separate with Regex</a></li>
<li class="chapter" data-level="4.14" data-path="section-3-overview.html"><a href="section-3-overview.html#using-groups-and-quantifiers"><i class="fa fa-check"></i><b>4.14</b> Using Groups and Quantifiers</a></li>
<li class="chapter" data-level="4.15" data-path="section-3-overview.html"><a href="section-3-overview.html#putting-it-all-together"><i class="fa fa-check"></i><b>4.15</b> Putting it All Together</a></li>
<li class="chapter" data-level="4.16" data-path="section-3-overview.html"><a href="section-3-overview.html#string-splitting"><i class="fa fa-check"></i><b>4.16</b> String Splitting</a></li>
<li class="chapter" data-level="4.17" data-path="section-3-overview.html"><a href="section-3-overview.html#case-study---extracting-a-table-from-a-pdf"><i class="fa fa-check"></i><b>4.17</b> Case Study - Extracting a Table from a PDF</a></li>
<li class="chapter" data-level="4.18" data-path="section-3-overview.html"><a href="section-3-overview.html#recoding"><i class="fa fa-check"></i><b>4.18</b> Recoding</a></li>
<li class="chapter" data-level="4.19" data-path="section-3-overview.html"><a href="section-3-overview.html#assessment---string-processing-part-3"><i class="fa fa-check"></i><b>4.19</b> Assessment - String Processing Part 3</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="section-4-overview.html"><a href="section-4-overview.html"><i class="fa fa-check"></i><b>5</b> Section 4 Overview</a>
<ul>
<li class="chapter" data-level="5.1" data-path="section-4-overview.html"><a href="section-4-overview.html#dates-and-times"><i class="fa fa-check"></i><b>5.1</b> Dates and Times</a></li>
<li class="chapter" data-level="5.2" data-path="section-4-overview.html"><a href="section-4-overview.html#text-mining"><i class="fa fa-check"></i><b>5.2</b> Text mining</a></li>
<li class="chapter" data-level="5.3" data-path="section-4-overview.html"><a href="section-4-overview.html#assessment-part-1---dates-times-and-text-mining"><i class="fa fa-check"></i><b>5.3</b> Assessment Part 1 - Dates, Times, and Text Mining</a></li>
<li class="chapter" data-level="5.4" data-path="section-4-overview.html"><a href="section-4-overview.html#assessment-part-2---dates-times-and-text-mining"><i class="fa fa-check"></i><b>5.4</b> Assessment Part 2 - Dates, Times, and Text Mining</a></li>
<li class="chapter" data-level="5.5" data-path="section-4-overview.html"><a href="section-4-overview.html#final-comprehensive-assessment"><i class="fa fa-check"></i><b>5.5</b> Final: Comprehensive Assessment</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="section-4-overview.html"><a href="section-4-overview.html#comprehensive-assessment-puerto-rico-hurricane-mortality"><i class="fa fa-check"></i><b>5.5.1</b> Comprehensive Assessment: Puerto Rico Hurricane Mortality</a></li>
<li class="chapter" data-level="5.5.2" data-path="section-4-overview.html"><a href="section-4-overview.html#project-introduction"><i class="fa fa-check"></i><b>5.5.2</b> Project Introduction</a></li>
<li class="chapter" data-level="5.5.3" data-path="section-4-overview.html"><a href="section-4-overview.html#puerto-rico-hurricane-mortality---part-1"><i class="fa fa-check"></i><b>5.5.3</b> Puerto Rico Hurricane Mortality - Part 1</a></li>
<li class="chapter" data-level="5.5.4" data-path="section-4-overview.html"><a href="section-4-overview.html#puerto-rico-hurricane-mortality---part-2"><i class="fa fa-check"></i><b>5.5.4</b> Puerto Rico Hurricane Mortality - Part 2</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science Wrangling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="section-2-overview" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Section 2 Overview</h1>
<p>In the <strong>Tidy Data</strong> section, you will learn how to convert data from a raw to a tidy format.</p>
<p>This section is divided into three parts: <strong>Reshaping Data</strong>, <strong>Combining Tables</strong>, and <strong>Web Scraping</strong>.</p>
<p>After completing the <strong>Tidy Data</strong> section, you will be able to:</p>
<ul>
<li><strong>Reshape data</strong> using functions from the <strong>tidyr</strong> package, including <code>gather()</code>, <code>spread()</code>, <code>separate()</code>, and <code>unite()</code>.</li>
<li>Combine information from different tables using <strong>join</strong> functions from the <strong>dplyr</strong> package.</li>
<li>Combine information from different tables using <strong>binding</strong> functions from the <strong>dplyr</strong> package.</li>
<li>Use <strong>set operators</strong> to combine data frames.</li>
<li>Gather data from a website through <strong>web scraping</strong> and use of <strong>CSS selectors</strong>.</li>
</ul>
<div id="tidy-data" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Tidy Data</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/tidyverse.html#tidy-data">here</a></p>
<p><strong>Key points</strong></p>
<ul>
<li>In tidy data, each row represents an observation and each column represents a different variable.</li>
<li>In wide data, each row includes several observations and one of the variables is stored in the header.</li>
</ul>
<p><em>Code</em></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="section-2-overview.html#cb58-1" aria-hidden="true"></a><span class="kw">data</span>(gapminder)</span>
<span id="cb58-2"><a href="section-2-overview.html#cb58-2" aria-hidden="true"></a></span>
<span id="cb58-3"><a href="section-2-overview.html#cb58-3" aria-hidden="true"></a><span class="co"># create and inspect a tidy data frame</span></span>
<span id="cb58-4"><a href="section-2-overview.html#cb58-4" aria-hidden="true"></a>tidy_data &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb58-5"><a href="section-2-overview.html#cb58-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(country <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;South Korea&quot;</span>, <span class="st">&quot;Germany&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb58-6"><a href="section-2-overview.html#cb58-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(country, year, fertility)</span>
<span id="cb58-7"><a href="section-2-overview.html#cb58-7" aria-hidden="true"></a><span class="kw">head</span>(tidy_data)</span></code></pre></div>
<pre><code>##       country year fertility
## 1     Germany 1960      2.41
## 2 South Korea 1960      6.16
## 3     Germany 1961      2.44
## 4 South Korea 1961      5.99
## 5     Germany 1962      2.47
## 6 South Korea 1962      5.79</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="section-2-overview.html#cb60-1" aria-hidden="true"></a><span class="co"># plotting tidy data is simple</span></span>
<span id="cb60-2"><a href="section-2-overview.html#cb60-2" aria-hidden="true"></a>tidy_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb60-3"><a href="section-2-overview.html#cb60-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, fertility, <span class="dt">color =</span> country)) <span class="op">+</span></span>
<span id="cb60-4"><a href="section-2-overview.html#cb60-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="section-2-overview.html#cb62-1" aria-hidden="true"></a><span class="co"># import and inspect example of original Gapminder data in wide format</span></span>
<span id="cb62-2"><a href="section-2-overview.html#cb62-2" aria-hidden="true"></a>path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="dt">package=</span><span class="st">&quot;dslabs&quot;</span>)</span>
<span id="cb62-3"><a href="section-2-overview.html#cb62-3" aria-hidden="true"></a>filename &lt;-<span class="st"> </span><span class="kw">file.path</span>(path,  <span class="st">&quot;fertility-two-countries-example.csv&quot;</span>)</span>
<span id="cb62-4"><a href="section-2-overview.html#cb62-4" aria-hidden="true"></a>wide_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(filename)</span></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_double(),
##   country = col_character()
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="section-2-overview.html#cb65-1" aria-hidden="true"></a><span class="kw">select</span>(wide_data, country, <span class="st">`</span><span class="dt">1960</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">1967</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 9
##   country     `1960` `1961` `1962` `1963` `1964` `1965` `1966` `1967`
##   &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 Germany       2.41   2.44   2.47   2.49   2.49   2.48   2.44   2.37
## 2 South Korea   6.16   5.99   5.79   5.57   5.36   5.16   4.99   4.85</code></pre>
</div>
<div id="reshaping-data" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Reshaping Data</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/reshaping-data.html">here</a>, <a href="https://rafalab.github.io/dsbook/reshaping-data.html#gather">here</a> and <a href="https://rafalab.github.io/dsbook/reshaping-data.html#spread">here</a></p>
<p><strong>Key points</strong></p>
<ul>
<li>The <strong>tidyr</strong> package includes several functions that are useful for tidying data.</li>
<li>The <code>gather()</code> function converts wide data into tidy data.</li>
<li>The <code>spread()</code> function converts tidy data to wide data.</li>
</ul>
<p><em>Code</em></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="section-2-overview.html#cb67-1" aria-hidden="true"></a><span class="co"># original wide data</span></span>
<span id="cb67-2"><a href="section-2-overview.html#cb67-2" aria-hidden="true"></a>path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="dt">package=</span><span class="st">&quot;dslabs&quot;</span>)</span>
<span id="cb67-3"><a href="section-2-overview.html#cb67-3" aria-hidden="true"></a>filename &lt;-<span class="st"> </span><span class="kw">file.path</span>(path,  <span class="st">&quot;fertility-two-countries-example.csv&quot;</span>)</span>
<span id="cb67-4"><a href="section-2-overview.html#cb67-4" aria-hidden="true"></a>wide_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(filename)</span></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_double(),
##   country = col_character()
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="section-2-overview.html#cb70-1" aria-hidden="true"></a><span class="co"># tidy data from dslabs</span></span>
<span id="cb70-2"><a href="section-2-overview.html#cb70-2" aria-hidden="true"></a>tidy_data &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb70-3"><a href="section-2-overview.html#cb70-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(country <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;South Korea&quot;</span>, <span class="st">&quot;Germany&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb70-4"><a href="section-2-overview.html#cb70-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(country, year, fertility)</span>
<span id="cb70-5"><a href="section-2-overview.html#cb70-5" aria-hidden="true"></a></span>
<span id="cb70-6"><a href="section-2-overview.html#cb70-6" aria-hidden="true"></a><span class="co"># gather wide data to make new tidy data</span></span>
<span id="cb70-7"><a href="section-2-overview.html#cb70-7" aria-hidden="true"></a>new_tidy_data &lt;-<span class="st"> </span>wide_data <span class="op">%&gt;%</span></span>
<span id="cb70-8"><a href="section-2-overview.html#cb70-8" aria-hidden="true"></a><span class="st">  </span><span class="kw">gather</span>(year, fertility, <span class="st">`</span><span class="dt">1960</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">2015</span><span class="st">`</span>)</span>
<span id="cb70-9"><a href="section-2-overview.html#cb70-9" aria-hidden="true"></a><span class="kw">head</span>(new_tidy_data)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   country     year  fertility
##   &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt;
## 1 Germany     1960       2.41
## 2 South Korea 1960       6.16
## 3 Germany     1961       2.44
## 4 South Korea 1961       5.99
## 5 Germany     1962       2.47
## 6 South Korea 1962       5.79</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="section-2-overview.html#cb72-1" aria-hidden="true"></a><span class="co"># gather all columns except country</span></span>
<span id="cb72-2"><a href="section-2-overview.html#cb72-2" aria-hidden="true"></a>new_tidy_data &lt;-<span class="st"> </span>wide_data <span class="op">%&gt;%</span></span>
<span id="cb72-3"><a href="section-2-overview.html#cb72-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">gather</span>(year, fertility, <span class="op">-</span>country)</span>
<span id="cb72-4"><a href="section-2-overview.html#cb72-4" aria-hidden="true"></a></span>
<span id="cb72-5"><a href="section-2-overview.html#cb72-5" aria-hidden="true"></a><span class="co"># gather treats column names as characters by default</span></span>
<span id="cb72-6"><a href="section-2-overview.html#cb72-6" aria-hidden="true"></a><span class="kw">class</span>(tidy_data<span class="op">$</span>year)</span></code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="section-2-overview.html#cb74-1" aria-hidden="true"></a><span class="kw">class</span>(new_tidy_data<span class="op">$</span>year)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="section-2-overview.html#cb76-1" aria-hidden="true"></a><span class="co"># convert gathered column names to numeric</span></span>
<span id="cb76-2"><a href="section-2-overview.html#cb76-2" aria-hidden="true"></a>new_tidy_data &lt;-<span class="st"> </span>wide_data <span class="op">%&gt;%</span></span>
<span id="cb76-3"><a href="section-2-overview.html#cb76-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">gather</span>(year, fertility, <span class="op">-</span>country, <span class="dt">convert =</span> <span class="ot">TRUE</span>)</span>
<span id="cb76-4"><a href="section-2-overview.html#cb76-4" aria-hidden="true"></a><span class="kw">class</span>(new_tidy_data<span class="op">$</span>year)</span></code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="section-2-overview.html#cb78-1" aria-hidden="true"></a><span class="co"># ggplot works on new tidy data</span></span>
<span id="cb78-2"><a href="section-2-overview.html#cb78-2" aria-hidden="true"></a>new_tidy_data <span class="op">%&gt;%</span></span>
<span id="cb78-3"><a href="section-2-overview.html#cb78-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, fertility, <span class="dt">color =</span> country)) <span class="op">+</span></span>
<span id="cb78-4"><a href="section-2-overview.html#cb78-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="section-2-overview.html#cb79-1" aria-hidden="true"></a><span class="co"># spread tidy data to generate wide data</span></span>
<span id="cb79-2"><a href="section-2-overview.html#cb79-2" aria-hidden="true"></a>new_wide_data &lt;-<span class="st"> </span>new_tidy_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">spread</span>(year, fertility)</span>
<span id="cb79-3"><a href="section-2-overview.html#cb79-3" aria-hidden="true"></a><span class="kw">select</span>(new_wide_data, country, <span class="st">`</span><span class="dt">1960</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">1967</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 9
##   country     `1960` `1961` `1962` `1963` `1964` `1965` `1966` `1967`
##   &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 Germany       2.41   2.44   2.47   2.49   2.49   2.48   2.44   2.37
## 2 South Korea   6.16   5.99   5.79   5.57   5.36   5.16   4.99   4.85</code></pre>
</div>
<div id="separate-and-unite" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Separate and Unite</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/reshaping-data.html#separate">here</a> and <a href="https://rafalab.github.io/dsbook/reshaping-data.html#unite">here</a></p>
<p><strong>Key points</strong></p>
<ul>
<li>The <code>separate()</code> function splits one column into two or more columns at a specified character that separates the variables.</li>
<li>When there is an extra separation in some of the entries, use <code>fill="right"</code> to pad missing values with NAs, or use <code>extra="merge"</code> to keep extra elements together.</li>
<li>The <code>unite()</code> function combines two columns and adds a separating character.</li>
</ul>
<p><em>Code</em></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="section-2-overview.html#cb81-1" aria-hidden="true"></a><span class="co"># import data</span></span>
<span id="cb81-2"><a href="section-2-overview.html#cb81-2" aria-hidden="true"></a>path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;dslabs&quot;</span>)</span>
<span id="cb81-3"><a href="section-2-overview.html#cb81-3" aria-hidden="true"></a>filename &lt;-<span class="st"> </span><span class="kw">file.path</span>(path, <span class="st">&quot;life-expectancy-and-fertility-two-countries-example.csv&quot;</span>)</span>
<span id="cb81-4"><a href="section-2-overview.html#cb81-4" aria-hidden="true"></a>raw_dat &lt;-<span class="st"> </span><span class="kw">read_csv</span>(filename)</span></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_double(),
##   country = col_character()
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="section-2-overview.html#cb84-1" aria-hidden="true"></a><span class="kw">select</span>(raw_dat, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 5
##   country     `1960_fertility` `1960_life_expectancy` `1961_fertility` `1961_life_expectancy`
##   &lt;chr&gt;                  &lt;dbl&gt;                  &lt;dbl&gt;            &lt;dbl&gt;                  &lt;dbl&gt;
## 1 Germany                 2.41                   69.3             2.44                   69.8
## 2 South Korea             6.16                   53.0             5.99                   53.8</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="section-2-overview.html#cb86-1" aria-hidden="true"></a><span class="co"># gather all columns except country</span></span>
<span id="cb86-2"><a href="section-2-overview.html#cb86-2" aria-hidden="true"></a>dat &lt;-<span class="st"> </span>raw_dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(key, value, <span class="op">-</span>country)</span>
<span id="cb86-3"><a href="section-2-overview.html#cb86-3" aria-hidden="true"></a><span class="kw">head</span>(dat)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   country     key                  value
##   &lt;chr&gt;       &lt;chr&gt;                &lt;dbl&gt;
## 1 Germany     1960_fertility        2.41
## 2 South Korea 1960_fertility        6.16
## 3 Germany     1960_life_expectancy 69.3 
## 4 South Korea 1960_life_expectancy 53.0 
## 5 Germany     1961_fertility        2.44
## 6 South Korea 1961_fertility        5.99</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="section-2-overview.html#cb88-1" aria-hidden="true"></a>dat<span class="op">$</span>key[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>## [1] &quot;1960_fertility&quot;       &quot;1960_fertility&quot;       &quot;1960_life_expectancy&quot; &quot;1960_life_expectancy&quot; &quot;1961_fertility&quot;</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="section-2-overview.html#cb90-1" aria-hidden="true"></a><span class="co"># separate on underscores</span></span>
<span id="cb90-2"><a href="section-2-overview.html#cb90-2" aria-hidden="true"></a>dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">separate</span>(key, <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;variable_name&quot;</span>), <span class="st">&quot;_&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Expected 2 pieces. Additional pieces discarded in 112 rows [3, 4, 7, 8, 11, 12, 15, 16, 19, 20, 23, 24, 27, 28, 31, 32, 35, 36, 39, 40, ...].</code></pre>
<pre><code>## # A tibble: 224 x 4
##    country     year  variable_name value
##    &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;
##  1 Germany     1960  fertility      2.41
##  2 South Korea 1960  fertility      6.16
##  3 Germany     1960  life          69.3 
##  4 South Korea 1960  life          53.0 
##  5 Germany     1961  fertility      2.44
##  6 South Korea 1961  fertility      5.99
##  7 Germany     1961  life          69.8 
##  8 South Korea 1961  life          53.8 
##  9 Germany     1962  fertility      2.47
## 10 South Korea 1962  fertility      5.79
## # … with 214 more rows</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="section-2-overview.html#cb93-1" aria-hidden="true"></a>dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">separate</span>(key, <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;variable_name&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: Expected 2 pieces. Additional pieces discarded in 112 rows [3, 4, 7, 8, 11, 12, 15, 16, 19, 20, 23, 24, 27, 28, 31, 32, 35, 36, 39, 40, ...].</code></pre>
<pre><code>## # A tibble: 224 x 4
##    country     year  variable_name value
##    &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;
##  1 Germany     1960  fertility      2.41
##  2 South Korea 1960  fertility      6.16
##  3 Germany     1960  life          69.3 
##  4 South Korea 1960  life          53.0 
##  5 Germany     1961  fertility      2.44
##  6 South Korea 1961  fertility      5.99
##  7 Germany     1961  life          69.8 
##  8 South Korea 1961  life          53.8 
##  9 Germany     1962  fertility      2.47
## 10 South Korea 1962  fertility      5.79
## # … with 214 more rows</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="section-2-overview.html#cb96-1" aria-hidden="true"></a><span class="co"># split on all underscores, pad empty cells with NA</span></span>
<span id="cb96-2"><a href="section-2-overview.html#cb96-2" aria-hidden="true"></a>dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">separate</span>(key, <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;first_variable_name&quot;</span>, <span class="st">&quot;second_variable_name&quot;</span>), </span>
<span id="cb96-3"><a href="section-2-overview.html#cb96-3" aria-hidden="true"></a>                 <span class="dt">fill =</span> <span class="st">&quot;right&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 224 x 5
##    country     year  first_variable_name second_variable_name value
##    &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;               &lt;chr&gt;                &lt;dbl&gt;
##  1 Germany     1960  fertility           &lt;NA&gt;                  2.41
##  2 South Korea 1960  fertility           &lt;NA&gt;                  6.16
##  3 Germany     1960  life                expectancy           69.3 
##  4 South Korea 1960  life                expectancy           53.0 
##  5 Germany     1961  fertility           &lt;NA&gt;                  2.44
##  6 South Korea 1961  fertility           &lt;NA&gt;                  5.99
##  7 Germany     1961  life                expectancy           69.8 
##  8 South Korea 1961  life                expectancy           53.8 
##  9 Germany     1962  fertility           &lt;NA&gt;                  2.47
## 10 South Korea 1962  fertility           &lt;NA&gt;                  5.79
## # … with 214 more rows</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="section-2-overview.html#cb98-1" aria-hidden="true"></a><span class="co"># split on first underscore but keep life_expectancy merged</span></span>
<span id="cb98-2"><a href="section-2-overview.html#cb98-2" aria-hidden="true"></a>dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">separate</span>(key, <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;variable_name&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>, <span class="dt">extra =</span> <span class="st">&quot;merge&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 224 x 4
##    country     year  variable_name   value
##    &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;           &lt;dbl&gt;
##  1 Germany     1960  fertility        2.41
##  2 South Korea 1960  fertility        6.16
##  3 Germany     1960  life_expectancy 69.3 
##  4 South Korea 1960  life_expectancy 53.0 
##  5 Germany     1961  fertility        2.44
##  6 South Korea 1961  fertility        5.99
##  7 Germany     1961  life_expectancy 69.8 
##  8 South Korea 1961  life_expectancy 53.8 
##  9 Germany     1962  fertility        2.47
## 10 South Korea 1962  fertility        5.79
## # … with 214 more rows</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="section-2-overview.html#cb100-1" aria-hidden="true"></a><span class="co"># separate then spread</span></span>
<span id="cb100-2"><a href="section-2-overview.html#cb100-2" aria-hidden="true"></a>dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">separate</span>(key, <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;variable_name&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>, <span class="dt">extra =</span> <span class="st">&quot;merge&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb100-3"><a href="section-2-overview.html#cb100-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">spread</span>(variable_name, value) </span></code></pre></div>
<pre><code>## # A tibble: 112 x 4
##    country year  fertility life_expectancy
##    &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt;           &lt;dbl&gt;
##  1 Germany 1960       2.41            69.3
##  2 Germany 1961       2.44            69.8
##  3 Germany 1962       2.47            70.0
##  4 Germany 1963       2.49            70.1
##  5 Germany 1964       2.49            70.7
##  6 Germany 1965       2.48            70.6
##  7 Germany 1966       2.44            70.8
##  8 Germany 1967       2.37            71.0
##  9 Germany 1968       2.28            70.6
## 10 Germany 1969       2.17            70.5
## # … with 102 more rows</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="section-2-overview.html#cb102-1" aria-hidden="true"></a><span class="co"># separate then unite</span></span>
<span id="cb102-2"><a href="section-2-overview.html#cb102-2" aria-hidden="true"></a>dat <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb102-3"><a href="section-2-overview.html#cb102-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">separate</span>(key, <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;first_variable_name&quot;</span>, <span class="st">&quot;second_variable_name&quot;</span>), <span class="dt">fill =</span> <span class="st">&quot;right&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb102-4"><a href="section-2-overview.html#cb102-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">unite</span>(variable_name, first_variable_name, second_variable_name, <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 224 x 4
##    country     year  variable_name   value
##    &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;           &lt;dbl&gt;
##  1 Germany     1960  fertility_NA     2.41
##  2 South Korea 1960  fertility_NA     6.16
##  3 Germany     1960  life_expectancy 69.3 
##  4 South Korea 1960  life_expectancy 53.0 
##  5 Germany     1961  fertility_NA     2.44
##  6 South Korea 1961  fertility_NA     5.99
##  7 Germany     1961  life_expectancy 69.8 
##  8 South Korea 1961  life_expectancy 53.8 
##  9 Germany     1962  fertility_NA     2.47
## 10 South Korea 1962  fertility_NA     5.79
## # … with 214 more rows</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="section-2-overview.html#cb104-1" aria-hidden="true"></a><span class="co"># full code for tidying data</span></span>
<span id="cb104-2"><a href="section-2-overview.html#cb104-2" aria-hidden="true"></a>dat <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb104-3"><a href="section-2-overview.html#cb104-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">separate</span>(key, <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;first_variable_name&quot;</span>, <span class="st">&quot;second_variable_name&quot;</span>), <span class="dt">fill =</span> <span class="st">&quot;right&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb104-4"><a href="section-2-overview.html#cb104-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">unite</span>(variable_name, first_variable_name, second_variable_name, <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb104-5"><a href="section-2-overview.html#cb104-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">spread</span>(variable_name, value) <span class="op">%&gt;%</span></span>
<span id="cb104-6"><a href="section-2-overview.html#cb104-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">fertility =</span> fertility_NA)</span></code></pre></div>
<pre><code>## # A tibble: 112 x 4
##    country year  fertility life_expectancy
##    &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt;           &lt;dbl&gt;
##  1 Germany 1960       2.41            69.3
##  2 Germany 1961       2.44            69.8
##  3 Germany 1962       2.47            70.0
##  4 Germany 1963       2.49            70.1
##  5 Germany 1964       2.49            70.7
##  6 Germany 1965       2.48            70.6
##  7 Germany 1966       2.44            70.8
##  8 Germany 1967       2.37            71.0
##  9 Germany 1968       2.28            70.6
## 10 Germany 1969       2.17            70.5
## # … with 102 more rows</code></pre>
</div>
<div id="assessment-part-1---reshaping-data" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Assessment Part 1 - Reshaping Data</h2>
<ol style="list-style-type: decimal">
<li>A collaborator sends you a file containing data for three years of average race finish times.</li>
</ol>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="section-2-overview.html#cb106-1" aria-hidden="true"></a>age_group,<span class="dv">2015</span>,<span class="dv">2016</span>,<span class="dv">2017</span></span>
<span id="cb106-2"><a href="section-2-overview.html#cb106-2" aria-hidden="true"></a><span class="dv">20</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">46</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">22</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">50</span></span>
<span id="cb106-3"><a href="section-2-overview.html#cb106-3" aria-hidden="true"></a><span class="dv">30</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">50</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">43</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">43</span></span>
<span id="cb106-4"><a href="section-2-overview.html#cb106-4" aria-hidden="true"></a><span class="dv">40</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">39</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">49</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">51</span></span>
<span id="cb106-5"><a href="section-2-overview.html#cb106-5" aria-hidden="true"></a><span class="dv">50</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">48</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">59</span>,<span class="dv">5</span><span class="op">:</span><span class="dv">01</span></span></code></pre></div>
<p>Are these data considered “tidy” in R? Why or why not?</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A. Yes. These data are considered “tidy” because each row contains unique observations.</li>
<li><input type="checkbox" disabled="" />
B. Yes. These data are considered “tidy” because there are no missing data in the data frame.</li>
<li><input type="checkbox" disabled="" checked="" />
C. No. These data are not considered “tidy” because the variable “year” is stored in the header.</li>
<li><input type="checkbox" disabled="" />
D. No. These data are not considered “tidy” because there are not an equal number of columns and rows.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Below are four versions of the same dataset. Which one is in a tidy format?</li>
</ol>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="" />
A.</li>
</ul>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="section-2-overview.html#cb107-1" aria-hidden="true"></a>state      abb   region  population total</span>
<span id="cb107-2"><a href="section-2-overview.html#cb107-2" aria-hidden="true"></a>Alabama    AL    South   <span class="dv">4779736</span>    <span class="dv">135</span></span>
<span id="cb107-3"><a href="section-2-overview.html#cb107-3" aria-hidden="true"></a>Alaska     AK    West    <span class="dv">710231</span>     <span class="dv">19</span></span>
<span id="cb107-4"><a href="section-2-overview.html#cb107-4" aria-hidden="true"></a>Arizona    AZ    West    <span class="dv">6392017</span>    <span class="dv">232</span></span>
<span id="cb107-5"><a href="section-2-overview.html#cb107-5" aria-hidden="true"></a>Arkansas   AR    South   <span class="dv">2915918</span>    <span class="dv">93</span></span>
<span id="cb107-6"><a href="section-2-overview.html#cb107-6" aria-hidden="true"></a>California CA    West    <span class="dv">37253956</span>   <span class="dv">1257</span></span>
<span id="cb107-7"><a href="section-2-overview.html#cb107-7" aria-hidden="true"></a>Colorado   CO    West    <span class="dv">5029196</span>    <span class="dv">65</span></span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
B.</li>
</ul>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="section-2-overview.html#cb108-1" aria-hidden="true"></a>state    abb  region        var        people</span>
<span id="cb108-2"><a href="section-2-overview.html#cb108-2" aria-hidden="true"></a>Alabama  AL   South         population <span class="dv">4779736</span></span>
<span id="cb108-3"><a href="section-2-overview.html#cb108-3" aria-hidden="true"></a>Alabama  AL   South         total      <span class="dv">135</span></span>
<span id="cb108-4"><a href="section-2-overview.html#cb108-4" aria-hidden="true"></a>Alaska   AK   West          population <span class="dv">710231</span></span>
<span id="cb108-5"><a href="section-2-overview.html#cb108-5" aria-hidden="true"></a>Alaska   AK   West          total      <span class="dv">19</span></span>
<span id="cb108-6"><a href="section-2-overview.html#cb108-6" aria-hidden="true"></a>Arizona  AZ   West          population <span class="dv">6392017</span></span>
<span id="cb108-7"><a href="section-2-overview.html#cb108-7" aria-hidden="true"></a>Arizona  AZ   West          total      <span class="dv">232</span></span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
C.</li>
</ul>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="section-2-overview.html#cb109-1" aria-hidden="true"></a>state       abb       Northeast   South      North Central   West</span>
<span id="cb109-2"><a href="section-2-overview.html#cb109-2" aria-hidden="true"></a>Alabama     AL        <span class="ot">NA</span>          <span class="dv">4779736</span>    <span class="ot">NA</span>              <span class="ot">NA</span></span>
<span id="cb109-3"><a href="section-2-overview.html#cb109-3" aria-hidden="true"></a>Alaska      AK        <span class="ot">NA</span>          <span class="ot">NA</span>         <span class="ot">NA</span>              <span class="dv">710231</span></span>
<span id="cb109-4"><a href="section-2-overview.html#cb109-4" aria-hidden="true"></a>Arizona     AZ        <span class="ot">NA</span>          <span class="ot">NA</span>         <span class="ot">NA</span>              <span class="dv">6392017</span></span>
<span id="cb109-5"><a href="section-2-overview.html#cb109-5" aria-hidden="true"></a>Arkansas    AR        <span class="ot">NA</span>          <span class="dv">2915918</span>    <span class="ot">NA</span>              <span class="ot">NA</span></span>
<span id="cb109-6"><a href="section-2-overview.html#cb109-6" aria-hidden="true"></a>California  CA        <span class="ot">NA</span>          <span class="ot">NA</span>         <span class="ot">NA</span>              <span class="dv">37253956</span></span>
<span id="cb109-7"><a href="section-2-overview.html#cb109-7" aria-hidden="true"></a>Colorado    CO        <span class="ot">NA</span>          <span class="ot">NA</span>         <span class="ot">NA</span>              <span class="dv">5029196</span></span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
D.</li>
</ul>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="section-2-overview.html#cb110-1" aria-hidden="true"></a>state       abb  region    rate</span>
<span id="cb110-2"><a href="section-2-overview.html#cb110-2" aria-hidden="true"></a>Alabama     AL   South     <span class="fl">2.82e-05</span></span>
<span id="cb110-3"><a href="section-2-overview.html#cb110-3" aria-hidden="true"></a>Alaska      AK   West      <span class="fl">2.68e-05</span></span>
<span id="cb110-4"><a href="section-2-overview.html#cb110-4" aria-hidden="true"></a>Arizona     AZ   West      <span class="fl">3.63e-05</span></span>
<span id="cb110-5"><a href="section-2-overview.html#cb110-5" aria-hidden="true"></a>Arkansas    AR   South     <span class="fl">3.19e-05</span></span>
<span id="cb110-6"><a href="section-2-overview.html#cb110-6" aria-hidden="true"></a>California  CA   West      <span class="fl">3.37e-05</span></span>
<span id="cb110-7"><a href="section-2-overview.html#cb110-7" aria-hidden="true"></a>Colorado    CO   West      <span class="fl">1.29e-05</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Your file called “times.csv” has age groups and average race finish times for three years of marathons.</li>
</ol>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="section-2-overview.html#cb111-1" aria-hidden="true"></a>age_group,<span class="dv">2015</span>,<span class="dv">2016</span>,<span class="dv">2017</span></span>
<span id="cb111-2"><a href="section-2-overview.html#cb111-2" aria-hidden="true"></a><span class="dv">20</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">46</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">22</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">50</span></span>
<span id="cb111-3"><a href="section-2-overview.html#cb111-3" aria-hidden="true"></a><span class="dv">30</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">50</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">43</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">43</span></span>
<span id="cb111-4"><a href="section-2-overview.html#cb111-4" aria-hidden="true"></a><span class="dv">40</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">39</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">49</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">51</span></span>
<span id="cb111-5"><a href="section-2-overview.html#cb111-5" aria-hidden="true"></a><span class="dv">50</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">48</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">59</span>,<span class="dv">5</span><span class="op">:</span><span class="dv">01</span></span></code></pre></div>
<p>You read in the data file using the following command.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="section-2-overview.html#cb112-1" aria-hidden="true"></a>d &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;files/times.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   age_group = col_double(),
##   `2015` = col_time(format = &quot;&quot;),
##   `2016` = col_time(format = &quot;&quot;),
##   `2017` = col_time(format = &quot;&quot;)
## )</code></pre>
<p>Which commands will help you “tidy” the data?</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="section-2-overview.html#cb114-1" aria-hidden="true"></a>tidy_data &lt;-<span class="st"> </span>d <span class="op">%&gt;%</span></span>
<span id="cb114-2"><a href="section-2-overview.html#cb114-2" aria-hidden="true"></a><span class="kw">gather</span>(year, time, <span class="st">`</span><span class="dt">2015</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">2017</span><span class="st">`</span>)</span>
<span id="cb114-3"><a href="section-2-overview.html#cb114-3" aria-hidden="true"></a>tidy_data</span></code></pre></div>
<pre><code>## # A tibble: 12 x 3
##    age_group year  time  
##        &lt;dbl&gt; &lt;chr&gt; &lt;time&gt;
##  1        20 2015  03:46 
##  2        30 2015  03:50 
##  3        40 2015  04:39 
##  4        50 2015  04:48 
##  5        20 2016  03:22 
##  6        30 2016  03:43 
##  7        40 2016  03:49 
##  8        50 2016  04:59 
##  9        20 2017  03:50 
## 10        30 2017  04:43 
## 11        40 2017  04:51 
## 12        50 2017  05:01</code></pre>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="" />
A.</li>
</ul>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="section-2-overview.html#cb116-1" aria-hidden="true"></a>tidy_data &lt;-<span class="st"> </span>d <span class="op">%&gt;%</span></span>
<span id="cb116-2"><a href="section-2-overview.html#cb116-2" aria-hidden="true"></a><span class="kw">gather</span>(year, time, <span class="st">`</span><span class="dt">2015</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">2017</span><span class="st">`</span>)</span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
B.</li>
</ul>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="section-2-overview.html#cb117-1" aria-hidden="true"></a>tidy_data &lt;-<span class="st"> </span>d <span class="op">%&gt;%</span></span>
<span id="cb117-2"><a href="section-2-overview.html#cb117-2" aria-hidden="true"></a><span class="kw">spread</span>(year, time, <span class="st">`</span><span class="dt">2015</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">2017</span><span class="st">`</span>)</span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
C.</li>
</ul>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="section-2-overview.html#cb118-1" aria-hidden="true"></a>tidy_data &lt;-<span class="st"> </span>d <span class="op">%&gt;%</span></span>
<span id="cb118-2"><a href="section-2-overview.html#cb118-2" aria-hidden="true"></a><span class="kw">gather</span>(age_group, year, time, <span class="st">`</span><span class="dt">2015</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">2017</span><span class="st">`</span>)</span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
D.</li>
</ul>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="section-2-overview.html#cb119-1" aria-hidden="true"></a>tidy_data &lt;-<span class="st"> </span>d <span class="op">%&gt;%</span></span>
<span id="cb119-2"><a href="section-2-overview.html#cb119-2" aria-hidden="true"></a><span class="kw">gather</span>(time, <span class="st">`</span><span class="dt">2015</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">2017</span><span class="st">`</span>)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>You have a dataset on U.S. contagious diseases, but it is in the following wide format:</li>
</ol>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="section-2-overview.html#cb120-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(dat_wide)</span>
<span id="cb120-2"><a href="section-2-overview.html#cb120-2" aria-hidden="true"></a>state   year    population      Hepatitis A Mumps Polio Rubella</span>
<span id="cb120-3"><a href="section-2-overview.html#cb120-3" aria-hidden="true"></a>Alabama <span class="dv">1990</span>    <span class="dv">4040587</span>         <span class="dv">86</span>          <span class="dv">19</span>    <span class="dv">76</span>    <span class="dv">1</span></span>
<span id="cb120-4"><a href="section-2-overview.html#cb120-4" aria-hidden="true"></a>Alabama <span class="dv">1991</span>    <span class="dv">4066003</span>         <span class="dv">39</span>          <span class="dv">14</span>    <span class="dv">65</span>    <span class="dv">0</span></span>
<span id="cb120-5"><a href="section-2-overview.html#cb120-5" aria-hidden="true"></a>Alabama <span class="dv">1992</span>    <span class="dv">4097169</span>         <span class="dv">35</span>          <span class="dv">12</span>    <span class="dv">24</span>    <span class="dv">0</span></span>
<span id="cb120-6"><a href="section-2-overview.html#cb120-6" aria-hidden="true"></a>Alabama <span class="dv">1993</span>    <span class="dv">4133242</span>         <span class="dv">40</span>          <span class="dv">22</span>    <span class="dv">67</span>    <span class="dv">0</span></span>
<span id="cb120-7"><a href="section-2-overview.html#cb120-7" aria-hidden="true"></a>Alabama <span class="dv">1994</span>    <span class="dv">4173361</span>         <span class="dv">72</span>          <span class="dv">12</span>    <span class="dv">39</span>    <span class="dv">0</span></span>
<span id="cb120-8"><a href="section-2-overview.html#cb120-8" aria-hidden="true"></a>Alabama <span class="dv">1995</span>    <span class="dv">4216645</span>         <span class="dv">75</span>          <span class="dv">2</span>     <span class="dv">38</span>    <span class="dv">0</span></span></code></pre></div>
<p>Which of the following would transform this into a tidy dataset, with each row representing an observation of the incidence of each specific disease (as shown below)?</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="section-2-overview.html#cb121-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(dat_tidy)</span>
<span id="cb121-2"><a href="section-2-overview.html#cb121-2" aria-hidden="true"></a>state   year    population   disease      count</span>
<span id="cb121-3"><a href="section-2-overview.html#cb121-3" aria-hidden="true"></a>Alabama <span class="dv">1990</span>    <span class="dv">4040587</span>      Hepatitis A  <span class="dv">86</span></span>
<span id="cb121-4"><a href="section-2-overview.html#cb121-4" aria-hidden="true"></a>Alabama <span class="dv">1991</span>    <span class="dv">4066003</span>      Hepatitis A  <span class="dv">39</span></span>
<span id="cb121-5"><a href="section-2-overview.html#cb121-5" aria-hidden="true"></a>Alabama <span class="dv">1992</span>    <span class="dv">4097169</span>      Hepatitis A  <span class="dv">35</span></span>
<span id="cb121-6"><a href="section-2-overview.html#cb121-6" aria-hidden="true"></a>Alabama <span class="dv">1993</span>    <span class="dv">4133242</span>      Hepatitis A  <span class="dv">40</span></span>
<span id="cb121-7"><a href="section-2-overview.html#cb121-7" aria-hidden="true"></a>Alabama <span class="dv">1994</span>    <span class="dv">4173361</span>      Hepatitis A  <span class="dv">72</span></span>
<span id="cb121-8"><a href="section-2-overview.html#cb121-8" aria-hidden="true"></a>Alabama <span class="dv">1995</span>    <span class="dv">4216645</span>      Hepatitis A  <span class="dv">75</span></span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A.</li>
</ul>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="section-2-overview.html#cb122-1" aria-hidden="true"></a>dat_tidy &lt;-<span class="st"> </span>dat_wide <span class="op">%&gt;%</span></span>
<span id="cb122-2"><a href="section-2-overview.html#cb122-2" aria-hidden="true"></a><span class="kw">gather</span> (<span class="dt">key =</span> count, <span class="dt">value =</span> disease, <span class="st">`</span><span class="dt">Hepatitis A</span><span class="st">`</span>, <span class="st">`</span><span class="dt">Rubella</span><span class="st">`</span>)</span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
B.</li>
</ul>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="section-2-overview.html#cb123-1" aria-hidden="true"></a>dat_tidy &lt;-<span class="st"> </span>dat_wide <span class="op">%&gt;%</span></span>
<span id="cb123-2"><a href="section-2-overview.html#cb123-2" aria-hidden="true"></a><span class="kw">gather</span>(<span class="dt">key =</span> count, <span class="dt">value =</span> disease, <span class="op">-</span>state, <span class="op">-</span>year, <span class="op">-</span>population)</span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
C.</li>
</ul>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="section-2-overview.html#cb124-1" aria-hidden="true"></a>dat_tidy &lt;-<span class="st"> </span>dat_wide <span class="op">%&gt;%</span></span>
<span id="cb124-2"><a href="section-2-overview.html#cb124-2" aria-hidden="true"></a><span class="kw">gather</span>(<span class="dt">key =</span> disease, <span class="dt">value =</span> count, <span class="op">-</span>state)</span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="" />
D.</li>
</ul>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="section-2-overview.html#cb125-1" aria-hidden="true"></a>dat_tidy &lt;-<span class="st"> </span>dat_wide <span class="op">%&gt;%</span></span>
<span id="cb125-2"><a href="section-2-overview.html#cb125-2" aria-hidden="true"></a><span class="kw">gather</span>(<span class="dt">key =</span> disease, <span class="dt">value =</span> count, “Hepatitis A”<span class="op">:</span><span class="st"> </span>“Rubella”)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>You have successfully formatted marathon finish times into a tidy object called <code>tidy_data</code>. The first few lines are shown below.</li>
</ol>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="section-2-overview.html#cb126-1" aria-hidden="true"></a>age_group year  time</span>
<span id="cb126-2"><a href="section-2-overview.html#cb126-2" aria-hidden="true"></a><span class="dv">20</span>        <span class="dv">2015</span>  <span class="dv">03</span><span class="op">:</span><span class="dv">46</span></span>
<span id="cb126-3"><a href="section-2-overview.html#cb126-3" aria-hidden="true"></a><span class="dv">30</span>        <span class="dv">2015</span>  <span class="dv">03</span><span class="op">:</span><span class="dv">50</span></span>
<span id="cb126-4"><a href="section-2-overview.html#cb126-4" aria-hidden="true"></a><span class="dv">40</span>        <span class="dv">2015</span>  <span class="dv">04</span><span class="op">:</span><span class="dv">39</span></span>
<span id="cb126-5"><a href="section-2-overview.html#cb126-5" aria-hidden="true"></a><span class="dv">50</span>        <span class="dv">2015</span>  <span class="dv">04</span><span class="op">:</span><span class="dv">48</span></span>
<span id="cb126-6"><a href="section-2-overview.html#cb126-6" aria-hidden="true"></a><span class="dv">20</span>        <span class="dv">2016</span>  <span class="dv">03</span><span class="op">:</span><span class="dv">22</span></span></code></pre></div>
<p>Select the code that converts these data back to the wide format, where each year has a separate column.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="section-2-overview.html#cb127-1" aria-hidden="true"></a>tidy_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">spread</span>(year, time)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 4
##   age_group `2015` `2016` `2017`
##       &lt;dbl&gt; &lt;time&gt; &lt;time&gt; &lt;time&gt;
## 1        20 03:46  03:22  03:50 
## 2        30 03:50  03:43  04:43 
## 3        40 04:39  03:49  04:51 
## 4        50 04:48  04:59  05:01</code></pre>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A. <code>tidy_data %&gt;% spread(time, year)</code></li>
<li><input type="checkbox" disabled="" checked="" />
B. <code>tidy_data %&gt;% spread(year, time)</code></li>
<li><input type="checkbox" disabled="" />
C. <code>tidy_data %&gt;% spread(year, age_group)</code></li>
<li><input type="checkbox" disabled="" />
D. <code>tidy_data %&gt;% spread(time, year, `2015`:`2017`)</code></li>
</ul>
<ol start="6" style="list-style-type: decimal">
<li>You have the following dataset:</li>
</ol>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="section-2-overview.html#cb129-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(dat)</span>
<span id="cb129-2"><a href="section-2-overview.html#cb129-2" aria-hidden="true"></a>state    abb  region        var         people</span>
<span id="cb129-3"><a href="section-2-overview.html#cb129-3" aria-hidden="true"></a>Alabama  AL   South         population  <span class="dv">4779736</span></span>
<span id="cb129-4"><a href="section-2-overview.html#cb129-4" aria-hidden="true"></a>Alabama  AL   South         total       <span class="dv">135</span></span>
<span id="cb129-5"><a href="section-2-overview.html#cb129-5" aria-hidden="true"></a>Alaska   AK   West          population  <span class="dv">710231</span></span>
<span id="cb129-6"><a href="section-2-overview.html#cb129-6" aria-hidden="true"></a>Alaska   AK   West          total       <span class="dv">19</span></span>
<span id="cb129-7"><a href="section-2-overview.html#cb129-7" aria-hidden="true"></a>Arizona  AZ   West          population  <span class="dv">6392017</span></span>
<span id="cb129-8"><a href="section-2-overview.html#cb129-8" aria-hidden="true"></a>Arizona  AZ   West          total       <span class="dv">232</span></span></code></pre></div>
<p>You would like to transform it into a dataset where population and total are each their own column (shown below). Which code would best accomplish this?</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="section-2-overview.html#cb130-1" aria-hidden="true"></a>state       abb  region  population total</span>
<span id="cb130-2"><a href="section-2-overview.html#cb130-2" aria-hidden="true"></a>Alabama     AL   South   <span class="dv">4779736</span>    <span class="dv">135</span></span>
<span id="cb130-3"><a href="section-2-overview.html#cb130-3" aria-hidden="true"></a>Alaska      AK   West    <span class="dv">710231</span>     <span class="dv">19</span></span>
<span id="cb130-4"><a href="section-2-overview.html#cb130-4" aria-hidden="true"></a>Arizona     AZ   West    <span class="dv">6392017</span>    <span class="dv">232</span></span>
<span id="cb130-5"><a href="section-2-overview.html#cb130-5" aria-hidden="true"></a>Arkansas    AR   South   <span class="dv">2915918</span>    <span class="dv">93</span></span>
<span id="cb130-6"><a href="section-2-overview.html#cb130-6" aria-hidden="true"></a>California  CA   West    <span class="dv">37253956</span>   <span class="dv">1257</span></span>
<span id="cb130-7"><a href="section-2-overview.html#cb130-7" aria-hidden="true"></a>Colorado    CO   West    <span class="dv">5029196</span>    <span class="dv">65</span></span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="" />
A. <code>dat_tidy &lt;- dat %&gt;% spread(key = var, value = people)</code></li>
<li><input type="checkbox" disabled="" />
B. <code>dat_tidy &lt;- dat %&gt;% spread(key = state:region, value = people)</code></li>
<li><input type="checkbox" disabled="" />
C. <code>dat_tidy &lt;- dat %&gt;% spread(key = people, value = var)</code></li>
<li><input type="checkbox" disabled="" />
D. <code>dat_tidy &lt;- dat %&gt;% spread(key = region, value = people)</code></li>
</ul>
<ol start="7" style="list-style-type: decimal">
<li>A collaborator sends you a file containing data for two years of average race finish times, “times2.csv”:.</li>
</ol>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="section-2-overview.html#cb131-1" aria-hidden="true"></a>age_group,<span class="dv">2015</span>_time,<span class="dv">2015</span>_participants,<span class="dv">2016</span>_time,<span class="dv">2016</span>_participants</span>
<span id="cb131-2"><a href="section-2-overview.html#cb131-2" aria-hidden="true"></a><span class="dv">20</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">46</span>,<span class="dv">54</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">22</span>,<span class="dv">62</span></span>
<span id="cb131-3"><a href="section-2-overview.html#cb131-3" aria-hidden="true"></a><span class="dv">30</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">43</span>,<span class="dv">58</span></span>
<span id="cb131-4"><a href="section-2-overview.html#cb131-4" aria-hidden="true"></a><span class="dv">40</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">39</span>,<span class="dv">29</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">49</span>,<span class="dv">33</span></span>
<span id="cb131-5"><a href="section-2-overview.html#cb131-5" aria-hidden="true"></a><span class="dv">50</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">48</span>,<span class="dv">10</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">59</span>,<span class="dv">14</span></span></code></pre></div>
<p>You read in the data file</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="section-2-overview.html#cb132-1" aria-hidden="true"></a>d &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;files/times2.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   age_group = col_double(),
##   `2015_time` = col_time(format = &quot;&quot;),
##   `2015_participants` = col_double(),
##   `2016_time` = col_time(format = &quot;&quot;),
##   `2016_participants` = col_double()
## )</code></pre>
<p>Which of the answers below best tidys the data?</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="section-2-overview.html#cb134-1" aria-hidden="true"></a>tidy_data &lt;-<span class="st"> </span>d <span class="op">%&gt;%</span></span>
<span id="cb134-2"><a href="section-2-overview.html#cb134-2" aria-hidden="true"></a><span class="st">        </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;key&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;value&quot;</span>, <span class="op">-</span>age_group) <span class="op">%&gt;%</span></span>
<span id="cb134-3"><a href="section-2-overview.html#cb134-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">separate</span>(<span class="dt">col =</span> key, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;variable_name&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb134-4"><a href="section-2-overview.html#cb134-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">spread</span>(<span class="dt">key =</span> variable_name, <span class="dt">value =</span> value)</span></code></pre></div>
<pre><code>## Warning: attributes are not identical across measure variables;
## they will be dropped</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="section-2-overview.html#cb136-1" aria-hidden="true"></a>tidy_data</span></code></pre></div>
<pre><code>## # A tibble: 8 x 4
##   age_group year  participants  time
##       &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;
## 1        20 2015            54 13560
## 2        20 2016            62 12120
## 3        30 2015            60 13800
## 4        30 2016            58 13380
## 5        40 2015            29 16740
## 6        40 2016            33 13740
## 7        50 2015            10 17280
## 8        50 2016            14 17940</code></pre>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A.</li>
</ul>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="section-2-overview.html#cb138-1" aria-hidden="true"></a>tidy_data &lt;-<span class="st"> </span>d <span class="op">%&gt;%</span></span>
<span id="cb138-2"><a href="section-2-overview.html#cb138-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">gather</span>(<span class="dt">key =</span> “key”, <span class="dt">value =</span> “value”, <span class="op">-</span>age_group) <span class="op">%&gt;%</span></span>
<span id="cb138-3"><a href="section-2-overview.html#cb138-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">separate</span>(<span class="dt">col =</span> key, <span class="dt">into =</span> <span class="kw">c</span>(“year”, “variable_name”), <span class="dt">sep =</span> “.”) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb138-4"><a href="section-2-overview.html#cb138-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">spread</span>(<span class="dt">key =</span> variable_name, <span class="dt">value =</span> value)</span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="" />
B.</li>
</ul>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="section-2-overview.html#cb139-1" aria-hidden="true"></a>tidy_data &lt;-<span class="st"> </span>d <span class="op">%&gt;%</span></span>
<span id="cb139-2"><a href="section-2-overview.html#cb139-2" aria-hidden="true"></a><span class="st">        </span><span class="kw">gather</span>(<span class="dt">key =</span> “key”, <span class="dt">value =</span> “value”, <span class="op">-</span>age_group) <span class="op">%&gt;%</span></span>
<span id="cb139-3"><a href="section-2-overview.html#cb139-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">separate</span>(<span class="dt">col =</span> key, <span class="dt">into =</span> <span class="kw">c</span>(“year”, “variable_name”), <span class="dt">sep =</span> “_”) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb139-4"><a href="section-2-overview.html#cb139-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">spread</span>(<span class="dt">key =</span> variable_name, <span class="dt">value =</span> value)</span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
C.</li>
</ul>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="section-2-overview.html#cb140-1" aria-hidden="true"></a> tidy_data &lt;-<span class="st"> </span>d <span class="op">%&gt;%</span></span>
<span id="cb140-2"><a href="section-2-overview.html#cb140-2" aria-hidden="true"></a><span class="st">        </span><span class="kw">gather</span>(<span class="dt">key =</span> “key”, <span class="dt">value =</span> “value”) <span class="op">%&gt;%</span></span>
<span id="cb140-3"><a href="section-2-overview.html#cb140-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">separate</span>(<span class="dt">col =</span> key, <span class="dt">into =</span> <span class="kw">c</span>(“year”, “variable_name”), <span class="dt">sep =</span> “_”) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb140-4"><a href="section-2-overview.html#cb140-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">spread</span>(<span class="dt">key =</span> variable_name, <span class="dt">value =</span> value)</span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
D.</li>
</ul>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="section-2-overview.html#cb141-1" aria-hidden="true"></a>tidy_data &lt;-<span class="st"> </span>d <span class="op">%&gt;%</span></span>
<span id="cb141-2"><a href="section-2-overview.html#cb141-2" aria-hidden="true"></a><span class="st">        </span><span class="kw">gather</span>(<span class="dt">key =</span> “key”, <span class="dt">value =</span> “value”, <span class="op">-</span>age_group) <span class="op">%&gt;%</span></span>
<span id="cb141-3"><a href="section-2-overview.html#cb141-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">separate</span>(<span class="dt">col =</span> key, <span class="dt">into =</span> “year”, <span class="dt">sep =</span> “_”) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb141-4"><a href="section-2-overview.html#cb141-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">spread</span>(<span class="dt">key =</span> year, <span class="dt">value =</span> value)</span></code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li>You are in the process of tidying some data on heights, hand length, and wingspan for basketball players in the draft. Currently, you have the following:</li>
</ol>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="section-2-overview.html#cb142-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(stats)</span>
<span id="cb142-2"><a href="section-2-overview.html#cb142-2" aria-hidden="true"></a>key                 value</span>
<span id="cb142-3"><a href="section-2-overview.html#cb142-3" aria-hidden="true"></a>allen_height        <span class="dv">75</span></span>
<span id="cb142-4"><a href="section-2-overview.html#cb142-4" aria-hidden="true"></a>allen_hand_length   <span class="fl">8.25</span></span>
<span id="cb142-5"><a href="section-2-overview.html#cb142-5" aria-hidden="true"></a>allen_wingspan      <span class="fl">79.25</span></span>
<span id="cb142-6"><a href="section-2-overview.html#cb142-6" aria-hidden="true"></a>bamba_height        <span class="fl">83.25</span></span>
<span id="cb142-7"><a href="section-2-overview.html#cb142-7" aria-hidden="true"></a>bamba_hand_length   <span class="fl">9.75</span></span>
<span id="cb142-8"><a href="section-2-overview.html#cb142-8" aria-hidden="true"></a>bamba_wingspan      <span class="dv">94</span></span></code></pre></div>
<p>Select all of the correct commands below that would turn this data into a “tidy” format.</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="" />
A.</li>
</ul>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="section-2-overview.html#cb143-1" aria-hidden="true"></a>tidy_data &lt;-<span class="st"> </span>stats <span class="op">%&gt;%</span></span>
<span id="cb143-2"><a href="section-2-overview.html#cb143-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">separate</span>(<span class="dt">col =</span> key, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;player&quot;</span>, <span class="st">&quot;variable_name&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>, <span class="dt">extra =</span> <span class="st">&quot;merge&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb143-3"><a href="section-2-overview.html#cb143-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">spread</span>(<span class="dt">key =</span> variable_name, <span class="dt">value =</span> value) </span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
B.</li>
</ul>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="section-2-overview.html#cb144-1" aria-hidden="true"></a>tidy_data &lt;-<span class="st"> </span>stats <span class="op">%&gt;%</span></span>
<span id="cb144-2"><a href="section-2-overview.html#cb144-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">separate</span>(<span class="dt">col =</span> key, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;player&quot;</span>, <span class="st">&quot;variable_name1&quot;</span>, <span class="st">&quot;variable_name2&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;right&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb144-3"><a href="section-2-overview.html#cb144-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">unite</span>(<span class="dt">col =</span> variable_name, variable_name1, variable_name2, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb144-4"><a href="section-2-overview.html#cb144-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">spread</span>(<span class="dt">key =</span> variable_name, <span class="dt">value =</span> value)</span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
C.</li>
</ul>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="section-2-overview.html#cb145-1" aria-hidden="true"></a>tidy_data &lt;-<span class="st"> </span>stats <span class="op">%&gt;%</span></span>
<span id="cb145-2"><a href="section-2-overview.html#cb145-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">separate</span>(<span class="dt">col =</span> key, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;player&quot;</span>, <span class="st">&quot;variable_name&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb145-3"><a href="section-2-overview.html#cb145-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">spread</span>(<span class="dt">key =</span> variable_name, <span class="dt">value =</span> value)</span></code></pre></div>
</div>
<div id="assessment-part-2---reshaping-data" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Assessment Part 2 - Reshaping Data</h2>
<ol start="9" style="list-style-type: decimal">
<li>Examine the built-in dataset <code>co2</code>. This dataset comes with base R, not <strong>dslabs</strong> - just type <code>co2</code> to access the dataset.</li>
</ol>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="section-2-overview.html#cb146-1" aria-hidden="true"></a>co2</span></code></pre></div>
<pre><code>##         Jan    Feb    Mar    Apr    May    Jun    Jul    Aug    Sep    Oct    Nov    Dec
## 1959 315.42 316.31 316.50 317.56 318.13 318.00 316.39 314.65 313.68 313.18 314.66 315.43
## 1960 316.27 316.81 317.42 318.87 319.87 319.43 318.01 315.74 314.00 313.68 314.84 316.03
## 1961 316.73 317.54 318.38 319.31 320.42 319.61 318.42 316.63 314.83 315.16 315.94 316.85
## 1962 317.78 318.40 319.53 320.42 320.85 320.45 319.45 317.25 316.11 315.27 316.53 317.53
## 1963 318.58 318.92 319.70 321.22 322.08 321.31 319.58 317.61 316.05 315.83 316.91 318.20
## 1964 319.41 320.07 320.74 321.40 322.06 321.73 320.27 318.54 316.54 316.71 317.53 318.55
## 1965 319.27 320.28 320.73 321.97 322.00 321.71 321.05 318.71 317.66 317.14 318.70 319.25
## 1966 320.46 321.43 322.23 323.54 323.91 323.59 322.24 320.20 318.48 317.94 319.63 320.87
## 1967 322.17 322.34 322.88 324.25 324.83 323.93 322.38 320.76 319.10 319.24 320.56 321.80
## 1968 322.40 322.99 323.73 324.86 325.40 325.20 323.98 321.95 320.18 320.09 321.16 322.74
## 1969 323.83 324.26 325.47 326.50 327.21 326.54 325.72 323.50 322.22 321.62 322.69 323.95
## 1970 324.89 325.82 326.77 327.97 327.91 327.50 326.18 324.53 322.93 322.90 323.85 324.96
## 1971 326.01 326.51 327.01 327.62 328.76 328.40 327.20 325.27 323.20 323.40 324.63 325.85
## 1972 326.60 327.47 327.58 329.56 329.90 328.92 327.88 326.16 324.68 325.04 326.34 327.39
## 1973 328.37 329.40 330.14 331.33 332.31 331.90 330.70 329.15 327.35 327.02 327.99 328.48
## 1974 329.18 330.55 331.32 332.48 332.92 332.08 331.01 329.23 327.27 327.21 328.29 329.41
## 1975 330.23 331.25 331.87 333.14 333.80 333.43 331.73 329.90 328.40 328.17 329.32 330.59
## 1976 331.58 332.39 333.33 334.41 334.71 334.17 332.89 330.77 329.14 328.78 330.14 331.52
## 1977 332.75 333.24 334.53 335.90 336.57 336.10 334.76 332.59 331.42 330.98 332.24 333.68
## 1978 334.80 335.22 336.47 337.59 337.84 337.72 336.37 334.51 332.60 332.38 333.75 334.78
## 1979 336.05 336.59 337.79 338.71 339.30 339.12 337.56 335.92 333.75 333.70 335.12 336.56
## 1980 337.84 338.19 339.91 340.60 341.29 341.00 339.39 337.43 335.72 335.84 336.93 338.04
## 1981 339.06 340.30 341.21 342.33 342.74 342.08 340.32 338.26 336.52 336.68 338.19 339.44
## 1982 340.57 341.44 342.53 343.39 343.96 343.18 341.88 339.65 337.81 337.69 339.09 340.32
## 1983 341.20 342.35 342.93 344.77 345.58 345.14 343.81 342.21 339.69 339.82 340.98 342.82
## 1984 343.52 344.33 345.11 346.88 347.25 346.62 345.22 343.11 340.90 341.18 342.80 344.04
## 1985 344.79 345.82 347.25 348.17 348.74 348.07 346.38 344.51 342.92 342.62 344.06 345.38
## 1986 346.11 346.78 347.68 349.37 350.03 349.37 347.76 345.73 344.68 343.99 345.48 346.72
## 1987 347.84 348.29 349.23 350.80 351.66 351.07 349.33 347.92 346.27 346.18 347.64 348.78
## 1988 350.25 351.54 352.05 353.41 354.04 353.62 352.22 350.27 348.55 348.72 349.91 351.18
## 1989 352.60 352.92 353.53 355.26 355.52 354.97 353.75 351.52 349.64 349.83 351.14 352.37
## 1990 353.50 354.55 355.23 356.04 357.00 356.07 354.67 352.76 350.82 351.04 352.69 354.07
## 1991 354.59 355.63 357.03 358.48 359.22 358.12 356.06 353.92 352.05 352.11 353.64 354.89
## 1992 355.88 356.63 357.72 359.07 359.58 359.17 356.94 354.92 352.94 353.23 354.09 355.33
## 1993 356.63 357.10 358.32 359.41 360.23 359.55 357.53 355.48 353.67 353.95 355.30 356.78
## 1994 358.34 358.89 359.95 361.25 361.67 360.94 359.55 357.49 355.84 356.00 357.59 359.05
## 1995 359.98 361.03 361.66 363.48 363.82 363.30 361.94 359.50 358.11 357.80 359.61 360.74
## 1996 362.09 363.29 364.06 364.76 365.45 365.01 363.70 361.54 359.51 359.65 360.80 362.38
## 1997 363.23 364.06 364.61 366.40 366.84 365.68 364.52 362.57 360.24 360.83 362.49 364.34</code></pre>
<p>Is <code>co2</code> tidy? Why or why not?</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A. <code>co2</code> is tidy data: it has one year for each row.</li>
<li><input type="checkbox" disabled="" />
B. <code>co2</code> is tidy data: each column is a different month.</li>
<li><input type="checkbox" disabled="" />
C. <code>co2</code> is not tidy: there are multiple observations per column.</li>
<li><input type="checkbox" disabled="" checked="" />
D. <code>co2</code> is not tidy: to be tidy we would have to wrangle it to have three columns (year, month and value), and then each co2 observation would have a row.</li>
</ul>
<ol start="10" style="list-style-type: decimal">
<li>Run the following command to define the co2_wide object:</li>
</ol>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="section-2-overview.html#cb148-1" aria-hidden="true"></a>co2_wide &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(co2, <span class="dt">ncol =</span> <span class="dv">12</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb148-2"><a href="section-2-overview.html#cb148-2" aria-hidden="true"></a><span class="st">      </span><span class="kw">setNames</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>) <span class="op">%&gt;%</span></span>
<span id="cb148-3"><a href="section-2-overview.html#cb148-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw">as.character</span>(<span class="dv">1959</span><span class="op">:</span><span class="dv">1997</span>))</span></code></pre></div>
<p>Use the <code>gather()</code> function to make this dataset tidy. Call the column with the CO2 measurements <code>co2</code> and call the month column <code>month</code>. Name the resulting object <code>co2_tidy</code>.</p>
<p>Which code would return the correct tidy format?</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="section-2-overview.html#cb149-1" aria-hidden="true"></a>co2_tidy &lt;-<span class="st"> </span><span class="kw">gather</span>(co2_wide,month,co2,<span class="op">-</span>year)</span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A. <code>co2_tidy &lt;- gather(co2_wide,month,co2,year)</code></li>
<li><input type="checkbox" disabled="" />
B. <code>co2_tidy &lt;- gather(co2_wide,co2,month,-year)</code></li>
<li><input type="checkbox" disabled="" />
C. <code>co2_tidy &lt;- gather(co2_wide,co2,month,year)</code></li>
<li><input type="checkbox" disabled="" checked="" />
D. <code>co2_tidy &lt;- gather(co2_wide,month,co2,-year)</code></li>
</ul>
<ol start="11" style="list-style-type: decimal">
<li>Use <code>co2_tidy</code> to plot CO2 versus month with a different curve for each year:</li>
</ol>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="section-2-overview.html#cb150-1" aria-hidden="true"></a>co2_tidy <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="kw">as.numeric</span>(month), co2, <span class="dt">color =</span> year)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<p>What can be concluded from this plot?</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A. CO2 concentrations increased monotonically (never decreased) from 1959 to 1997.</li>
<li><input type="checkbox" disabled="" checked="" />
B. CO2 concentrations are highest around May and the yearly average increased from 1959 to 1997.</li>
<li><input type="checkbox" disabled="" />
C. CO2 concentrations are highest around October and the yearly average increased from 1959 to 1997.</li>
<li><input type="checkbox" disabled="" />
D. Yearly average CO2 concentrations have remained constant over time.</li>
<li><input type="checkbox" disabled="" />
E. CO2 concentrations do not have a seasonal trend.</li>
</ul>
<ol start="12" style="list-style-type: decimal">
<li>Load the <code>admissions</code> dataset from <strong>dslabs</strong>, which contains college admission information for men and women across six majors, and remove the <code>applicants</code> percentage column:</li>
</ol>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="section-2-overview.html#cb151-1" aria-hidden="true"></a><span class="kw">data</span>(admissions)</span>
<span id="cb151-2"><a href="section-2-overview.html#cb151-2" aria-hidden="true"></a>dat &lt;-<span class="st"> </span>admissions <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>applicants)</span></code></pre></div>
<p>Your goal is to get the data in the shape that has one row for each major, like this:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="section-2-overview.html#cb152-1" aria-hidden="true"></a>major  men   women</span>
<span id="cb152-2"><a href="section-2-overview.html#cb152-2" aria-hidden="true"></a>A      <span class="dv">62</span>    <span class="dv">82</span>     </span>
<span id="cb152-3"><a href="section-2-overview.html#cb152-3" aria-hidden="true"></a>B      <span class="dv">63</span>    <span class="dv">68</span>     </span>
<span id="cb152-4"><a href="section-2-overview.html#cb152-4" aria-hidden="true"></a>C      <span class="dv">37</span>    <span class="dv">34</span>     </span>
<span id="cb152-5"><a href="section-2-overview.html#cb152-5" aria-hidden="true"></a>D      <span class="dv">33</span>    <span class="dv">35</span>     </span>
<span id="cb152-6"><a href="section-2-overview.html#cb152-6" aria-hidden="true"></a>E      <span class="dv">28</span>    <span class="dv">24</span>     </span>
<span id="cb152-7"><a href="section-2-overview.html#cb152-7" aria-hidden="true"></a>F       <span class="dv">6</span>     <span class="dv">7</span> </span></code></pre></div>
<p>Which command could help you to wrangle the data into the desired format?</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="section-2-overview.html#cb153-1" aria-hidden="true"></a>dat_tidy &lt;-<span class="st"> </span><span class="kw">spread</span>(dat, gender, admitted)</span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A. <code>dat_tidy &lt;- spread(dat, major, admitted)</code></li>
<li><input type="checkbox" disabled="" />
B. <code>dat_tidy &lt;- spread(dat, gender, major)</code></li>
<li><input type="checkbox" disabled="" checked="" />
C. <code>dat_tidy &lt;- spread(dat, gender, admitted)</code></li>
<li><input type="checkbox" disabled="" />
D. <code>dat_tidy &lt;- spread(dat, admitted, gender)</code></li>
</ul>
<ol start="13" style="list-style-type: decimal">
<li>Now use the <code>admissions</code> dataset to create the object <code>tmp</code>, which has columns <code>major</code>, <code>gender</code>, <code>key</code> and <code>value</code>:</li>
</ol>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="section-2-overview.html#cb154-1" aria-hidden="true"></a>tmp &lt;-<span class="st"> </span><span class="kw">gather</span>(admissions, key, value, admitted<span class="op">:</span>applicants)</span>
<span id="cb154-2"><a href="section-2-overview.html#cb154-2" aria-hidden="true"></a>tmp</span></code></pre></div>
<pre><code>##    major gender        key value
## 1      A    men   admitted    62
## 2      B    men   admitted    63
## 3      C    men   admitted    37
## 4      D    men   admitted    33
## 5      E    men   admitted    28
## 6      F    men   admitted     6
## 7      A  women   admitted    82
## 8      B  women   admitted    68
## 9      C  women   admitted    34
## 10     D  women   admitted    35
## 11     E  women   admitted    24
## 12     F  women   admitted     7
## 13     A    men applicants   825
## 14     B    men applicants   560
## 15     C    men applicants   325
## 16     D    men applicants   417
## 17     E    men applicants   191
## 18     F    men applicants   373
## 19     A  women applicants   108
## 20     B  women applicants    25
## 21     C  women applicants   593
## 22     D  women applicants   375
## 23     E  women applicants   393
## 24     F  women applicants   341</code></pre>
<p>Combine the key and gender and create a new column called <code>column_name</code> to get a variable with the following values: <code>admitted_men</code>, <code>admitted_women</code>, <code>applicants_men</code>and <code>applicants_women</code>. Save the new data as <code>tmp2</code>.</p>
<p>Which command could help you to wrangle the data into the desired format?</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="section-2-overview.html#cb156-1" aria-hidden="true"></a>tmp2 &lt;-<span class="st"> </span><span class="kw">unite</span>(tmp, column_name, <span class="kw">c</span>(key, gender))</span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A. <code>tmp2 &lt;- spread(tmp, column_name, key, gender)</code></li>
<li><input type="checkbox" disabled="" />
B. <code>tmp2 &lt;- gather(tmp, column_name, c(gender,key))</code></li>
<li><input type="checkbox" disabled="" />
C. <code>tmp2 &lt;- unite(tmp, column_name, c(gender, key))</code></li>
<li><input type="checkbox" disabled="" />
D. <code>tmp2 &lt;- spread(tmp, column_name, c(key,gender))</code></li>
<li><input type="checkbox" disabled="" checked="" />
E. <code>tmp2 &lt;- unite(tmp, column_name, c(key, gender))</code></li>
</ul>
<ol start="14" style="list-style-type: decimal">
<li>Which function can reshape <code>tmp2</code> to a table with six rows and five columns named <code>major</code>, <code>admitted_men</code>, <code>admitted_women</code>, <code>applicants_men</code> and <code>applicants_women</code>?</li>
</ol>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="section-2-overview.html#cb157-1" aria-hidden="true"></a><span class="kw">spread</span>(tmp2, column_name, value)</span></code></pre></div>
<pre><code>##   major admitted_men admitted_women applicants_men applicants_women
## 1     A           62             82            825              108
## 2     B           63             68            560               25
## 3     C           37             34            325              593
## 4     D           33             35            417              375
## 5     E           28             24            191              393
## 6     F            6              7            373              341</code></pre>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A. <code>gather()</code></li>
<li><input type="checkbox" disabled="" checked="" />
B. <code>spread()</code></li>
<li><input type="checkbox" disabled="" />
C. <code>separate()</code></li>
<li><input type="checkbox" disabled="" />
D. <code>unite()</code></li>
</ul>
</div>
<div id="combining-tables" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Combining Tables</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/joining-tables.html">here</a></p>
<p><strong>Key points</strong></p>
<ul>
<li>The join functions in the <strong>dplyr</strong> package combine two tables such that matching rows are together.</li>
<li><code>left_join()</code> only keeps rows that have information in the first table.</li>
<li><code>right_join()</code> only keeps rows that have information in the second table.</li>
<li><code>inner_join()</code> only keeps rows that have information in both tables.</li>
<li><code>full_join()</code> keeps all rows from both tables.</li>
<li><code>semi_join()</code> keeps the part of first table for which we have information in the second.</li>
<li><code>anti_join()</code> keeps the elements of the first table for which there is no information in the second.</li>
</ul>
<p><em>Code</em></p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="section-2-overview.html#cb159-1" aria-hidden="true"></a><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(ggrepel)) <span class="kw">install.packages</span>(<span class="st">&quot;ggrepel&quot;</span>)</span></code></pre></div>
<pre><code>## Loading required package: ggrepel</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="section-2-overview.html#cb161-1" aria-hidden="true"></a><span class="co"># import US murders data</span></span>
<span id="cb161-2"><a href="section-2-overview.html#cb161-2" aria-hidden="true"></a><span class="kw">library</span>(ggrepel)</span>
<span id="cb161-3"><a href="section-2-overview.html#cb161-3" aria-hidden="true"></a><span class="kw">ds_theme_set</span>()</span>
<span id="cb161-4"><a href="section-2-overview.html#cb161-4" aria-hidden="true"></a><span class="kw">data</span>(murders)</span>
<span id="cb161-5"><a href="section-2-overview.html#cb161-5" aria-hidden="true"></a><span class="kw">head</span>(murders)</span></code></pre></div>
<pre><code>##        state abb region population total
## 1    Alabama  AL  South    4779736   135
## 2     Alaska  AK   West     710231    19
## 3    Arizona  AZ   West    6392017   232
## 4   Arkansas  AR  South    2915918    93
## 5 California  CA   West   37253956  1257
## 6   Colorado  CO   West    5029196    65</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="section-2-overview.html#cb163-1" aria-hidden="true"></a><span class="co"># import US election results data</span></span>
<span id="cb163-2"><a href="section-2-overview.html#cb163-2" aria-hidden="true"></a><span class="kw">data</span>(polls_us_election_<span class="dv">2016</span>)</span>
<span id="cb163-3"><a href="section-2-overview.html#cb163-3" aria-hidden="true"></a><span class="kw">head</span>(results_us_election_<span class="dv">2016</span>)</span></code></pre></div>
<pre><code>##          state electoral_votes clinton trump others
## 1   California              55    61.7  31.6    6.7
## 2        Texas              38    43.2  52.2    4.5
## 3      Florida              29    47.8  49.0    3.2
## 4     New York              29    59.0  36.5    4.5
## 5     Illinois              20    55.8  38.8    5.4
## 6 Pennsylvania              20    47.9  48.6    3.6</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="section-2-overview.html#cb165-1" aria-hidden="true"></a><span class="kw">identical</span>(results_us_election_<span class="dv">2016</span><span class="op">$</span>state, murders<span class="op">$</span>state)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="section-2-overview.html#cb167-1" aria-hidden="true"></a><span class="co"># join the murders table and US election results table</span></span>
<span id="cb167-2"><a href="section-2-overview.html#cb167-2" aria-hidden="true"></a>tab &lt;-<span class="st"> </span><span class="kw">left_join</span>(murders, results_us_election_<span class="dv">2016</span>, <span class="dt">by =</span> <span class="st">&quot;state&quot;</span>)</span>
<span id="cb167-3"><a href="section-2-overview.html#cb167-3" aria-hidden="true"></a><span class="kw">head</span>(tab)</span></code></pre></div>
<pre><code>##        state abb region population total electoral_votes clinton trump others
## 1    Alabama  AL  South    4779736   135               9    34.4  62.1    3.6
## 2     Alaska  AK   West     710231    19               3    36.6  51.3   12.2
## 3    Arizona  AZ   West    6392017   232              11    45.1  48.7    6.2
## 4   Arkansas  AR  South    2915918    93               6    33.7  60.6    5.8
## 5 California  CA   West   37253956  1257              55    61.7  31.6    6.7
## 6   Colorado  CO   West    5029196    65               9    48.2  43.3    8.6</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="section-2-overview.html#cb169-1" aria-hidden="true"></a><span class="co"># plot electoral votes versus population</span></span>
<span id="cb169-2"><a href="section-2-overview.html#cb169-2" aria-hidden="true"></a>tab <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(population<span class="op">/</span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span>, electoral_votes, <span class="dt">label =</span> abb)) <span class="op">+</span></span>
<span id="cb169-3"><a href="section-2-overview.html#cb169-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb169-4"><a href="section-2-overview.html#cb169-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_text_repel</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb169-5"><a href="section-2-overview.html#cb169-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span></span>
<span id="cb169-6"><a href="section-2-overview.html#cb169-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span></span>
<span id="cb169-7"><a href="section-2-overview.html#cb169-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="section-2-overview.html#cb171-1" aria-hidden="true"></a><span class="co"># make two smaller tables to demonstrate joins</span></span>
<span id="cb171-2"><a href="section-2-overview.html#cb171-2" aria-hidden="true"></a>tab1 &lt;-<span class="st"> </span><span class="kw">slice</span>(murders, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(state, population)</span>
<span id="cb171-3"><a href="section-2-overview.html#cb171-3" aria-hidden="true"></a>tab1</span></code></pre></div>
<pre><code>##        state population
## 1    Alabama    4779736
## 2     Alaska     710231
## 3    Arizona    6392017
## 4   Arkansas    2915918
## 5 California   37253956
## 6   Colorado    5029196</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="section-2-overview.html#cb173-1" aria-hidden="true"></a>tab2 &lt;-<span class="st"> </span><span class="kw">slice</span>(results_us_election_<span class="dv">2016</span>, <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span><span class="op">:</span><span class="dv">8</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(state, electoral_votes)</span>
<span id="cb173-2"><a href="section-2-overview.html#cb173-2" aria-hidden="true"></a>tab2</span></code></pre></div>
<pre><code>##        state electoral_votes
## 1 California              55
## 2      Texas              38
## 3    Florida              29
## 4   Illinois              20
## 5       Ohio              18
## 6    Georgia              16</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="section-2-overview.html#cb175-1" aria-hidden="true"></a><span class="co"># experiment with different joins</span></span>
<span id="cb175-2"><a href="section-2-overview.html#cb175-2" aria-hidden="true"></a><span class="kw">left_join</span>(tab1, tab2)</span></code></pre></div>
<pre><code>## Joining, by = &quot;state&quot;</code></pre>
<pre><code>##        state population electoral_votes
## 1    Alabama    4779736              NA
## 2     Alaska     710231              NA
## 3    Arizona    6392017              NA
## 4   Arkansas    2915918              NA
## 5 California   37253956              55
## 6   Colorado    5029196              NA</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="section-2-overview.html#cb178-1" aria-hidden="true"></a>tab1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(tab2)</span></code></pre></div>
<pre><code>## Joining, by = &quot;state&quot;</code></pre>
<pre><code>##        state population electoral_votes
## 1    Alabama    4779736              NA
## 2     Alaska     710231              NA
## 3    Arizona    6392017              NA
## 4   Arkansas    2915918              NA
## 5 California   37253956              55
## 6   Colorado    5029196              NA</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="section-2-overview.html#cb181-1" aria-hidden="true"></a>tab1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">right_join</span>(tab2)</span></code></pre></div>
<pre><code>## Joining, by = &quot;state&quot;</code></pre>
<pre><code>##        state population electoral_votes
## 1 California   37253956              55
## 2      Texas         NA              38
## 3    Florida         NA              29
## 4   Illinois         NA              20
## 5       Ohio         NA              18
## 6    Georgia         NA              16</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="section-2-overview.html#cb184-1" aria-hidden="true"></a><span class="kw">inner_join</span>(tab1, tab2)</span></code></pre></div>
<pre><code>## Joining, by = &quot;state&quot;</code></pre>
<pre><code>##        state population electoral_votes
## 1 California   37253956              55</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="section-2-overview.html#cb187-1" aria-hidden="true"></a><span class="kw">semi_join</span>(tab1, tab2)</span></code></pre></div>
<pre><code>## Joining, by = &quot;state&quot;</code></pre>
<pre><code>##        state population
## 1 California   37253956</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="section-2-overview.html#cb190-1" aria-hidden="true"></a><span class="kw">anti_join</span>(tab1, tab2)</span></code></pre></div>
<pre><code>## Joining, by = &quot;state&quot;</code></pre>
<pre><code>##      state population
## 1  Alabama    4779736
## 2   Alaska     710231
## 3  Arizona    6392017
## 4 Arkansas    2915918
## 5 Colorado    5029196</code></pre>
</div>
<div id="binding" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Binding</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/joining-tables.html#binding">here</a></p>
<p><strong>Key points</strong></p>
<ul>
<li>Unlike the join functions, the binding functions do not try to match by a variable, but rather just combine datasets.</li>
<li><code>bind_cols()</code> binds two objects by making them columns in a tibble. The R-base function <code>cbind()</code> binds columns but makes a data frame or matrix instead.</li>
<li>The <code>bind_rows()</code> function is similar but binds rows instead of columns. The R-base function <code>rbind()</code> binds rows but makes a data frame or matrix instead.</li>
</ul>
<p><em>Code</em></p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="section-2-overview.html#cb193-1" aria-hidden="true"></a><span class="kw">bind_cols</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">4</span><span class="op">:</span><span class="dv">6</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##       a     b
##   &lt;int&gt; &lt;int&gt;
## 1     1     4
## 2     2     5
## 3     3     6</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="section-2-overview.html#cb195-1" aria-hidden="true"></a>tab1 &lt;-<span class="st"> </span>tab[, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb195-2"><a href="section-2-overview.html#cb195-2" aria-hidden="true"></a>tab2 &lt;-<span class="st"> </span>tab[, <span class="dv">4</span><span class="op">:</span><span class="dv">6</span>]</span>
<span id="cb195-3"><a href="section-2-overview.html#cb195-3" aria-hidden="true"></a>tab3 &lt;-<span class="st"> </span>tab[, <span class="dv">7</span><span class="op">:</span><span class="dv">9</span>]</span>
<span id="cb195-4"><a href="section-2-overview.html#cb195-4" aria-hidden="true"></a>new_tab &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(tab1, tab2, tab3)</span>
<span id="cb195-5"><a href="section-2-overview.html#cb195-5" aria-hidden="true"></a><span class="kw">head</span>(new_tab)</span></code></pre></div>
<pre><code>##        state abb region population total electoral_votes clinton trump others
## 1    Alabama  AL  South    4779736   135               9    34.4  62.1    3.6
## 2     Alaska  AK   West     710231    19               3    36.6  51.3   12.2
## 3    Arizona  AZ   West    6392017   232              11    45.1  48.7    6.2
## 4   Arkansas  AR  South    2915918    93               6    33.7  60.6    5.8
## 5 California  CA   West   37253956  1257              55    61.7  31.6    6.7
## 6   Colorado  CO   West    5029196    65               9    48.2  43.3    8.6</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="section-2-overview.html#cb197-1" aria-hidden="true"></a>tab1 &lt;-<span class="st"> </span>tab[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,]</span>
<span id="cb197-2"><a href="section-2-overview.html#cb197-2" aria-hidden="true"></a>tab2 &lt;-<span class="st"> </span>tab[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>,]</span>
<span id="cb197-3"><a href="section-2-overview.html#cb197-3" aria-hidden="true"></a><span class="kw">bind_rows</span>(tab1, tab2)</span></code></pre></div>
<pre><code>##      state abb region population total electoral_votes clinton trump others
## 1  Alabama  AL  South    4779736   135               9    34.4  62.1    3.6
## 2   Alaska  AK   West     710231    19               3    36.6  51.3   12.2
## 3  Arizona  AZ   West    6392017   232              11    45.1  48.7    6.2
## 4 Arkansas  AR  South    2915918    93               6    33.7  60.6    5.8</code></pre>
</div>
<div id="set-operators" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Set Operators</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/joining-tables.html#set-operators">here</a></p>
<p><strong>Key points</strong></p>
<ul>
<li>By default, the set operators in R-base work on vectors. If <strong>tidyverse/dplyr</strong> are loaded, they also work on data frames.</li>
<li>You can take intersections of vectors using <code>intersect()</code>. This returns the elements common to both sets.</li>
<li>You can take the union of vectors using <code>union()</code>. This returns the elements that are in either set.</li>
<li>The set difference between a first and second argument can be obtained with <code>setdiff()</code>. Note that this function is not symmetric.</li>
<li>The function <code>set_equal()</code> tells us if two sets are the same, regardless of the order of elements.</li>
</ul>
<p><em>Code</em></p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="section-2-overview.html#cb199-1" aria-hidden="true"></a><span class="co"># intersect vectors or data frames</span></span>
<span id="cb199-2"><a href="section-2-overview.html#cb199-2" aria-hidden="true"></a><span class="kw">intersect</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">6</span><span class="op">:</span><span class="dv">15</span>)</span></code></pre></div>
<pre><code>## [1]  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="section-2-overview.html#cb201-1" aria-hidden="true"></a><span class="kw">intersect</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;b&quot; &quot;c&quot;</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="section-2-overview.html#cb203-1" aria-hidden="true"></a>tab1 &lt;-<span class="st"> </span>tab[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,]</span>
<span id="cb203-2"><a href="section-2-overview.html#cb203-2" aria-hidden="true"></a>tab2 &lt;-<span class="st"> </span>tab[<span class="dv">3</span><span class="op">:</span><span class="dv">7</span>,]</span>
<span id="cb203-3"><a href="section-2-overview.html#cb203-3" aria-hidden="true"></a><span class="kw">intersect</span>(tab1, tab2)</span></code></pre></div>
<pre><code>##        state abb region population total electoral_votes clinton trump others
## 1    Arizona  AZ   West    6392017   232              11    45.1  48.7    6.2
## 2   Arkansas  AR  South    2915918    93               6    33.7  60.6    5.8
## 3 California  CA   West   37253956  1257              55    61.7  31.6    6.7</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="section-2-overview.html#cb205-1" aria-hidden="true"></a><span class="co"># perform a union of vectors or data frames</span></span>
<span id="cb205-2"><a href="section-2-overview.html#cb205-2" aria-hidden="true"></a><span class="kw">union</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">6</span><span class="op">:</span><span class="dv">15</span>)</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="section-2-overview.html#cb207-1" aria-hidden="true"></a><span class="kw">union</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot;</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="section-2-overview.html#cb209-1" aria-hidden="true"></a>tab1 &lt;-<span class="st"> </span>tab[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,]</span>
<span id="cb209-2"><a href="section-2-overview.html#cb209-2" aria-hidden="true"></a>tab2 &lt;-<span class="st"> </span>tab[<span class="dv">3</span><span class="op">:</span><span class="dv">7</span>,]</span>
<span id="cb209-3"><a href="section-2-overview.html#cb209-3" aria-hidden="true"></a><span class="kw">union</span>(tab1, tab2)</span></code></pre></div>
<pre><code>##         state abb    region population total electoral_votes clinton trump others
## 1     Alabama  AL     South    4779736   135               9    34.4  62.1    3.6
## 2      Alaska  AK      West     710231    19               3    36.6  51.3   12.2
## 3     Arizona  AZ      West    6392017   232              11    45.1  48.7    6.2
## 4    Arkansas  AR     South    2915918    93               6    33.7  60.6    5.8
## 5  California  CA      West   37253956  1257              55    61.7  31.6    6.7
## 6    Colorado  CO      West    5029196    65               9    48.2  43.3    8.6
## 7 Connecticut  CT Northeast    3574097    97               7    54.6  40.9    4.5</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="section-2-overview.html#cb211-1" aria-hidden="true"></a><span class="co"># set difference of vectors or data frames</span></span>
<span id="cb211-2"><a href="section-2-overview.html#cb211-2" aria-hidden="true"></a><span class="kw">setdiff</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">6</span><span class="op">:</span><span class="dv">15</span>)</span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="section-2-overview.html#cb213-1" aria-hidden="true"></a><span class="kw">setdiff</span>(<span class="dv">6</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] 11 12 13 14 15</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="section-2-overview.html#cb215-1" aria-hidden="true"></a>tab1 &lt;-<span class="st"> </span>tab[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,]</span>
<span id="cb215-2"><a href="section-2-overview.html#cb215-2" aria-hidden="true"></a>tab2 &lt;-<span class="st"> </span>tab[<span class="dv">3</span><span class="op">:</span><span class="dv">7</span>,]</span>
<span id="cb215-3"><a href="section-2-overview.html#cb215-3" aria-hidden="true"></a><span class="kw">setdiff</span>(tab1, tab2)</span></code></pre></div>
<pre><code>##     state abb region population total electoral_votes clinton trump others
## 1 Alabama  AL  South    4779736   135               9    34.4  62.1    3.6
## 2  Alaska  AK   West     710231    19               3    36.6  51.3   12.2</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="section-2-overview.html#cb217-1" aria-hidden="true"></a><span class="co"># setequal determines whether sets have the same elements, regardless of order</span></span>
<span id="cb217-2"><a href="section-2-overview.html#cb217-2" aria-hidden="true"></a><span class="kw">setequal</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="section-2-overview.html#cb219-1" aria-hidden="true"></a><span class="kw">setequal</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">5</span><span class="op">:</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="section-2-overview.html#cb221-1" aria-hidden="true"></a><span class="kw">setequal</span>(tab1, tab2)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
</div>
<div id="assessment---combining-tables" class="section level2" number="3.9">
<h2><span class="header-section-number">3.9</span> Assessment - Combining Tables</h2>
<ol style="list-style-type: decimal">
<li>You have created a <code>tab1</code> and <code>tab2</code> of state population and election data:</li>
</ol>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="section-2-overview.html#cb223-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span>tab1</span>
<span id="cb223-2"><a href="section-2-overview.html#cb223-2" aria-hidden="true"></a>state                    population</span>
<span id="cb223-3"><a href="section-2-overview.html#cb223-3" aria-hidden="true"></a>Alabama                  <span class="dv">4779736</span></span>
<span id="cb223-4"><a href="section-2-overview.html#cb223-4" aria-hidden="true"></a>Alaska                   <span class="dv">710231</span></span>
<span id="cb223-5"><a href="section-2-overview.html#cb223-5" aria-hidden="true"></a>Arizona                  <span class="dv">6392017</span></span>
<span id="cb223-6"><a href="section-2-overview.html#cb223-6" aria-hidden="true"></a>Delaware                 <span class="dv">897934</span></span>
<span id="cb223-7"><a href="section-2-overview.html#cb223-7" aria-hidden="true"></a>District of Columbia     <span class="dv">601723</span></span>
<span id="cb223-8"><a href="section-2-overview.html#cb223-8" aria-hidden="true"></a></span>
<span id="cb223-9"><a href="section-2-overview.html#cb223-9" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span>tab2</span>
<span id="cb223-10"><a href="section-2-overview.html#cb223-10" aria-hidden="true"></a>state        electoral_votes</span>
<span id="cb223-11"><a href="section-2-overview.html#cb223-11" aria-hidden="true"></a>Alabama      <span class="dv">9</span></span>
<span id="cb223-12"><a href="section-2-overview.html#cb223-12" aria-hidden="true"></a>Alaska       <span class="dv">3</span></span>
<span id="cb223-13"><a href="section-2-overview.html#cb223-13" aria-hidden="true"></a>Arizona      <span class="dv">11</span></span>
<span id="cb223-14"><a href="section-2-overview.html#cb223-14" aria-hidden="true"></a>California   <span class="dv">55</span></span>
<span id="cb223-15"><a href="section-2-overview.html#cb223-15" aria-hidden="true"></a>Colorado     <span class="dv">9</span></span>
<span id="cb223-16"><a href="section-2-overview.html#cb223-16" aria-hidden="true"></a>Connecticut  <span class="dv">7</span></span>
<span id="cb223-17"><a href="section-2-overview.html#cb223-17" aria-hidden="true"></a></span>
<span id="cb223-18"><a href="section-2-overview.html#cb223-18" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">dim</span>(tab1)</span>
<span id="cb223-19"><a href="section-2-overview.html#cb223-19" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="dv">5</span> <span class="dv">2</span></span>
<span id="cb223-20"><a href="section-2-overview.html#cb223-20" aria-hidden="true"></a></span>
<span id="cb223-21"><a href="section-2-overview.html#cb223-21" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">dim</span>(tab2)</span>
<span id="cb223-22"><a href="section-2-overview.html#cb223-22" aria-hidden="true"></a>[<span class="dv">1</span>] <span class="dv">6</span> <span class="dv">2</span></span></code></pre></div>
<p>What are the dimensions of the table dat, created by the following command?</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="section-2-overview.html#cb224-1" aria-hidden="true"></a>dat &lt;-<span class="st"> </span><span class="kw">left_join</span>(tab1, tab2, <span class="dt">by =</span> “state”)</span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A. 3 rows by 3 columns</li>
<li><input type="checkbox" disabled="" />
B. 5 rows by 2 columns</li>
<li><input type="checkbox" disabled="" checked="" />
C. 5 rows by 3 columns</li>
<li><input type="checkbox" disabled="" />
D. 6 rows by 3 columns</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>We are still using the <code>tab1</code> and ```tab2 tables shown in question 1. What join command would create a new table “dat” with three rows and two columns?</li>
</ol>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A. <code>dat &lt;- right_join(tab1, tab2, by = “state”)</code></li>
<li><input type="checkbox" disabled="" />
B. <code>dat &lt;- full_join(tab1, tab2, by = “state”)</code></li>
<li><input type="checkbox" disabled="" />
C. <code>dat &lt;- inner_join(tab1, tab2, by = “state”)</code></li>
<li><input type="checkbox" disabled="" checked="" />
D. <code>dat &lt;- semi_join(tab1, tab2, by = “state”)</code></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Which of the following are real differences between the join and bind functions?</li>
</ol>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="" />
A. Binding functions combine by position, while join functions match by variables.</li>
<li><input type="checkbox" disabled="" checked="" />
B. Joining functions can join datasets of different dimensions, but the bind functions must match on the appropriate dimension (either same row or column numbers).</li>
<li><input type="checkbox" disabled="" checked="" />
C. Bind functions can combine both vectors and dataframes, while join functions work for only for dataframes.</li>
<li><input type="checkbox" disabled="" />
D. The join functions are a part of the dplyr package and have been optimized for speed, while the bind functions are inefficient base functions.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>We have two simple tables, shown below, with columns <code>x</code> and <code>y</code>:</li>
</ol>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="section-2-overview.html#cb225-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span>df1</span>
<span id="cb225-2"><a href="section-2-overview.html#cb225-2" aria-hidden="true"></a> x     y    </span>
<span id="cb225-3"><a href="section-2-overview.html#cb225-3" aria-hidden="true"></a> a     a    </span>
<span id="cb225-4"><a href="section-2-overview.html#cb225-4" aria-hidden="true"></a> b     a    </span>
<span id="cb225-5"><a href="section-2-overview.html#cb225-5" aria-hidden="true"></a></span>
<span id="cb225-6"><a href="section-2-overview.html#cb225-6" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span>df2</span>
<span id="cb225-7"><a href="section-2-overview.html#cb225-7" aria-hidden="true"></a> x     y    </span>
<span id="cb225-8"><a href="section-2-overview.html#cb225-8" aria-hidden="true"></a> a     a    </span>
<span id="cb225-9"><a href="section-2-overview.html#cb225-9" aria-hidden="true"></a> a     b  </span></code></pre></div>
<p>Which command would result in the following table?</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="section-2-overview.html#cb226-1" aria-hidden="true"></a><span class="op">&gt;</span><span class="st"> </span>final</span>
<span id="cb226-2"><a href="section-2-overview.html#cb226-2" aria-hidden="true"></a> x     y    </span>
<span id="cb226-3"><a href="section-2-overview.html#cb226-3" aria-hidden="true"></a> b     a   </span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A. <code>final &lt;- union(df1, df2)</code></li>
<li><input type="checkbox" disabled="" checked="" />
B. <code>final &lt;- setdiff(df1, df2)</code></li>
<li><input type="checkbox" disabled="" />
C. <code>final &lt;- setdiff(df2, df1)</code></li>
<li><input type="checkbox" disabled="" />
D. <code>final &lt;- intersect(df1, df2)</code></li>
</ul>
<p>Install and load the <strong>Lahman</strong> library. This library contains a variety of datasets related to US professional baseball. We will use this library for the next few questions and will discuss it more extensively in the Regression course. For now, focus on wrangling the data rather than understanding the statistics.</p>
<p>The <code>Batting</code> data frame contains the offensive statistics for all baseball players over several seasons. Filter this data frame to define <code>top</code> as the top 10 home run (<code>HR</code>) hitters in 2016:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="section-2-overview.html#cb227-1" aria-hidden="true"></a><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(Lahman)) <span class="kw">install.packages</span>(<span class="st">&quot;Lahman&quot;</span>)</span></code></pre></div>
<pre><code>## Loading required package: Lahman</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="section-2-overview.html#cb229-1" aria-hidden="true"></a><span class="kw">library</span>(Lahman)</span>
<span id="cb229-2"><a href="section-2-overview.html#cb229-2" aria-hidden="true"></a>top &lt;-<span class="st"> </span>Batting <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb229-3"><a href="section-2-overview.html#cb229-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(yearID <span class="op">==</span><span class="st"> </span><span class="dv">2016</span>) <span class="op">%&gt;%</span></span>
<span id="cb229-4"><a href="section-2-overview.html#cb229-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(HR)) <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># arrange by descending HR count</span></span>
<span id="cb229-5"><a href="section-2-overview.html#cb229-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)    <span class="co"># take entries 1-10</span></span>
<span id="cb229-6"><a href="section-2-overview.html#cb229-6" aria-hidden="true"></a>top <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tibble</span>()</span></code></pre></div>
<pre><code>## # A tibble: 10 x 22
##    playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR   RBI    SB    CS    BB    SO   IBB   HBP    SH    SF  GIDP
##    &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1 trumbma01   2016     1 BAL    AL      159   613    94   157    27     1    47   108     2     0    51   170     1     3     0     0    14
##  2 cruzne02    2016     1 SEA    AL      155   589    96   169    27     1    43   105     2     0    62   159     5     9     0     7    15
##  3 daviskh01   2016     1 OAK    AL      150   555    85   137    24     2    42   102     1     2    42   166     0     8     0     5    19
##  4 doziebr01   2016     1 MIN    AL      155   615   104   165    35     5    42    99    18     2    61   138     6     8     2     5    12
##  5 encared01   2016     1 TOR    AL      160   601    99   158    34     0    42   127     2     0    87   138     3     5     0     8    22
##  6 arenano01   2016     1 COL    NL      160   618   116   182    35     6    41   133     2     3    68   103    10     2     0     8    17
##  7 cartech02   2016     1 MIL    NL      160   549    84   122    27     1    41    94     3     1    76   206     1     9     0    10    18
##  8 frazito01   2016     1 CHA    AL      158   590    89   133    21     0    40    98    15     5    64   163     1     4     1     7    11
##  9 bryankr01   2016     1 CHN    NL      155   603   121   176    35     3    39   102     8     5    75   154     5    18     0     3     3
## 10 canoro01    2016     1 SEA    AL      161   655   107   195    33     2    39   103     0     1    47   100     8     8     0     5    18</code></pre>
<p>Also Inspect the <code>Master</code> data frame, which has demographic information for all players:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="section-2-overview.html#cb231-1" aria-hidden="true"></a>Master <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tibble</span>()</span></code></pre></div>
<pre><code>## # A tibble: 19,878 x 26
##    playerID birthYear birthMonth birthDay birthCountry birthState birthCity deathYear deathMonth deathDay deathCountry deathState deathCity nameFirst nameLast nameGiven weight height
##    &lt;chr&gt;        &lt;int&gt;      &lt;int&gt;    &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;         &lt;int&gt;      &lt;int&gt;    &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;      &lt;int&gt;  &lt;int&gt;
##  1 aardsda…      1981         12       27 USA          CO         Denver           NA         NA       NA &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;      David     Aardsma  David Al…    215     75
##  2 aaronha…      1934          2        5 USA          AL         Mobile           NA         NA       NA &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;      Hank      Aaron    Henry Lo…    180     72
##  3 aaronto…      1939          8        5 USA          AL         Mobile         1984          8       16 USA          GA         Atlanta   Tommie    Aaron    Tommie L…    190     75
##  4 aasedo01      1954          9        8 USA          CA         Orange           NA         NA       NA &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;      Don       Aase     Donald W…    190     75
##  5 abadan01      1972          8       25 USA          FL         Palm Bea…        NA         NA       NA &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;      Andy      Abad     Fausto A…    184     73
##  6 abadfe01      1985         12       17 D.R.         La Romana  La Romana        NA         NA       NA &lt;NA&gt;         &lt;NA&gt;       &lt;NA&gt;      Fernando  Abad     Fernando…    220     73
##  7 abadijo…      1850         11        4 USA          PA         Philadel…      1905          5       17 USA          NJ         Pemberton John      Abadie   John W.      192     72
##  8 abbated…      1877          4       15 USA          PA         Latrobe        1957          1        6 USA          FL         Fort Lau… Ed        Abbatic… Edward J…    170     71
##  9 abbeybe…      1869         11       11 USA          VT         Essex          1962          6       11 USA          VT         Colchest… Bert      Abbey    Bert Wood    175     71
## 10 abbeych…      1866         10       14 USA          NE         Falls Ci…      1926          4       27 USA          CA         San Fran… Charlie   Abbey    Charles …    169     68
## # … with 19,868 more rows, and 8 more variables: bats &lt;fct&gt;, throws &lt;fct&gt;, debut &lt;chr&gt;, finalGame &lt;chr&gt;, retroID &lt;chr&gt;, bbrefID &lt;chr&gt;, deathDate &lt;date&gt;, birthDate &lt;date&gt;</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Use the correct <code>join</code> or <code>bind</code> function to create a combined table of the names and statistics of the top 10 home run (HR) hitters for 2016. This table should have the player ID, first name, last name, and number of HR for the top 10 players. Name this data frame <code>top_names</code>.</li>
</ol>
<p>Identify the <code>join</code> or <code>bind</code> that fills the blank in this code to create the correct table:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="section-2-overview.html#cb233-1" aria-hidden="true"></a>top_names &lt;-<span class="st"> </span>top <span class="op">%&gt;%</span><span class="st"> </span>___________________ <span class="op">%&gt;%</span></span>
<span id="cb233-2"><a href="section-2-overview.html#cb233-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">select</span>(playerID, nameFirst, nameLast, HR)</span></code></pre></div>
<p>Which bind or join function fills the blank to generate the correct table?</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="section-2-overview.html#cb234-1" aria-hidden="true"></a>top_names &lt;-<span class="st"> </span>top <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(Master) <span class="op">%&gt;%</span></span>
<span id="cb234-2"><a href="section-2-overview.html#cb234-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">select</span>(playerID, nameFirst, nameLast, HR)</span></code></pre></div>
<pre><code>## Joining, by = &quot;playerID&quot;</code></pre>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A. <code>rbind(Master)</code></li>
<li><input type="checkbox" disabled="" />
B. <code>cbind(Master)</code></li>
<li><input type="checkbox" disabled="" checked="" />
C. <code>left_join(Master)</code></li>
<li><input type="checkbox" disabled="" />
D. <code>right_join(Master)</code></li>
<li><input type="checkbox" disabled="" />
E. <code>full_join(Master)</code></li>
<li><input type="checkbox" disabled="" />
F. <code>anti_join(Master)</code></li>
</ul>
<ol start="6" style="list-style-type: decimal">
<li>Inspect the <code>Salaries</code> data frame. Filter this data frame to the 2016 salaries, then use the correct bind join function to add a <code>salary</code> column to the <code>top_names</code> data frame from the previous question. Name the new data frame <code>top_salary</code>. Use this code framework:</li>
</ol>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="section-2-overview.html#cb236-1" aria-hidden="true"></a>top_salary &lt;-<span class="st"> </span>Salaries <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(yearID <span class="op">==</span><span class="st"> </span><span class="dv">2016</span>) <span class="op">%&gt;%</span></span>
<span id="cb236-2"><a href="section-2-overview.html#cb236-2" aria-hidden="true"></a><span class="st">  </span>______________ <span class="op">%&gt;%</span></span>
<span id="cb236-3"><a href="section-2-overview.html#cb236-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(nameFirst, nameLast, teamID, HR, salary)</span></code></pre></div>
<p>Which <code>bind</code> or <code>join</code> function fills the blank to generate the correct table?</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="section-2-overview.html#cb237-1" aria-hidden="true"></a>top_salary &lt;-<span class="st"> </span>Salaries <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(yearID <span class="op">==</span><span class="st"> </span><span class="dv">2016</span>) <span class="op">%&gt;%</span></span>
<span id="cb237-2"><a href="section-2-overview.html#cb237-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">right_join</span>(top_names) <span class="op">%&gt;%</span></span>
<span id="cb237-3"><a href="section-2-overview.html#cb237-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(nameFirst, nameLast, teamID, HR, salary)</span></code></pre></div>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A. <code>rbind(top_names)</code></li>
<li><input type="checkbox" disabled="" />
B. <code>cbind(top_names)</code></li>
<li><input type="checkbox" disabled="" />
C. <code>left_join(top_names)</code></li>
<li><input type="checkbox" disabled="" checked="" />
D. <code>right_join(top_names)</code></li>
<li><input type="checkbox" disabled="" />
E. <code>full_join(top_names)</code></li>
<li><input type="checkbox" disabled="" />
F. <code>anti_join(top_names)</code></li>
</ul>
<ol start="7" style="list-style-type: decimal">
<li>Inspect the <code>AwardsPlayers</code> table. Filter awards to include only the year 2016.</li>
</ol>
<p>How many players from the top 10 home run hitters won at least one award in 2016? Use a set operator.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="section-2-overview.html#cb238-1" aria-hidden="true"></a>Awards_<span class="dv">2016</span> &lt;-<span class="st"> </span>AwardsPlayers <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(yearID <span class="op">==</span><span class="st"> </span><span class="dv">2016</span>)</span>
<span id="cb238-2"><a href="section-2-overview.html#cb238-2" aria-hidden="true"></a><span class="kw">length</span>(<span class="kw">intersect</span>(Awards_<span class="dv">2016</span><span class="op">$</span>playerID, top_names<span class="op">$</span>playerID))</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>How many players won an award in 2016 but were not one of the top 10 home run hitters in 2016? Use a set operator.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="section-2-overview.html#cb240-1" aria-hidden="true"></a><span class="kw">length</span>(<span class="kw">setdiff</span>(Awards_<span class="dv">2016</span><span class="op">$</span>playerID, top_names<span class="op">$</span>playerID))</span></code></pre></div>
<pre><code>## [1] 44</code></pre>
</div>
<div id="web-scraping" class="section level2" number="3.10">
<h2><span class="header-section-number">3.10</span> Web Scraping</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/web-scraping.html">here</a> through <a href="https://rafalab.github.io/dsbook/web-scraping.html#the-rvest-package">section 23.2</a></p>
<p><strong>Key points</strong></p>
<ul>
<li>Web scraping is extracting data from a website.</li>
<li>The <strong>rvest</strong> web harvesting package includes functions to extract nodes of an HTML document: <code>html_nodes()</code> extracts all nodes of different types, and <code>html_node()</code> extracts the first node.</li>
<li><code>html_table()</code> converts an HTML table to a data frame.</li>
</ul>
<p><em>Code</em></p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="section-2-overview.html#cb242-1" aria-hidden="true"></a><span class="co"># import a webpage into R</span></span>
<span id="cb242-2"><a href="section-2-overview.html#cb242-2" aria-hidden="true"></a><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(rvest)) <span class="kw">install.packages</span>(<span class="st">&quot;rvest&quot;</span>)</span></code></pre></div>
<pre><code>## Loading required package: rvest</code></pre>
<pre><code>## Loading required package: xml2</code></pre>
<pre><code>## 
## Attaching package: &#39;rvest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     pluck</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     guess_encoding</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="section-2-overview.html#cb248-1" aria-hidden="true"></a><span class="kw">library</span>(rvest)</span>
<span id="cb248-2"><a href="section-2-overview.html#cb248-2" aria-hidden="true"></a>url &lt;-<span class="st"> &quot;https://en.wikipedia.org/wiki/Murder_in_the_United_States_by_state&quot;</span></span>
<span id="cb248-3"><a href="section-2-overview.html#cb248-3" aria-hidden="true"></a>h &lt;-<span class="st"> </span><span class="kw">read_html</span>(url)</span>
<span id="cb248-4"><a href="section-2-overview.html#cb248-4" aria-hidden="true"></a><span class="kw">class</span>(h)</span></code></pre></div>
<pre><code>## [1] &quot;xml_document&quot; &quot;xml_node&quot;</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="section-2-overview.html#cb250-1" aria-hidden="true"></a>h</span></code></pre></div>
<pre><code>## {html_document}
## &lt;html class=&quot;client-nojs&quot; lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;
## [1] &lt;head&gt;\n&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;\n&lt;meta charset=&quot;UTF-8&quot;&gt;\n&lt;title&gt;Gun violence in the United States by state - Wikipedia&lt;/title&gt;\n&lt;sc ...
## [2] &lt;body class=&quot;mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject mw-editable page-Gun_violence_in_the_United_States_by_state rootpage-Gun_violence_in_the_United_States ...</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="section-2-overview.html#cb252-1" aria-hidden="true"></a>tab &lt;-<span class="st"> </span>h <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_nodes</span>(<span class="st">&quot;table&quot;</span>)</span>
<span id="cb252-2"><a href="section-2-overview.html#cb252-2" aria-hidden="true"></a>tab &lt;-<span class="st"> </span>tab[[<span class="dv">2</span>]]</span>
<span id="cb252-3"><a href="section-2-overview.html#cb252-3" aria-hidden="true"></a></span>
<span id="cb252-4"><a href="section-2-overview.html#cb252-4" aria-hidden="true"></a>tab &lt;-<span class="st"> </span>tab <span class="op">%&gt;%</span><span class="st"> </span>html_table</span>
<span id="cb252-5"><a href="section-2-overview.html#cb252-5" aria-hidden="true"></a><span class="kw">class</span>(tab)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="section-2-overview.html#cb254-1" aria-hidden="true"></a>tab &lt;-<span class="st"> </span>tab <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">setNames</span>(<span class="kw">c</span>(<span class="st">&quot;state&quot;</span>, <span class="st">&quot;population&quot;</span>, <span class="st">&quot;total&quot;</span>, <span class="st">&quot;murders&quot;</span>, <span class="st">&quot;gun_murders&quot;</span>, <span class="st">&quot;gun_ownership&quot;</span>, <span class="st">&quot;total_rate&quot;</span>, <span class="st">&quot;murder_rate&quot;</span>, <span class="st">&quot;gun_murder_rate&quot;</span>))</span>
<span id="cb254-2"><a href="section-2-overview.html#cb254-2" aria-hidden="true"></a><span class="kw">head</span>(tab)</span></code></pre></div>
<pre><code>##        state population total murders gun_murders gun_ownership total_rate murder_rate gun_murder_rate
## 1    Alabama  4,853,875   348    —[a]        —[a]          48.9        7.2       — [a]           — [a]
## 2     Alaska    737,709    59      57          39          61.7        8.0         7.7             5.3
## 3    Arizona  6,817,565   306     278         171          32.3        4.5         4.1             2.5
## 4   Arkansas  2,977,853   181     164         110          57.9        6.1         5.5             3.7
## 5 California 38,993,940 1,861   1,861       1,275          20.1        4.8         4.8             3.3
## 6   Colorado  5,448,819   176     176         115          34.3        3.2         3.2             2.1</code></pre>
</div>
<div id="css-selectors" class="section level2" number="3.11">
<h2><span class="header-section-number">3.11</span> CSS Selectors</h2>
<p>This page corresponds to the <a href="https://rafalab.github.io/dsbook/web-scraping.html#css-selectors">textbook section on CSS selectors</a>.</p>
<p>The default look of webpages made with the most basic HTML is quite unattractive. The aesthetically pleasing pages we see today are made using CSS. CSS is used to add style to webpages. The fact that all pages for a company have the same style is usually a result that they all use the same CSS file. The general way these CSS files work is by defining how each of the elements of a webpage will look. The title, headings, itemized lists, tables, and links, for example, each receive their own style including font, color, size, and distance from the margin, among others.</p>
<p>To do this CSS leverages patterns used to define these elements, referred to as selectors. An example of pattern we used in a previous video is table but there are many many more. If we want to grab data from a webpage and we happen to know a selector that is unique to the part of the page, we can use the html_nodes() function.</p>
<p>However, knowing which selector to use can be quite complicated. To demonstrate this we will try to extract the recipe name, total preparation time, and list of ingredients from <a href="http://www.foodnetwork.com/recipes/alton-brown/guacamole-recipe-1940609">this guacamole recipe</a>. Looking at the code for this page, it seems that the task is impossibly complex. However, selector gadgets actually make this possible. <a href="https://selectorgadget.com">SelectorGadget</a> is piece of software that allows you to interactively determine what CSS selector you need to extract specific components from the webpage. If you plan on scraping data other than tables, we highly recommend you install it. A Chrome extension is available which permits you to turn on the gadget highlighting parts of the page as you click through, showing the necessary selector to extract those segments.</p>
<p>For the guacamole recipe page, we already have done this and determined that we need the following selectors:</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="section-2-overview.html#cb256-1" aria-hidden="true"></a>h &lt;-<span class="st"> </span><span class="kw">read_html</span>(<span class="st">&quot;http://www.foodnetwork.com/recipes/alton-brown/guacamole-recipe-1940609&quot;</span>)</span>
<span id="cb256-2"><a href="section-2-overview.html#cb256-2" aria-hidden="true"></a>recipe &lt;-<span class="st"> </span>h <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_node</span>(<span class="st">&quot;.o-AssetTitle__a-HeadlineText&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_text</span>()</span>
<span id="cb256-3"><a href="section-2-overview.html#cb256-3" aria-hidden="true"></a>prep_time &lt;-<span class="st"> </span>h <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_node</span>(<span class="st">&quot;.m-RecipeInfo__a-Description--Total&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_text</span>()</span>
<span id="cb256-4"><a href="section-2-overview.html#cb256-4" aria-hidden="true"></a>ingredients &lt;-<span class="st"> </span>h <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_nodes</span>(<span class="st">&quot;.o-Ingredients__a-Ingredient&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_text</span>()</span></code></pre></div>
<p>You can see how complex the selectors are. In any case we are now ready to extract what we want and create a list:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="section-2-overview.html#cb257-1" aria-hidden="true"></a>guacamole &lt;-<span class="st"> </span><span class="kw">list</span>(recipe, prep_time, ingredients)</span>
<span id="cb257-2"><a href="section-2-overview.html#cb257-2" aria-hidden="true"></a>guacamole</span></code></pre></div>
<p>Since recipe pages from this website follow this general layout, we can use this code to create a function that extracts this information:</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="section-2-overview.html#cb258-1" aria-hidden="true"></a>get_recipe &lt;-<span class="st"> </span><span class="cf">function</span>(url){</span>
<span id="cb258-2"><a href="section-2-overview.html#cb258-2" aria-hidden="true"></a>    h &lt;-<span class="st"> </span><span class="kw">read_html</span>(url)</span>
<span id="cb258-3"><a href="section-2-overview.html#cb258-3" aria-hidden="true"></a>    recipe &lt;-<span class="st"> </span>h <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_node</span>(<span class="st">&quot;.o-AssetTitle__a-HeadlineText&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_text</span>()</span>
<span id="cb258-4"><a href="section-2-overview.html#cb258-4" aria-hidden="true"></a>    prep_time &lt;-<span class="st"> </span>h <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_node</span>(<span class="st">&quot;.m-RecipeInfo__a-Description--Total&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_text</span>()</span>
<span id="cb258-5"><a href="section-2-overview.html#cb258-5" aria-hidden="true"></a>    ingredients &lt;-<span class="st"> </span>h <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_nodes</span>(<span class="st">&quot;.o-Ingredients__a-Ingredient&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_text</span>()</span>
<span id="cb258-6"><a href="section-2-overview.html#cb258-6" aria-hidden="true"></a>    <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">recipe =</span> recipe, <span class="dt">prep_time =</span> prep_time, <span class="dt">ingredients =</span> ingredients))</span>
<span id="cb258-7"><a href="section-2-overview.html#cb258-7" aria-hidden="true"></a>}</span></code></pre></div>
<p>and then use it on any of their webpages:</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="section-2-overview.html#cb259-1" aria-hidden="true"></a><span class="kw">get_recipe</span>(<span class="st">&quot;http://www.foodnetwork.com/recipes/food-network-kitchen/pancakes-recipe-1913844&quot;</span>)</span></code></pre></div>
<p>There are several other powerful tools provided by <strong>rvest</strong>. For example, the functions <code>html_form()</code>, <code>set_values()</code>, and <code>submit_form()</code> permit you to query a webpage from R. This is a more advanced topic not covered here.</p>
</div>
<div id="assessment---web-scraping" class="section level2" number="3.12">
<h2><span class="header-section-number">3.12</span> Assessment - Web Scraping</h2>
<p>Load the following web page, which contains information about Major League Baseball payrolls, into R:</p>
<p><a href="https://web.archive.org/web/20181024132313/http://www.stevetheump.com/Payrolls.htm" class="uri">https://web.archive.org/web/20181024132313/http://www.stevetheump.com/Payrolls.htm</a></p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="section-2-overview.html#cb260-1" aria-hidden="true"></a>url &lt;-<span class="st"> &quot;https://web.archive.org/web/20181024132313/http://www.stevetheump.com/Payrolls.htm&quot;</span></span>
<span id="cb260-2"><a href="section-2-overview.html#cb260-2" aria-hidden="true"></a>h &lt;-<span class="st"> </span><span class="kw">read_html</span>(url)</span></code></pre></div>
<p>We learned that tables in html are associated with the <code>table</code> node. Use the <code>html_nodes()</code> function and the <code>table</code> node type to extract the first table. Store it in an object nodes:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="section-2-overview.html#cb261-1" aria-hidden="true"></a>nodes &lt;-<span class="st"> </span><span class="kw">html_nodes</span>(h, <span class="st">&quot;table&quot;</span>)</span></code></pre></div>
<p>The <code>html_nodes()</code> function returns a list of objects of class <code>xml_node</code>. We can see the content of each one using, for example, the <code>html_text()</code> function. You can see the content for an arbitrarily picked component like this:</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="section-2-overview.html#cb262-1" aria-hidden="true"></a><span class="kw">html_text</span>(nodes[[<span class="dv">8</span>]])</span></code></pre></div>
<pre><code>## [1] &quot;Team\nPayroll\nAverge\nMedianNew York Yankees\n$ 197,962,289\n$ 6,186,321\n$ 1,937,500Philadelphia Phillies\n$ 174,538,938\n$ 5,817,964\n$ 1,875,000Boston Red Sox\n$ 173,186,617\n$ 5,093,724\n$ 1,556,250Los Angeles Angels\n$ 154,485,166\n$ 5,327,074\n$ 3,150,000Detroit Tigers\n$ 132,300,000\n$ 4,562,068\n$ 1,100,000Texas Rangers\n$ 120,510,974\n$ 4,635,037\n$ 3,437,500Miami Marlins\n$ 118,078,000\n$ 4,373,259\n$ 1,500,000San Francisco Giants\n$ 117,620,683\n$ 3,920,689\n$ 1,275,000St. Louis Cardinals\n$ 110,300,862\n$ 3,939,316\n$ 800,000Milwaukee Brewers\n$ 97,653,944\n$ 3,755,920\n$ 1,981,250Chicago White Sox\n$ 96,919,500\n$ 3,876,780\n$ 530,000Los Angeles Dodgers\n$ 95,143,575\n$ 3,171,452\n$ 875,000Minnesota Twins\n$ 94,085,000\n$ 3,484,629\n$ 750,000New York Mets\n$ 93,353,983\n$ 3,457,554\n$ 875,000Chicago Cubs\n$ 88,197,033\n$ 3,392,193\n$ 1,262,500Atlanta Braves\n$ 83,309,942\n$ 2,776,998\n$ 577,500Cincinnati Reds\n$ 82,203,616\n$ 2,935,843\n$ 1,150,000Seattle Mariners\n$ 81,978,100\n$ 2,927,789\n$ 495,150Baltimore Orioles\n$ 81,428,999\n$ 2,807,896\n$ 1,300,000Washington Nationals\n$ 81,336,143\n$ 2,623,746\n$ 800,000Cleveland Indians\n$ 78,430,300\n$ 2,704,493\n$ 800,000Colorado Rockies\n$ 78,069,571\n$ 2,692,054\n$ 482,000Toronto Blue Jays\n$ 75,489,200\n$ 2,696,042\n$ 1,768,750Arizona Diamondbacks\n$ 74,284,833\n$ 2,653,029\n$ 1,625,000Tampa Bay Rays\n$ 64,173,500\n$ 2,291,910\n$ 1,425,000Pittsburgh Pirates\n$ 63,431,999\n$ 2,187,310\n$ 916,666Kansas City Royals\n$ 60,916,225\n$ 2,030,540\n$ 870,000Houston Astros\n$ 60,651,000\n$ 2,332,730\n$ 491,250Oakland Athletics\n$ 55,372,500\n$ 1,845,750\n$ 487,500San Diego Padres\n$ 55,244,700\n$ 1,973,025\n$ 1,207,500&quot;</code></pre>
<p>If the content of this object is an html table, we can use the <code>html_table()</code> function to convert it to a data frame:</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="section-2-overview.html#cb264-1" aria-hidden="true"></a><span class="kw">html_table</span>(nodes[[<span class="dv">8</span>]])</span></code></pre></div>
<pre><code>##                     Team       Payroll      Averge      Median
## 1       New York Yankees $ 197,962,289 $ 6,186,321 $ 1,937,500
## 2  Philadelphia Phillies $ 174,538,938 $ 5,817,964 $ 1,875,000
## 3         Boston Red Sox $ 173,186,617 $ 5,093,724 $ 1,556,250
## 4     Los Angeles Angels $ 154,485,166 $ 5,327,074 $ 3,150,000
## 5         Detroit Tigers $ 132,300,000 $ 4,562,068 $ 1,100,000
## 6          Texas Rangers $ 120,510,974 $ 4,635,037 $ 3,437,500
## 7          Miami Marlins $ 118,078,000 $ 4,373,259 $ 1,500,000
## 8   San Francisco Giants $ 117,620,683 $ 3,920,689 $ 1,275,000
## 9    St. Louis Cardinals $ 110,300,862 $ 3,939,316   $ 800,000
## 10     Milwaukee Brewers  $ 97,653,944 $ 3,755,920 $ 1,981,250
## 11     Chicago White Sox  $ 96,919,500 $ 3,876,780   $ 530,000
## 12   Los Angeles Dodgers  $ 95,143,575 $ 3,171,452   $ 875,000
## 13       Minnesota Twins  $ 94,085,000 $ 3,484,629   $ 750,000
## 14         New York Mets  $ 93,353,983 $ 3,457,554   $ 875,000
## 15          Chicago Cubs  $ 88,197,033 $ 3,392,193 $ 1,262,500
## 16        Atlanta Braves  $ 83,309,942 $ 2,776,998   $ 577,500
## 17       Cincinnati Reds  $ 82,203,616 $ 2,935,843 $ 1,150,000
## 18      Seattle Mariners  $ 81,978,100 $ 2,927,789   $ 495,150
## 19     Baltimore Orioles  $ 81,428,999 $ 2,807,896 $ 1,300,000
## 20  Washington Nationals  $ 81,336,143 $ 2,623,746   $ 800,000
## 21     Cleveland Indians  $ 78,430,300 $ 2,704,493   $ 800,000
## 22      Colorado Rockies  $ 78,069,571 $ 2,692,054   $ 482,000
## 23     Toronto Blue Jays  $ 75,489,200 $ 2,696,042 $ 1,768,750
## 24  Arizona Diamondbacks  $ 74,284,833 $ 2,653,029 $ 1,625,000
## 25        Tampa Bay Rays  $ 64,173,500 $ 2,291,910 $ 1,425,000
## 26    Pittsburgh Pirates  $ 63,431,999 $ 2,187,310   $ 916,666
## 27    Kansas City Royals  $ 60,916,225 $ 2,030,540   $ 870,000
## 28        Houston Astros  $ 60,651,000 $ 2,332,730   $ 491,250
## 29     Oakland Athletics  $ 55,372,500 $ 1,845,750   $ 487,500
## 30      San Diego Padres  $ 55,244,700 $ 1,973,025 $ 1,207,500</code></pre>
<p>You will analyze the tables from this HTML page over questions 1-3.</p>
<ol style="list-style-type: decimal">
<li>Many tables on this page are team payroll tables, with columns for rank, team, and one or more money values.</li>
</ol>
<p>Convert the first four tables in <code>nodes</code> to data frames and inspect them.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="section-2-overview.html#cb266-1" aria-hidden="true"></a><span class="kw">sapply</span>(nodes[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], html_table)    <span class="co"># 2, 3, 4 give tables with payroll info</span></span></code></pre></div>
<pre><code>## [[1]]
##   X1                                                                     X2
## 1 NA Salary Stats 1967-2019\nTop ML Player Salaries / Baseball&#39;s Luxury Tax
## 
## [[2]]
##    RANK                  TEAM   Payroll
## 1     1        Boston Red Sox  $235.65M
## 2     2  San Francisco Giants  $208.51M
## 3     3   Los Angeles Dodgers  $186.14M
## 4     4          Chicago Cubs  $183.46M
## 5     5  Washington Nationals  $181.59M
## 6     6    Los Angeles Angels   $175.1M
## 7     7      New York Yankees  $168.54M
## 8     8      Seattle Mariners  $162.48M
## 9     9     Toronto Blue Jays $162.316M
## 10   10   St. Louis Cardinals  $161.01M
## 11   11        Houston Astros  $160.04M
## 12   12         New York Mets  $154.61M
## 13   13         Texas Rangers   $144.0M
## 14   14     Baltimore Orioles  $143.09M
## 15   15      Colorado Rockies  $141.34M
## 16   16     Cleveland Indians  $134.35M
## 17   17  Arizona Diamondbacks   $132.5M
## 18   18       Minnesota Twins  $131.91M
## 19   19        Detroit Tigers  $129.92M
## 20   20    Kansas City Royals  $129.92M
## 21   21        Atlanta Braves  $120.54M
## 22   22       Cincinnati Reds  $101.19M
## 23   23         Miami Marlins   $98.64M
## 24   24 Philadelphia Phillies   $96.85M
## 25   25      San Diego Padres   $96.13M
## 26   26     Milwaukee Brewers   $90.24M
## 27   27    Pittsburgh Pirates   $87.88M
## 28   28        Tampa Bay Rays   $78.73M
## 29   29     Chicago White Sox   $72.18M
## 30   30     Oakland Athletics   $68.53M
## 
## [[3]]
##      X1                            X2           X3            X4            X5
## 1  Rank                          Team       25 Man Disabled List Total Payroll
## 2     1           Los Angeles Dodgers $155,887,854   $37,354,166  $242,065,828
## 3     2              New York Yankees $168,045,699    $5,644,000  $201,539,699
## 4     3                Boston Red Sox $136,780,500   $38,239,250  $199,805,178
## 5     4                Detroit Tigers $168,500,600   $11,750,000  $199,750,600
## 6     5             Toronto Blue Jays $159,175,968    $2,169,400  $177,795,368
## 7     6                 Texas Rangers $115,162,703   $39,136,360  $175,909,063
## 8     7          San Francisco Giants $169,504,611    $2,500,000  $172,354,611
## 9     8                  Chicago Cubs $170,189,880    $2,000,000  $172,189,880
## 10    9          Washington Nationals $163,111,918      $535,000  $167,846,918
## 11   10             Baltimore Orioles $142,066,615   $19,501,668  $163,676,616
## 12   11 Los Angeles Angels of Anaheim $116,844,833   $17,120,500  $160,375,333
## 13   12                 New York Mets $120,870,470   $26,141,990  $155,187,460
## 14   13              Seattle Mariners $139,257,018   $15,007,300  $154,800,918
## 15   14           St. Louis Cardinals $136,181,533   $13,521,400  $152,452,933
## 16   15            Kansas City Royals $127,333,150    $4,092,100  $140,925,250
## 17   16              Colorado Rockies  $86,909,571   $14,454,000  $130,963,571
## 18   17             Cleveland Indians $101,105,399   $14,005,766  $124,861,165
## 19   18                Houston Astros $117,957,800    $4,386,100  $124,343,900
## 20   19                Atlanta Braves $103,303,791    $8,927,500  $112,437,541
## 21   20                 Miami Marlins  $96,446,100   $15,035,000  $111,881,100
## 22   21         Philadelphia Phillies  $86,841,000      $537,000  $111,378,000
## 23   22               Minnesota Twins  $92,592,500    $8,735,000  $108,077,500
## 24   23            Pittsburgh Pirates  $92,362,832             -  $100,575,946
## 25   24             Chicago White Sox  $95,625,000    $1,671,000   $99,119,770
## 26   25               Cincinnati Reds  $53,858,785   $26,910,000   $93,768,785
## 27   26          Arizona Diamondbacks  $91,481,600    $1,626,000   $93,257,600
## 28   27             Oakland Athletics  $64,339,166    $5,732,500   $81,738,333
## 29   28              San Diego Padres  $29,628,400    $4,946,000   $71,624,400
## 30   29                Tampa Bay Rays  $55,282,232   $14,680,300   $69,962,532
## 31   30             Milwaukee Brewers  $50,023,900   $13,037,400   $63,061,300
## 
## [[4]]
##    Rank         Team   Opening Day  Avg Salary      Median
## 1     1      Dodgers $ 223,352,402 $ 7,445,080 $ 5,166,666
## 2     2      Yankees $ 213,472,857 $ 7,361,133 $ 3,300,000
## 3     3      Red Sox $ 182,161,414 $ 6,072,047 $ 3,500,000
## 4     4       Tigers $ 172,282,250 $ 6,891,290 $ 3,000,000
## 5     5       Giants $ 166,495,942 $ 5,946,284 $ 4,000,000
## 6     6    Nationals $ 166,010,977 $ 5,724,516 $ 2,500,000
## 7     7       Angels $ 146,449,583 $ 5,049,986 $ 1,312,500
## 8     8      Rangers $ 144,307,373 $ 4,509,605   $ 937,500
## 9     9     Phillies $ 133,048,000 $ 4,434,933   $ 700,000
## 10   10    Blue Jays $ 126,369,628 $ 4,357,573 $ 1,650,000
## 11   11     Mariners $ 122,706,842 $ 4,719,494 $ 2,252,500
## 12   12    Cardinals $ 120,301,957 $ 4,455,628 $ 2,000,000
## 13   13         Reds $ 116,732,284 $ 4,323,418 $ 2,350,000
## 14   14         Cubs $ 116,654,522 $ 4,166,233 $ 2,515,000
## 15   15      Orioles $ 115,587,632 $ 3,985,780 $ 2,750,000
## 16   16       Royals $ 112,914,525 $ 4,032,662 $ 2,532,500
## 17   17       Padres $ 112,895,700 $ 4,342,142   $ 763,500
## 18   18        Twins $ 108,262,000 $ 4,163,923 $ 1,775,000
## 19   19         Mets  $ 99,626,453 $ 3,558,088   $ 669,562
## 20   20    White Sox  $ 98,712,867 $ 3,525,460 $ 1,250,000
## 21   21      Brewers  $ 98,683,035 $ 3,795,501   $ 529,750
## 22   22      Rockies  $ 98,261,171 $ 3,388,316 $ 1,087,600
## 23   23       Braves  $ 87,622,648 $ 2,920,755 $ 1,333,333
## 24   24      Indians  $ 86,339,067 $ 3,197,743 $ 1,940,000
## 25   25      Pirates  $ 85,885,832 $ 2,862,861 $ 1,279,166
## 26   26      Marlins  $ 84,637,500 $ 3,134,722 $ 1,925,000
## 27   27    Athletics  $ 80,279,166 $ 2,508,724   $ 648,750
## 28   28         Rays  $ 73,649,584 $ 2,454,986   $ 750,000
## 29   29 Diamondbacks  $ 70,762,833 $ 2,358,761   $ 663,000
## 30   30       Astros  $ 69,064,200 $ 2,466,579 $ 1,031,250</code></pre>
<p>Which of the first four <code>nodes</code> are tables of team payroll? Check all correct answers. Look at table content, not column names.</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A. None of the above</li>
<li><input type="checkbox" disabled="" />
B. Table 1</li>
<li><input type="checkbox" disabled="" checked="" />
C. Table 2</li>
<li><input type="checkbox" disabled="" checked="" />
D. Table 3</li>
<li><input type="checkbox" disabled="" checked="" />
E. Table 4</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>For the last 3 components of <code>nodes</code>, which of the following are true? Check all correct answers.</li>
</ol>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="section-2-overview.html#cb268-1" aria-hidden="true"></a><span class="kw">html_table</span>(nodes[[<span class="kw">length</span>(nodes)<span class="op">-</span><span class="dv">2</span>]])</span></code></pre></div>
<pre><code>##                   X1           X2         X3
## 1               Team      Payroll    Average
## 2         NY Yankees $109,791,893 $3,541,674
## 3             Boston $109,558,908 $3,423,716
## 4        Los Angeles $108,980,952 $3,757,964
## 5            NY Mets  $93,174,428 $3,327,658
## 6          Cleveland  $91,974,979 $3,065,833
## 7            Atlanta  $91,851,687 $2,962,958
## 8              Texas  $88,504,421 $2,854,981
## 9            Arizona  $81,206,513 $2,900,233
## 10         St. Louis  $77,270,855 $2,664,512
## 11           Toronto  $75,798,500 $2,707,089
## 12           Seattle  $75,652,500 $2,701,875
## 13         Baltimore  $72,426,328 $2,497,460
## 14          Colorado  $71,068,000 $2,632,148
## 15      Chicago Cubs  $64,015,833 $2,462,147
## 16     San Francisco  $63,332,667 $2,345,654
## 17 Chicago White Sox  $62,363,000 $2,309,741
## 18           Houston  $60,382,667 $2,236,395
## 19         Tampa Bay  $54,951,602 $2,035,245
## 20        Pittsburgh  $52,698,333 $1,699,946
## 21           Detroit  $49,831,167 $1,779,685
## 22           Anaheim  $46,568,180 $1,502,199
## 23        Cincinnati  $45,227,882 $1,739,534
## 24         Milwaukee  $43,089,333 $1,595,901
## 25      Philadelphia  $41,664,167 $1,602,468
## 26         San Diego  $38,333,117 $1,419,745
## 27       Kansas City  $35,643,000 $1,229,069
## 28           Florida  $35,504,167 $1,183,472
## 29          Montreal  $34,774,500 $1,159,150
## 30           Oakland  $33,810,750 $1,252,250
## 31         Minnesota  $24,350,000   $901,852</code></pre>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="section-2-overview.html#cb270-1" aria-hidden="true"></a><span class="kw">html_table</span>(nodes[[<span class="kw">length</span>(nodes)<span class="op">-</span><span class="dv">1</span>]])</span></code></pre></div>
<pre><code>##                   X1          X2         X3
## 1               Team     Payroll    Average
## 2         NY Yankees $92,538,260 $3,190,974
## 3        Los Angeles $88,124,286 $3,263,862
## 4            Atlanta $84,537,836 $2,817,928
## 5          Baltimore $81,447,435 $2,808,532
## 6            Arizona $81,027,833 $2,893,851
## 7            NY Mets $79,509,776 $3,180,391
## 8             Boston $77,940,333 $2,598,011
## 9          Cleveland $75,880,871 $2,918,495
## 10             Texas $70,795,921 $2,722,920
## 11         Tampa Bay $62,765,129 $2,024,682
## 12         St. Louis $61,453,863 $2,276,069
## 13          Colorado $61,111,190 $2,182,543
## 14      Chicago Cubs $60,539,333 $2,017,978
## 15           Seattle $58,915,000 $2,265,962
## 16           Detroit $58,265,167 $2,157,969
## 17         San Diego $54,821,000 $1,827,367
## 18     San Francisco $53,737,826 $2,066,839
## 19           Anaheim $51,464,167 $1,715,472
## 20           Houston $51,289,111 $1,899,597
## 21      Philadelphia $47,308,000 $1,631,310
## 22        Cincinnati $46,867,200 $1,735,822
## 23           Toronto $46,238,333 $1,778,397
## 24         Milwaukee $36,505,333 $1,140,792
## 25          Montreal $34,807,833 $1,200,270
## 26           Oakland $31,971,333 $1,184,123
## 27 Chicago White Sox $31,133,500 $1,073,569
## 28        Pittsburgh $28,928,333 $1,112,628
## 29       Kansas City $23,433,000   $836,893
## 30           Florida $20,072,000   $692,138
## 31         Minnesota $16,519,500   $635,365</code></pre>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="section-2-overview.html#cb272-1" aria-hidden="true"></a><span class="kw">html_table</span>(nodes[[<span class="kw">length</span>(nodes)]])</span></code></pre></div>
<pre><code>##      X1       X2         X3     X4
## 1  Year  Minimum    Average  % Chg
## 2  2019 $555,000                 -
## 3  2018 $545,000 $4,520,000       
## 4  2017 $535,000 $4,470,000    5.4
## 5  2016 $507,500 $4,400,000      -
## 6  2015 $507,500 $4,250,000      -
## 7  2014 $507,500 $3,820,000   12.8
## 8  2013 $480,000 $3,386,212    5.4
## 9  2012 $480,000 $3,440,000    3.8
## 10 2011 $414,500 $3,305,393    0.2
## 11 2010 $400,000 $3,297,828    1.8
## 12 2009 $400,000 $3,240,206    2.7
## 13 2008 $390,000 $3,150,000    7.1
## 14 2007 $380,000 $2,820,000    4.6
## 15 2006 $327,000 $2,699,292      9
## 16 2005 $316,000 $2,632,655    5.9
## 17 2004 $300,000 $2,486,609 (-2.7)
## 18 2003 $300,000 $2,555,416    7.2
## 19 2002 $200,000 $2,340,920    5.2
## 20 2001 $200,000 $2,138,896   13.9
## 21 2000 $200,000 $1,895,630   15.6
## 22 1999 $200,000 $1,611,166   19.3
## 23 1998 $170,000 $1,398,831    4.2
## 24 1997 $150,000 $1,336,609   17.6
## 25 1996 $122,667 $1,119,981    9.9
## 26 1995 $109,000 $1,110,766 (-9.9)
## 27 1994 $109,000 $1,168,263    6.1
## 28 1993 $109,000 $1,076,089    3.3
## 29 1992 $109,000 $1,028,667   21.7
## 30 1991 $100,000   $851,492   53.9
## 31 1990 $100,000   $597,537   12.9
## 32 1989  $68,000   $497,254       
## 33 1988  $62,500   $438,729       
## 34 1987  $62,500   $412,454       
## 35 1986  $60,000   $412,520       
## 36 1985  $60,000   $371,571       
## 37 1984  $40,000   $329,408       
## 38 1983  $35,000   $289,194       
## 39 1982  $33,500   $241,497       
## 40 1981  $32,500   $185,651       
## 41 1980  $30,000   $143,756       
## 42 1979  $21,000   $113,558       
## 43 1978  $21,000    $99,876       
## 44 1977  $19,000    $76,066       
## 45 1976  $19,000    $51,501       
## 46 1975  $16,000    $44,676       
## 47 1974  $15,000    $40,839       
## 48 1973  $15,000    $36,566       
## 49 1972  $13,500    $34,092       
## 50 1971  $12,750    $31,543       
## 51 1970  $12,000    $29,303       
## 52 1969  $10,000    $24,909       
## 53 1968  $10,000        N/A       
## 54 1967   $6,000    $19,000</code></pre>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="" />
A. All three entries are tables.</li>
<li><input type="checkbox" disabled="" />
B. All three entries are tables of payroll per team.</li>
<li><input type="checkbox" disabled="" checked="" />
C. The last entry shows the average across all teams through time, not payroll per team.</li>
<li><input type="checkbox" disabled="" />
D. None of the three entries are tables of payroll per team.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Create a table called <code>tab_1</code> using entry 10 of <code>nodes</code>. Create a table called <code>tab_2</code> using entry 19 of <code>nodes</code>.</li>
</ol>
<p>Note that the column names should be <code>c("Team", "Payroll", "Average")</code>. You can see that these column names are actually in the first data row of each table, and that <code>tab_1</code> has an extra first column <code>No.</code> that should be removed so that the column names for both tables match.</p>
<p>Remove the extra column in <code>tab_1</code>, remove the first row of each dataset, and change the column names for each table to <code>c("Team", "Payroll", "Average")</code>. Use a <code>full_join()</code> by the <code>Team</code> to combine these two tables.</p>
<p>Note that some students, presumably because of system differences, have noticed that entry 18 instead of entry 19 of <code>nodes</code> gives them the <code>tab_2</code> correctly; be sure to check entry 18 if entry 19 is giving you problems.</p>
<p>How many rows are in the joined data table?</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="section-2-overview.html#cb274-1" aria-hidden="true"></a>tab_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">html_table</span>(nodes[[<span class="dv">10</span>]])</span>
<span id="cb274-2"><a href="section-2-overview.html#cb274-2" aria-hidden="true"></a>tab_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">html_table</span>(nodes[[<span class="dv">19</span>]])</span>
<span id="cb274-3"><a href="section-2-overview.html#cb274-3" aria-hidden="true"></a>col_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Team&quot;</span>, <span class="st">&quot;Payroll&quot;</span>, <span class="st">&quot;Average&quot;</span>)</span>
<span id="cb274-4"><a href="section-2-overview.html#cb274-4" aria-hidden="true"></a>tab_<span class="dv">1</span> &lt;-<span class="st"> </span>tab_<span class="dv">1</span>[<span class="op">-</span><span class="dv">1</span>, <span class="dv">-1</span>]</span>
<span id="cb274-5"><a href="section-2-overview.html#cb274-5" aria-hidden="true"></a>tab_<span class="dv">2</span> &lt;-<span class="st"> </span>tab_<span class="dv">2</span>[<span class="op">-</span><span class="dv">1</span>,]</span>
<span id="cb274-6"><a href="section-2-overview.html#cb274-6" aria-hidden="true"></a><span class="kw">names</span>(tab_<span class="dv">2</span>) &lt;-<span class="st"> </span>col_names</span>
<span id="cb274-7"><a href="section-2-overview.html#cb274-7" aria-hidden="true"></a><span class="kw">names</span>(tab_<span class="dv">1</span>) &lt;-<span class="st"> </span>col_names</span>
<span id="cb274-8"><a href="section-2-overview.html#cb274-8" aria-hidden="true"></a><span class="kw">full_join</span>(tab_<span class="dv">1</span>,tab_<span class="dv">2</span>, <span class="dt">by =</span> <span class="st">&quot;Team&quot;</span>)</span></code></pre></div>
<pre><code>##                     Team    Payroll.x  Average.x    Payroll.y  Average.y
## 1       New York Yankees $206,333,389 $8,253,336         &lt;NA&gt;       &lt;NA&gt;
## 2         Boston Red Sox $162,747,333 $5,611,977         &lt;NA&gt;       &lt;NA&gt;
## 3           Chicago Cubs $146,859,000 $5,439,222  $64,015,833 $2,462,147
## 4  Philadelphia Phillies $141,927,381 $5,068,835         &lt;NA&gt;       &lt;NA&gt;
## 5          New York Mets $132,701,445 $5,103,902         &lt;NA&gt;       &lt;NA&gt;
## 6         Detroit Tigers $122,864,929 $4,550,553         &lt;NA&gt;       &lt;NA&gt;
## 7      Chicago White Sox $108,273,197 $4,164,354  $62,363,000 $2,309,741
## 8     Los Angeles Angels $105,013,667 $3,621,161         &lt;NA&gt;       &lt;NA&gt;
## 9       Seattle Mariners  $98,376,667 $3,513,452         &lt;NA&gt;       &lt;NA&gt;
## 10  San Francisco Giants  $97,828,833 $3,493,887         &lt;NA&gt;       &lt;NA&gt;
## 11       Minnesota Twins  $97,559,167 $3,484,256         &lt;NA&gt;       &lt;NA&gt;
## 12   Los Angeles Dodgers  $94,945,517 $3,651,751         &lt;NA&gt;       &lt;NA&gt;
## 13   St. Louis Cardinals  $93,540,753 $3,741,630         &lt;NA&gt;       &lt;NA&gt;
## 14        Houston Astros  $92,355,500 $3,298,411         &lt;NA&gt;       &lt;NA&gt;
## 15        Atlanta Braves  $84,423,667 $3,126,802         &lt;NA&gt;       &lt;NA&gt;
## 16      Colorado Rockies  $84,227,000 $2,904,379         &lt;NA&gt;       &lt;NA&gt;
## 17     Baltimore Orioles  $81,612,500 $3,138,942         &lt;NA&gt;       &lt;NA&gt;
## 18     Milwaukee Brewers  $81,108,279 $2,796,837         &lt;NA&gt;       &lt;NA&gt;
## 19       Cincinnati Reds  $72,386,544 $2,784,098         &lt;NA&gt;       &lt;NA&gt;
## 20    Kansas City Royals  $72,267,710 $2,491,990         &lt;NA&gt;       &lt;NA&gt;
## 21        Tampa Bay Rays  $71,923,471 $2,663,832         &lt;NA&gt;       &lt;NA&gt;
## 22     Toronto Blue Jays  $62,689,357 $2,089,645         &lt;NA&gt;       &lt;NA&gt;
## 23  Washington Nationals  $61,425,000 $2,047,500         &lt;NA&gt;       &lt;NA&gt;
## 24     Cleveland Indians  $61,203,967 $2,110,482         &lt;NA&gt;       &lt;NA&gt;
## 25  Arizona Diamondbacks  $60,718,167 $2,335,314         &lt;NA&gt;       &lt;NA&gt;
## 26       Florida Marlins  $55,641,500 $2,060,796         &lt;NA&gt;       &lt;NA&gt;
## 27         Texas Rangers  $55,250,545 $1,905,191         &lt;NA&gt;       &lt;NA&gt;
## 28     Oakland Athletics  $51,654,900 $1,666,287         &lt;NA&gt;       &lt;NA&gt;
## 29      San Diego Padres  $37,799,300 $1,453,819         &lt;NA&gt;       &lt;NA&gt;
## 30    Pittsburgh Pirates  $34,943,000 $1,294,185         &lt;NA&gt;       &lt;NA&gt;
## 31            NY Yankees         &lt;NA&gt;       &lt;NA&gt; $109,791,893 $3,541,674
## 32                Boston         &lt;NA&gt;       &lt;NA&gt; $109,558,908 $3,423,716
## 33           Los Angeles         &lt;NA&gt;       &lt;NA&gt; $108,980,952 $3,757,964
## 34               NY Mets         &lt;NA&gt;       &lt;NA&gt;  $93,174,428 $3,327,658
## 35             Cleveland         &lt;NA&gt;       &lt;NA&gt;  $91,974,979 $3,065,833
## 36               Atlanta         &lt;NA&gt;       &lt;NA&gt;  $91,851,687 $2,962,958
## 37                 Texas         &lt;NA&gt;       &lt;NA&gt;  $88,504,421 $2,854,981
## 38               Arizona         &lt;NA&gt;       &lt;NA&gt;  $81,206,513 $2,900,233
## 39             St. Louis         &lt;NA&gt;       &lt;NA&gt;  $77,270,855 $2,664,512
## 40               Toronto         &lt;NA&gt;       &lt;NA&gt;  $75,798,500 $2,707,089
## 41               Seattle         &lt;NA&gt;       &lt;NA&gt;  $75,652,500 $2,701,875
## 42             Baltimore         &lt;NA&gt;       &lt;NA&gt;  $72,426,328 $2,497,460
## 43              Colorado         &lt;NA&gt;       &lt;NA&gt;  $71,068,000 $2,632,148
## 44         San Francisco         &lt;NA&gt;       &lt;NA&gt;  $63,332,667 $2,345,654
## 45               Houston         &lt;NA&gt;       &lt;NA&gt;  $60,382,667 $2,236,395
## 46             Tampa Bay         &lt;NA&gt;       &lt;NA&gt;  $54,951,602 $2,035,245
## 47            Pittsburgh         &lt;NA&gt;       &lt;NA&gt;  $52,698,333 $1,699,946
## 48               Detroit         &lt;NA&gt;       &lt;NA&gt;  $49,831,167 $1,779,685
## 49               Anaheim         &lt;NA&gt;       &lt;NA&gt;  $46,568,180 $1,502,199
## 50            Cincinnati         &lt;NA&gt;       &lt;NA&gt;  $45,227,882 $1,739,534
## 51             Milwaukee         &lt;NA&gt;       &lt;NA&gt;  $43,089,333 $1,595,901
## 52          Philadelphia         &lt;NA&gt;       &lt;NA&gt;  $41,664,167 $1,602,468
## 53             San Diego         &lt;NA&gt;       &lt;NA&gt;  $38,333,117 $1,419,745
## 54           Kansas City         &lt;NA&gt;       &lt;NA&gt;  $35,643,000 $1,229,069
## 55               Florida         &lt;NA&gt;       &lt;NA&gt;  $35,504,167 $1,183,472
## 56              Montreal         &lt;NA&gt;       &lt;NA&gt;  $34,774,500 $1,159,150
## 57               Oakland         &lt;NA&gt;       &lt;NA&gt;  $33,810,750 $1,252,250
## 58             Minnesota         &lt;NA&gt;       &lt;NA&gt;  $24,350,000   $901,852</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>The Wikipedia page on <a href="https://en.wikipedia.org/w/index.php?title=Opinion_polling_for_the_United_Kingdom_European_Union_membership_referendum&amp;oldid=896735054">opinion polling for the Brexit referendum</a>, in which the United Kingdom voted to leave the European Union in June 2016, contains several tables. One table contains the results of all polls regarding the referendum over 2016.</li>
</ol>
<div class="figure">
<img src="images/Polls_referendum_2016.png" alt="" />
<p class="caption">Polls regarding the referendum over 2016</p>
</div>
<p>Use the rvest library to read the HTML from this Wikipedia page (make sure to copy both lines of the URL):</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="section-2-overview.html#cb276-1" aria-hidden="true"></a>url &lt;-<span class="st"> &quot;https://en.wikipedia.org/w/index.php?title=Opinion_polling_for_the_United_Kingdom_European_Union_membership_referendum&amp;oldid=896735054&quot;</span></span></code></pre></div>
<p>Assign <code>tab</code> to be the html nodes of the “table” class.</p>
<p>How many tables are in this Wikipedia page?</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="section-2-overview.html#cb277-1" aria-hidden="true"></a>tab &lt;-<span class="st"> </span><span class="kw">read_html</span>(url) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_nodes</span>(<span class="st">&quot;table&quot;</span>)</span>
<span id="cb277-2"><a href="section-2-overview.html#cb277-2" aria-hidden="true"></a><span class="kw">length</span>(tab)</span></code></pre></div>
<pre><code>## [1] 39</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Inspect the first several html tables using <code>html_table()</code> with the argument <code>fill=TRUE</code> (you can read about this argument in the documentation). Find the first table that has 9 columns with the first column named “Date(s) conducted”.</li>
</ol>
<p>What is the first table number to have 9 columns where the first column is named “Date(s) conducted”?</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="section-2-overview.html#cb279-1" aria-hidden="true"></a>tab[[<span class="dv">5</span>]] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_table</span>(<span class="dt">fill =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">names</span>()    <span class="co"># inspect column names</span></span></code></pre></div>
<pre><code>## [1] &quot;Date(s) conducted&quot; &quot;Remain&quot;            &quot;Leave&quot;             &quot;Undecided&quot;         &quot;Lead&quot;              &quot;Sample&quot;            &quot;Conducted by&quot;      &quot;Polling type&quot;     
## [9] &quot;Notes&quot;</code></pre>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="section-1-overview.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="section-3-overview.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
